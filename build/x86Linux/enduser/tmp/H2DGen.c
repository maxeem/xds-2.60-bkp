/* "@(#)H2DGen.c Nov  7 22:56:04 2022" */
/* Generated by XDS Oberon-2 to ANSI C v4.20 translator */

#define X2C_int32
#define X2C_index32
#ifndef H2DGen_H_
#include "H2DGen.h"
#endif
#define H2DGen_C_
#ifndef Printf_H_
#include "Printf.h"
#endif
#ifndef IOChan_H_
#include "IOChan.h"
#endif
#ifndef adt_H_
#include "adt.h"
#endif
#ifndef LongStrs_H_
#include "LongStrs.h"
#endif
#ifndef Strings_H_
#include "Strings.h"
#endif
#ifndef WholeStr_H_
#include "WholeStr.h"
#endif
#ifndef WholeConv_H_
#include "WholeConv.h"
#endif
#ifndef SysClock_H_
#include "SysClock.h"
#endif
#ifndef H2DObjs_H_
#include "H2DObjs.h"
#endif
#ifndef H2DMsg_H_
#include "H2DMsg.h"
#endif
#ifndef H2DFile_H_
#include "H2DFile.h"
#endif
#ifndef platform_H_
#include "platform.h"
#endif
#ifndef H2DCfg_H_
#include "H2DCfg.h"
#endif

extern struct X2C_MD_STR H2DGen_desc;
#define H2DGen_comment_leadtab 3

#define H2DGen_min_comment_length 20

#define H2DGen_default_comment_positio 0

#define H2DGen_new_line (-2)

#define H2DGen_ins_empty_line_before (-3)

#define H2DGen_new_line_and_position (-4)

#define H2DGen_size_output_str 1000

#define H2DGen_long_name_sep "_"

#define H2DGen_universal_char "_"

#define H2DGen_definition_in_foregin_m "It is defined in header "

#define H2DGen_int8 "SYSTEM.INT8"

#define H2DGen_int "SYSTEM.int"

#define H2DGen_int16 "SYSTEM.INT16"

#define H2DGen_int32 "SYSTEM.INT32"

#define H2DGen_card8 "SYSTEM.CARD8"

#define H2DGen_unsigned "SYSTEM.unsigned"

#define H2DGen_card16 "SYSTEM.CARD16"

#define H2DGen_card32 "SYSTEM.CARD32"

#define H2DGen_real "REAL"

#define H2DGen_longreal "LONGREAL"

#define H2DGen_long_float "LONGFLOAT"

#define H2DGen_long_double "LONGDOUDLE"

#define H2DGen_void "SYSTEM.void"

#define H2DGen_m2_INTEGER "INTEGER"

#define H2DGen_m2_SHORTINT "SHORTINT"

#define H2DGen_m2_LONGINT "LONGINT"

#define H2DGen_m2_CARDINAL "CARDINAL"

#define H2DGen_m2_SHORTCARD "SHORTCARD"

#define H2DGen_m2_LONGCARD "LONGCARD"

#define H2DGen_m2_CHAR "CHAR"

#define H2DGen_m2_BITSET "BITSET"

#define H2DGen_m2_BOOLEAN "BOOLEAN"

#define H2DGen_m2_REAL "REAL"

#define H2DGen_m2_LONGREAL "LONGREAL"

#define H2DGen_m2_BYTE "SYSTEM.BYTE"

#define H2DGen_m2_BOOL8 "SYSTEM.BOOL8"

#define H2DGen_m2_BOOL16 "SYSTEM.BOOL16"

#define H2DGen_m2_BOOL32 "SYSTEM.BOOL32"

#define H2DGen_m2_INT8 "SYSTEM.INT8"

#define H2DGen_m2_INT16 "SYSTEM.INT16"

#define H2DGen_m2_INT32 "SYSTEM.INT32"

#define H2DGen_m2_CARD8 "SYSTEM.CARD8"

#define H2DGen_m2_CARD16 "SYSTEM.CARD16"

#define H2DGen_m2_CARD32 "SYSTEM.CARD32"

#define H2DGen_m2_SET8 "SYSTEM.SET8"

#define H2DGen_m2_SET16 "SYSTEM.SET16"

#define H2DGen_m2_SET32 "SYSTEM.SET32"

#define H2DGen_m2_int "SYSTEM.int"

#define H2DGen_m2_unsigned "SYSTEM.unsigned"

#define H2DGen_new_gentypedef_p "<* IF NOT DEFINED(GENTYPEDEF) THEN *> <* NEW\
 GENTYPEDEF+ *> <* END *>"

#define H2DGen_new_gentypedef_m "<* IF NOT DEFINED(GENTYPEDEF) THEN *> <* NEW\
 GENTYPEDEF- *> <* END *>"

#define H2DGen_gentypedef_p "<*+ GENTYPEDEF *>"

#define H2DGen_gentypedef_m "<*- GENTYPEDEF *>"

#define H2DGen_noheader "<*+ NOHEADER *> "

#define H2DGen_cstdlib "<*+ CSTDLIB *>"

#define H2DGen_m2extensions "<*+ M2EXTENSIONS *>"

#define H2DGen_m2addtypes "<*+ M2ADDTYPES *>"

#define H2DGen_kw_array_of_byte "ARRAY OF SYSTEM.BYTE "

#define H2DGen_cdecl "[\"C\"]"

#define H2DGen_pascalcall "[\"StdCall\"]"

#define H2DGen_pascal "[\"Pascal\"]"

#define H2DGen_syscall "[\"SysCall\"]"

#define H2DGen_comment_for_macro " H2D: this procedure corresponds to a macro\
. "

#define H2DGen_import_comment " Required IMPORT clause: "

#define H2DGen_h2d_comment " H2D: "

#define H2DGen_Generate_Objects_base 7300

#define H2DGen_obj_procedure 7301

#define H2DGen_obj_const 7302

#define H2DGen_obj_type 7303

#define H2DGen_obj_var 7304

#define H2DGen_obj_macro 7305

#define H2DGen_Check_Modula_Name_base 7400

#define H2DGen_all_right 7401

#define H2DGen_bad_identifier 7402

#define H2DGen_consist_path 7403

#define H2DGen_not_present 7404

#define H2DGen_Other_Option_base 7500

#define H2DGen_none 7501

#define H2DGen_Unique_Tag_Name_base 7600

#define H2DGen_no 7601

#define H2DGen_yes 7602

#define H2DGen_exist_synonym 7603

#define H2DGen_Modifier_Type_base 7700

#define H2DGen_language_mod 7701

#define H2DGen_memory_model_mod 7702

#define H2DGen_assign_mod 7703

#define H2DGen_all_mod 7704

#define H2DGen_func_mod 7705

#define H2DGen_Type_Module_base 7800

#define H2DGen_std_def_module 7801

#define H2DGen_macro_def_module 7802

#define H2DGen_macro_mod_module 7803

#define H2DGen_Other_base 7900

#define H2DGen_struct_already_denerate 7900

struct H2DGen_FILEDesc;
extern struct X2C_TD_STR H2DGen_FILEDesc_desc;

typedef struct H2DGen_FILEDesc * FILE0;


struct H2DGen_FILEDesc {
   X2C_INT32 type;
   IOChan_ChanId hand;
   LongStrs_String path;
   LongStrs_String name;
   LongStrs_String modname;
   X2C_INT32 line;
   X2C_INT32 pos;
   H2DObjs_Header header;
   adt_Tree creatednames;
   X2C_BOOLEAN created;
   X2C_BOOLEAN used;
   X2C_INT32 obj_line;
   X2C_INT32 tab;
   X2C_BOOLEAN emptyLine;
};
static X2C_PROC H2DGen_FILEDesc_proc[] = {
   0
};
static void * H2DGen_FILEDesc_offs[] = {
   X2C_OFS(struct H2DGen_FILEDesc,path),
   X2C_OFS(struct H2DGen_FILEDesc,name),
   X2C_OFS(struct H2DGen_FILEDesc,modname),
   X2C_OFS(struct H2DGen_FILEDesc,header),
   X2C_OFS(struct H2DGen_FILEDesc,creatednames),
   X2C_OFS_END
};
struct X2C_TD_STR H2DGen_FILEDesc_desc = {
   sizeof(struct H2DGen_FILEDesc), "FILEDesc",
   &H2DGen_desc, 0, 0, 0,
   { &H2DGen_FILEDesc_desc, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
   H2DGen_FILEDesc_proc, H2DGen_FILEDesc_offs, 0, 0, 0,
                &H2DGen_FILEDesc_desc, 0x93678150lu
};

struct H2DGen_HFILEDesc;
extern struct X2C_TD_STR H2DGen_HFILEDesc_desc;

typedef struct H2DGen_HFILEDesc * HFILE;


struct H2DGen_HFILEDesc {
   IOChan_ChanId hand;
   LongStrs_String name;
   X2C_BOOLEAN created;
   LongStrs_String define;
   X2C_INT32 line;
   X2C_BOOLEAN emptyLine;
};
static X2C_PROC H2DGen_HFILEDesc_proc[] = {
   0
};
static void * H2DGen_HFILEDesc_offs[] = {
   X2C_OFS(struct H2DGen_HFILEDesc,name),
   X2C_OFS(struct H2DGen_HFILEDesc,define),
   X2C_OFS_END
};
struct X2C_TD_STR H2DGen_HFILEDesc_desc = {
   sizeof(struct H2DGen_HFILEDesc), "HFILEDesc",
   &H2DGen_desc, &H2DGen_FILEDesc_desc, 0, 0,
   { &H2DGen_HFILEDesc_desc, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
   H2DGen_HFILEDesc_proc, H2DGen_HFILEDesc_offs, 0, 0, 0,
                &H2DGen_HFILEDesc_desc, 0x93678150lu
};

struct H2DGen_OutStringDesc;
extern struct X2C_TD_STR H2DGen_OutStringDesc_desc;

typedef struct H2DGen_OutStringDesc * OutString;

static void CommentInFile(OutString, X2C_INT32, X2C_INT32);
typedef void (*CommentInFile_)(OutString, X2C_INT32, X2C_INT32);


struct H2DGen_OutStringDesc {
   X2C_INT32 _dummy_;
   LongStrs_String str;
   adt_List comment0;
   X2C_INT32 leadtab;
   X2C_INT32 tab;
   X2C_INT32 line;
   X2C_INT32 backend;
};
static X2C_PROC H2DGen_OutStringDesc_proc[] = {
   (X2C_PROC)adt_Compare,
   (X2C_PROC)CommentInFile
};
static void * H2DGen_OutStringDesc_offs[] = {
   X2C_OFS(struct H2DGen_OutStringDesc,str),
   X2C_OFS(struct H2DGen_OutStringDesc,comment0),
   X2C_OFS_END
};
struct X2C_TD_STR H2DGen_OutStringDesc_desc = {
   sizeof(struct H2DGen_OutStringDesc), "OutStringDesc",
   &H2DGen_desc, &H2DGen_HFILEDesc_desc, 2, 1,
   { &adt_ElementDesc_desc, &H2DGen_OutStringDesc_desc, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0 },
   H2DGen_OutStringDesc_proc, H2DGen_OutStringDesc_offs, 0, 0, 0,
                &H2DGen_OutStringDesc_desc, 0x93678150lu
};

struct H2DGen_GeneratedTypeDesc;
extern struct X2C_TD_STR H2DGen_GeneratedTypeDesc_desc;

typedef struct H2DGen_GeneratedTypeDesc * GeneratedType;


struct H2DGen_GeneratedTypeDesc {
   X2C_INT32 _dummy_;
   LongStrs_String name;
   H2DObjs_Type type;
};
static X2C_PROC H2DGen_GeneratedTypeDesc_proc[] = {
   (X2C_PROC)adt_Compare0,
   (X2C_PROC)adt_SetName
};
static void * H2DGen_GeneratedTypeDesc_offs[] = {
   X2C_OFS(struct H2DGen_GeneratedTypeDesc,name),
   X2C_OFS(struct H2DGen_GeneratedTypeDesc,type),
   X2C_OFS_END
};
struct X2C_TD_STR H2DGen_GeneratedTypeDesc_desc = {
   sizeof(struct H2DGen_GeneratedTypeDesc), "GeneratedTypeDesc",
   &H2DGen_desc, &H2DGen_OutStringDesc_desc, 2, 2,
   { &adt_ElementDesc_desc, &adt_NamedElementDesc_desc,
                &H2DGen_GeneratedTypeDesc_desc, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                 0, 0, 0 },
   H2DGen_GeneratedTypeDesc_proc, H2DGen_GeneratedTypeDesc_offs, 0, 0, 0,
                &H2DGen_GeneratedTypeDesc_desc, 0x93678150lu
};

struct H2DGen_PrintStringDesc;
extern struct X2C_TD_STR H2DGen_PrintStringDesc_desc;

typedef struct H2DGen_PrintStringDesc * PrintString;


struct H2DGen_PrintStringDesc {
   X2C_INT32 _dummy_;
   LongStrs_String str;
   X2C_INT32 leadtab;
   X2C_INT32 tab;
   X2C_BOOLEAN ln;
};
static X2C_PROC H2DGen_PrintStringDesc_proc[] = {
   (X2C_PROC)adt_Compare
};
static void * H2DGen_PrintStringDesc_offs[] = {
   X2C_OFS(struct H2DGen_PrintStringDesc,str),
   X2C_OFS_END
};
struct X2C_TD_STR H2DGen_PrintStringDesc_desc = {
   sizeof(struct H2DGen_PrintStringDesc), "PrintStringDesc",
   &H2DGen_desc, &H2DGen_GeneratedTypeDesc_desc, 1, 1,
   { &adt_ElementDesc_desc, &H2DGen_PrintStringDesc_desc, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0 },
   H2DGen_PrintStringDesc_proc, H2DGen_PrintStringDesc_offs, 0, 0, 0,
                &H2DGen_PrintStringDesc_desc, 0x93678150lu
};

static H2DObjs_Header ModuleSystem;

static FILE0 OutFile;

static HFILE HFile0;

static FILE0 StdDefFile;

static FILE0 MacroDefFile;

static FILE0 MacroModFile;

static LongStrs_String divideCharsForProcedure;

static LongStrs_String nothingDivideChars;

static LongStrs_String stdDivideChars;

static LongStrs_String emptyString;

static X2C_BOOLEAN GenTypeDef;

static X2C_INT32 BackEndSection;

static X2C_INT32 OSectionNative;

static X2C_INT32 OSectionCommon;

static X2C_INT32 OSectionC_Code;

static X2C_INT32 ObjectSection;

static adt_Tree GeneratedTypes;

static X2C_BOOLEAN comment_was_just_generated;

static X2C_BOOLEAN comment_was_just_generated_in_;

static X2C_BOOLEAN InsertEmptyLine;

static X2C_INT32 comment_position;

static X2C_INT32 last_string_length;

static adt_Stack NameOfGeneratedType;

static X2C_BOOLEAN ValueHandlerOn;

static H2DObjs_Comment0 declaration_without_definition;

static H2DObjs_Comment0 simple_comment;

static adt_Tree Modula2KeyWords;

static adt_List Import;

static adt_List AdtImport;

static adt_List TagDefinedInOtherHeader;

static adt_List ListForExtractNamedTypes;

static adt_List WriteBuffer;

static X2C_BOOLEAN C_CodeSectionOpen;

static void ( *WriteStrLn)(X2C_CHAR [], X2C_CARD32, LongStrs_String *,
                X2C_INT32, X2C_INT32);

static void ( *WriteStr)(X2C_CHAR [], X2C_CARD32, LongStrs_String *,
                X2C_INT32, X2C_INT32);

static LongStrs_String null;

static LongStrs_String BlankString;

static adt_List GeneratedTypeStorage;

static adt_List OutStringStorage;

static adt_List PrintStringStorage;


static void Deallocate(adt_Element e)
{
   adt_Element e1 = 0;
   adt_List anonym = 0;
   adt_List anonym0 = 0;
   adt_List anonym1 = 0;
   if (e==0) return;
   if (X2C_GET_TD(e)->base[2]==&H2DGen_GeneratedTypeDesc_desc) {
      X2C_CALL(adt_Insert_0,X2C_GET_TD(GeneratedTypeStorage),
                14)(GeneratedTypeStorage, (adt_Element)e);
   }
   else if (X2C_GET_TD(e)->base[1]==&H2DGen_OutStringDesc_desc) {
      anonym = ((OutString)e)->comment0;
      X2C_CALL(adt_FindFirst_0,X2C_GET_TD(anonym),6)(anonym, &e1);
      while (e1) {
         if (X2C_GET_TD(e1)->base[3]==&H2DObjs_CommentDesc_desc) {
         }
         else if (X2C_GET_TD(e1)->base[1]==&adt_NamedElementDesc_desc) {
            adt_Deallocate((adt_Element)e1);
         }
         anonym0 = ((OutString)e)->comment0;
         X2C_CALL(adt_FindNext_0,X2C_GET_TD(anonym0),8)(anonym0, &e1);
      }
      anonym1 = ((OutString)e)->comment0;
      X2C_CALL(adt_Clean_,X2C_GET_TD(anonym1),15)(anonym1);
      X2C_CALL(adt_Insert_0,X2C_GET_TD(OutStringStorage),
                14)(OutStringStorage, (adt_Element)e);
   }
   else if (X2C_GET_TD(e)->base[1]==&H2DGen_PrintStringDesc_desc) {
      LongStrs_Deallocate(&((PrintString)e)->str);
      X2C_CALL(adt_Insert_0,X2C_GET_TD(PrintStringStorage),
                14)(PrintStringStorage, (adt_Element)e);
   }
} /* end Deallocate() */


static void Assign(const X2C_CHAR src[], X2C_CARD32 src_len,
                LongStrs_String * dest)
{
   LongStrs_Allocate(dest, 1000L);
   LongStrs_Assign(src, src_len, dest);
} /* end Assign() */


static void BlendLists(adt_List from, adt_List * to)
{
   adt_Element found = 0;
   adt_Element elm = 0;
   X2C_INT32 id;
   if (*to==0) adt_NewList(to);
   if (from==0) return;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(from),6)(from, &elm);
   while (elm) {
      X2C_CALL(adt_Backup_0,X2C_GET_TD(from),2)(from, &id);
      X2C_CALL(adt_Find_0,X2C_GET_TD(*to),11)(*to, elm, &found);
      if (found==0) X2C_CALL(adt_Insert_0,X2C_GET_TD(*to),14)(*to, elm);
      X2C_CALL(adt_Restore_0,X2C_GET_TD(from),1)(from, id);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(from),8)(from, &elm);
   }
} /* end BlendLists() */


static void ListToTree(adt_List from, adt_Tree to)
{
   adt_Element elm = 0;
   if (to==0) adt_NewTree(&to);
   if (from==0) return;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(from),6)(from, &elm);
   while (elm) {
      if (X2C_GET_TD(elm)->base[1]==&adt_NamedElementDesc_desc && LongStrs_Length1(((adt_NamedElement)
                elm)->name)>0L) {
         X2C_CALL(adt_Insert_,X2C_GET_TD(to),11)(to, elm);
      }
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(from),8)(from, &elm);
   }
} /* end ListToTree() */


static void SpaceStr(LongStrs_String * str, X2C_INT32 number)
{
   Assign("", 1ul, str);
   while (number>0L) {
      LongStrs_AppendChar(' ', str);
      --number;
   }
} /* end SpaceStr() */


static void IntToStr(X2C_INT32 int0, LongStrs_String * str)
{
   LongStrs_String intStr = 0;
   LongStrs_Allocate(&intStr, X2C_DIV(int0,10L)+2L);
   WholeStr_IntToStr(int0, intStr->Adr, intStr->Len0);
   LongStrs_Append(intStr->Adr, intStr->Len0, str);
   LongStrs_Deallocate(&intStr);
} /* end IntToStr() */


static void NewPrintString(PrintString * prStr, X2C_INT32 leadtab,
                X2C_INT32 tab, X2C_BOOLEAN ln)
{
   adt_Element e = 0;
   if (X2C_CALL(adt_IsEmpty_1,X2C_GET_TD(PrintStringStorage),
                4)(PrintStringStorage)) {
      X2C_NEW(&H2DGen_PrintStringDesc_desc,(X2C_ADDRESS*)prStr,
                sizeof(struct H2DGen_PrintStringDesc),0);
   }
   else {
      X2C_CALL(adt_FindFirst_0,X2C_GET_TD(PrintStringStorage),
                6)(PrintStringStorage, &e);
      X2C_CALL(adt_DeleteCurrent_,X2C_GET_TD(PrintStringStorage),
                3)(PrintStringStorage);
      *prStr = (PrintString)e;
   }
   (*prStr)->leadtab = leadtab;
   (*prStr)->tab = tab;
   (*prStr)->ln = ln;
} /* end NewPrintString() */


static void ExtractModName(const X2C_CHAR src[], X2C_CARD32 src_len,
                LongStrs_String * m_name)
{
   X2C_INT32 pos;
   pos = LongStrs_FindPos(src, src_len, '.');
   if (pos>0L) LongStrs_Extract(src, src_len, 0L, pos, m_name);
} /* end ExtractModName() */


static void MakeMonth(LongStrs_String * outStr, X2C_INT32 month)
{
   switch (month) {
   case 1L:
      LongStrs_Append("Jan", 4ul, outStr);
      break;
   case 2L:
      LongStrs_Append("Feb", 4ul, outStr);
      break;
   case 3L:
      LongStrs_Append("Mar", 4ul, outStr);
      break;
   case 4L:
      LongStrs_Append("Apr", 4ul, outStr);
      break;
   case 5L:
      LongStrs_Append("May", 4ul, outStr);
      break;
   case 6L:
      LongStrs_Append("Jun", 4ul, outStr);
      break;
   case 7L:
      LongStrs_Append("Jul", 4ul, outStr);
      break;
   case 8L:
      LongStrs_Append("Aug", 4ul, outStr);
      break;
   case 9L:
      LongStrs_Append("Sep", 4ul, outStr);
      break;
   case 10L:
      LongStrs_Append("Oct", 4ul, outStr);
      break;
   case 11L:
      LongStrs_Append("Nov", 4ul, outStr);
      break;
   case 12L:
      LongStrs_Append("Dec", 4ul, outStr);
      break;
   default:
      X2C_TRAP(X2C_CASE_TRAP);
   } /* end switch */
} /* end MakeMonth() */


static void GetTime(LongStrs_String * outStr)
{
   struct SysClock_DateTime data;
   if (SysClock_CanGetClock()) {
      SysClock_GetClock(&data);
      Assign("  ", 3ul, outStr);
      MakeMonth(outStr, (X2C_INT32)data.month);
      LongStrs_Append(" ", 2ul, outStr);
      IntToStr((X2C_INT32)data.day, outStr);
      LongStrs_Append("  ", 3ul, outStr);
      IntToStr((X2C_INT32)data.hour, outStr);
      LongStrs_AppendChar(':', outStr);
      IntToStr((X2C_INT32)data.minute, outStr);
      LongStrs_AppendChar(':', outStr);
      IntToStr((X2C_INT32)data.second, outStr);
      LongStrs_Append("  ", 3ul, outStr);
      IntToStr((X2C_INT32)data.year, outStr);
   }
} /* end GetTime() */


static void Error(X2C_INT32 number, X2C_LOC contens[],
                X2C_CARD32 contens_len)
{
   H2DMsg_Statistics anonym = 0;
   LongStrs_String anonym0 = 0;
   if (OutFile->header==0) {
      H2DMsg_File = OutFile->name;
      H2DMsg_Line = OutFile->line;
      H2DMsg_Pos = OutFile->pos;
      H2DMsg_Error0(number, contens, contens_len);
   }
   else {
      anonym = OutFile->header->stat;
      anonym0 = OutFile->name;
      X2C_CALL(H2DMsg_Error_,X2C_GET_TD(anonym),3)(anonym, number,
                anonym0->Adr, anonym0->Len0, OutFile->line, OutFile->pos,
                contens, contens_len);
   }
} /* end Error() */


static void HError(X2C_INT32 number, H2DObjs_Object object,
                X2C_LOC contens[], X2C_CARD32 contens_len)
{
   H2DMsg_Statistics anonym = 0;
   LongStrs_String anonym0 = 0;
   if (OutFile->header==0) {
      H2DMsg_File = object->file;
      H2DMsg_Line = object->line;
      H2DMsg_Pos = 0L;
      H2DMsg_Error0(number, contens, contens_len);
   }
   else {
      anonym = OutFile->header->stat;
      anonym0 = object->file;
      X2C_CALL(H2DMsg_Error_,X2C_GET_TD(anonym),3)(anonym, number,
                anonym0->Adr, anonym0->Len0, object->line, 0L, contens,
                contens_len);
   }
} /* end HError() */


static void HWriteStr(const X2C_CHAR str[], X2C_CARD32 str_len,
                X2C_INT32 leadtab, X2C_INT32 tab)
{
   HFile0->line = H2DFile_FWriteStr(HFile0->hand, str, str_len, leadtab,
                tab)+HFile0->line;
   HFile0->emptyLine = 0;
} /* end HWriteStr() */


static void HWriteStrLn(const X2C_CHAR str[], X2C_CARD32 str_len,
                X2C_INT32 leadtab, X2C_INT32 tab)
{
   HFile0->line = H2DFile_FWriteStrLn(HFile0->hand, str, str_len, leadtab,
                tab)+HFile0->line;
   HFile0->emptyLine = 0;
} /* end HWriteStrLn() */


static void HWriteEmptyLine(void)
{
   if (HFile0->emptyLine) return;
   HWriteStrLn("", 1ul, 0L, 0L);
   HFile0->emptyLine = 1;
} /* end HWriteEmptyLine() */


static void GetRealHFileName(LongStrs_String * outStr)
{
   LongStrs_String str = 0;
   LongStrs_String anonym = 0;
   anonym = OutFile->header->name;
   Assign(anonym->Adr, anonym->Len0, &str);
   if (OutFile->header->cstdlib) {
      LongStrs_Insert("<", 2ul, 0L, &str);
      LongStrs_Append(">", 2ul, &str);
   }
   else {
      LongStrs_Insert("\"", 2ul, 0L, &str);
      LongStrs_Append("\"", 2ul, &str);
   }
   LongStrs_Append(str->Adr, str->Len0, outStr);
   LongStrs_Deallocate(&str);
} /* end GetRealHFileName() */


static void GenHFileTitle(void)
{
   LongStrs_String str = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   LongStrs_String anonym2 = 0;
   LongStrs_String anonym3 = 0;
   str = 0;
   GetTime(&str);
   anonym = HFile0->name;
   LongStrs_Insert(anonym->Adr, anonym->Len0, 0L, &str);
   LongStrs_Insert("/* ", 4ul, 0L, &str);
   LongStrs_Append(" */", 4ul, &str);
   HWriteStr(str->Adr, str->Len0, 0L, 0L);
   Assign("/* Generated by H2D", 20ul, &str);
   LongStrs_Append(" v1.31.0 ", 10ul, &str);
   LongStrs_Append("*/", 3ul, &str);
   HWriteStrLn(str->Adr, str->Len0, 0L, 0L);
   Assign("/* from module ", 16ul, &str);
   anonym0 = OutFile->modname;
   LongStrs_Append(anonym0->Adr, anonym0->Len0, &str);
   LongStrs_Append(" and header ", 13ul, &str);
   anonym1 = OutFile->header->name;
   LongStrs_Append(anonym1->Adr, anonym1->Len0, &str);
   LongStrs_Append(".", 2ul, &str);
   LongStrs_Append(" */", 4ul, &str);
   HWriteStrLn(str->Adr, str->Len0, 0L, 0L);
   HWriteStrLn("/* Types which were created during translation */", 50ul, 0L,
                 0L);
   HWriteStrLn("", 1ul, 0L, 0L);
   Assign("#include ", 10ul, &str);
   GetRealHFileName(&str);
   if (!OutFile->header->preheader) HWriteStrLn(str->Adr, str->Len0, 0L, 0L);
   HWriteStrLn("", 1ul, 0L, 0L);
   Assign("#ifndef ", 9ul, &str);
   anonym2 = HFile0->define;
   LongStrs_Append(anonym2->Adr, anonym2->Len0, &str);
   HWriteStrLn(str->Adr, str->Len0, 0L, 0L);
   Assign("#define ", 9ul, &str);
   anonym3 = HFile0->define;
   LongStrs_Append(anonym3->Adr, anonym3->Len0, &str);
   HWriteStrLn(str->Adr, str->Len0, 0L, 0L);
   LongStrs_Deallocate(&str);
   HWriteStrLn("", 1ul, 0L, 0L);
} /* end GenHFileTitle() */


static void GenIncludeList(void)
{
   LongStrs_String str = 0;
   adt_Element elm = 0;
   LongStrs_String anonym = 0;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(AdtImport),6)(AdtImport, &elm);
   while (elm) {
      LongStrs_Assign("#include \"", 11ul, &str);
      anonym = ((adt_NamedElement)elm)->name;
      LongStrs_Append(anonym->Adr, anonym->Len0, &str);
      LongStrs_Append(".h\"", 4ul, &str);
      HWriteStrLn(str->Adr, str->Len0, 0L, 0L);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(AdtImport),8)(AdtImport, &elm);
   }
   HWriteStrLn("", 1ul, 0L, 0L);
   LongStrs_Deallocate(&str);
} /* end GenIncludeList() */


static void NewHFILE(void)
{
   LongStrs_String path = 0;
   LongStrs_String ext = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   LongStrs_String anonym2 = 0;
   LongStrs_String anonym3 = 0;
   LongStrs_String anonym4 = 0;
   X2C_SEQ tmp[3];
   if (H2DMsg_WasError) return;
   X2C_NEW(&H2DGen_HFILEDesc_desc,(X2C_ADDRESS*) &HFile0,
                sizeof(struct H2DGen_HFILEDesc),0);
   HFile0->line = 0L;
   HFile0->emptyLine = 0;
   anonym = OutFile->header->name;
   H2DFile_SplitName(anonym->Adr, anonym->Len0, &path, &HFile0->name, &ext);
   if (H2DFile_IsAbsolutePath(path->Adr, path->Len0)) {
      anonym0 = OutFile->modname;
      H2DFile_CreateName("", 1ul, anonym0->Adr, anonym0->Len0,
                H2DCfg_HeaderExtension->Adr, H2DCfg_HeaderExtension->Len0,
                &HFile0->name);
   }
   else {
      anonym1 = OutFile->modname;
      H2DFile_CreateName(path->Adr, path->Len0, anonym1->Adr, anonym1->Len0,
                H2DCfg_HeaderExtension->Adr, H2DCfg_HeaderExtension->Len0,
                &HFile0->name);
   }
   anonym2 = OutFile->modname;
   LongStrs_Assign(anonym2->Adr, anonym2->Len0, &HFile0->define);
   LongStrs_Append("_H_", 4ul, &HFile0->define);
   if (anonym3 = HFile0->name,H2DFile_Open(anonym3->Adr, anonym3->Len0, 2L,
                &HFile0->hand, 0x8U)) HFile0->created = 1;
   else {
      anonym4 = HFile0->name;
      Error(6L, (tmp[0].adr = anonym4->Adr, tmp[1].val = 0,
                tmp[2].val = anonym4->Len0*1u-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
      return;
   }
   GenHFileTitle();
   LongStrs_Deallocate(&ext);
   LongStrs_Deallocate(&path);
   GenIncludeList();
} /* end NewHFILE() */


static void CloseHFile(void)
{
   X2C_BOOLEAN done;
   LongStrs_String str = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   if (HFile0==0) return;
   if (HFile0->created) {
      Assign("#endif ", 8ul, &str);
      LongStrs_Append(" /* ", 5ul, &str);
      anonym = HFile0->define;
      LongStrs_Append(anonym->Adr, anonym->Len0, &str);
      LongStrs_Append(" */", 4ul, &str);
      HWriteStrLn("", 1ul, 0L, 0L);
      HWriteStrLn(str->Adr, str->Len0, 0L, 0L);
      LongStrs_Deallocate(&str);
      H2DFile_Close(HFile0->hand);
      if (H2DMsg_WasError) {
         anonym0 = HFile0->name;
         H2DFile_Delete(anonym0->Adr, anonym0->Len0, &done);
      }
   }
   HFile0 = 0;
} /* end CloseHFile() */


static void HGenDefine(const X2C_CHAR what[], X2C_CARD32 what_len,
                const X2C_CHAR how[], X2C_CARD32 how_len)
{
   if (HFile0==0) return;
   H2DFile_UnlimitedSizeOutputLin = 1;
   HWriteStrLn("#define ", 9ul, 0L, 0L);
   HWriteStr(what, what_len, 0L, 0L);
   HWriteStr(how, how_len, 2L, 0L);
   H2DFile_UnlimitedSizeOutputLin = 0;
} /* end HGenDefine() */


static void HMakeQualident(H2DObjs_Type type, LongStrs_String * str)
{
   LongStrs_String anonym = 0;
   anonym = type->name;
   LongStrs_Append(anonym->Adr, anonym->Len0, str);
} /* end HMakeQualident() */


static void HMakeModifier(adt_List modifier, LongStrs_String * str,
                X2C_INT32 mode)
{
   adt_Element elm = 0;
   X2C_INT32 id;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(modifier),6)(modifier, &elm);
   while (elm) {
      X2C_CALL(adt_Backup_0,X2C_GET_TD(modifier),2)(modifier, &id);
      if (mode==7701L || mode==7704L) {
         switch (((H2DObjs_Modifier)elm)->modifier) {
         case 5034L:
            LongStrs_Append(" pascal", 8ul, str);
            break;
         case 5036L:
            LongStrs_Append(" cdecl", 7ul, str);
            break;
         case 5035L:
            LongStrs_Append(" fortran", 9ul, str);
            break;
         } /* end switch */
      }
      if (mode==7702L || mode==7704L) {
         switch (((H2DObjs_Modifier)elm)->modifier) {
         case 5038L:
            LongStrs_Append(" far", 5ul, str);
            break;
         case 5039L:
            LongStrs_Append(" near", 6ul, str);
            break;
         case 5040L:
            LongStrs_Append(" huge", 6ul, str);
            break;
         } /* end switch */
      }
      if (mode==7703L || mode==7704L) {
         switch (((H2DObjs_Modifier)elm)->modifier) {
         case 5009L:
            LongStrs_Append(" const", 7ul, str);
            break;
         case 5032L:
            LongStrs_Append(" volatile", 10ul, str);
            break;
         } /* end switch */
      }
      if (mode==7705L || mode==7704L) {
         switch (((H2DObjs_Modifier)elm)->modifier) {
         case 5033L:
            LongStrs_Append(" interrupt", 11ul, str);
            break;
         case 5037L:
            LongStrs_Append(" syscall", 9ul, str);
            break;
         } /* end switch */
      }
      X2C_CALL(adt_Restore_0,X2C_GET_TD(modifier),1)(modifier, id);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(modifier),8)(modifier, &elm);
   }
} /* end HMakeModifier() */


static void HMakeBaseType(H2DObjs_Type type, adt_List buffer,
                LongStrs_String * tail)
{
   adt_Element elm = 0;
   PrintString outStr = 0;
   X2C_CALL(adt_FindLast_0,X2C_GET_TD(buffer),5)(buffer, &elm);
   outStr = (PrintString)elm;
   HMakeModifier(type->modifier, &outStr->str, 7703L);
   switch (type->type) {
   case 0L:
      LongStrs_Append(" signed char", 13ul, &outStr->str);
      break;
   case 1L:
      LongStrs_Append(" signed int", 12ul, &outStr->str);
      break;
   case 2L:
      LongStrs_Append(" signed short int", 18ul, &outStr->str);
      break;
   case 3L:
      LongStrs_Append(" signed long int", 17ul, &outStr->str);
      break;
   case 4L:
      LongStrs_Append(" unsigned char", 15ul, &outStr->str);
      break;
   case 5L:
      LongStrs_Append(" unsigned int", 14ul, &outStr->str);
      break;
   case 6L:
      LongStrs_Append(" unsigned short int", 20ul, &outStr->str);
      break;
   case 7L:
      LongStrs_Append(" unsigned long int", 19ul, &outStr->str);
      break;
   case 8L:
      LongStrs_Append(" float", 7ul, &outStr->str);
      break;
   case 9L:
      LongStrs_Append(" double", 8ul, &outStr->str);
      break;
   case 10L:
      LongStrs_Append(" long float", 12ul, &outStr->str);
      break;
   case 11L:
      LongStrs_Append(" long double", 13ul, &outStr->str);
      break;
   case 12L:
      LongStrs_Append(" void", 6ul, &outStr->str);
      break;
   default:
      X2C_TRAP(X2C_CASE_TRAP);
   } /* end switch */
   HMakeModifier(type->modifier, &outStr->str, 7701L);
   Assign("", 1ul, tail);
} /* end HMakeBaseType() */


static void HMakeSynonym(H2DObjs_Type type, adt_List buffer,
                LongStrs_String * tail)
{
   adt_Element elm = 0;
   PrintString outStr = 0;
   X2C_SEQ tmp[3];
   X2C_CALL(adt_FindLast_0,X2C_GET_TD(buffer),5)(buffer, &elm);
   outStr = (PrintString)elm;
   Assign("", 1ul, tail);
   HMakeModifier(type->modifier, &outStr->str, 7703L);
   if (LongStrs_Length1(type->name)>0L) {
      LongStrs_Append(" ", 2ul, &outStr->str);
      HMakeModifier(type->modifier, &outStr->str, 7701L);
      HMakeQualident(type, &outStr->str);
   }
   else {
      Error(28L, (tmp[0].adr = "HMakeSynonym", tmp[1].val = 0,
                tmp[2].val = 13u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
   }
} /* end HMakeSynonym() */


static void NamberArrayElement(PrintString outStr, LongStrs_String * tail,
                H2DObjs_Type type)
{
   H2DObjs_ConstantValue result = 0;
   LongStrs_String s = 0;
   X2C_SEQ tmp[3];
   if (type->expr==0) return;
   X2C_CALL(H2DObjs_ComputeExpression_,X2C_GET_TD(type->expr),2)(type->expr,
                &result, 0);
   if (result->type==6072L) {
      s = X2C_CALL(H2DObjs_GetText_,X2C_GET_TD(result),1)(result, 0);
      LongStrs_Insert(s->Adr, s->Len0, 0L, tail);
   }
   else {
      LongStrs_Append(" illegal size of array", 23ul, &outStr->str);
      Error(28L, (tmp[0].adr = "H2DGen.HMakeArrayType.NumberArrayElement",
                tmp[1].val = 0, tmp[2].val = 41u-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
   }
   H2DObjs_Deallocate((adt_Element)result);
} /* end NamberArrayElement() */

static void HGenType(H2DObjs_Type, adt_List, LongStrs_String *);


static void HMakeArrayType(H2DObjs_Type type, adt_List buffer,
                LongStrs_String * tail)
{
   adt_Element elm = 0;
   PrintString outStr = 0;
   HGenType(type->base, buffer, tail);
   if (H2DMsg_WasError) return;
   X2C_CALL(adt_FindLast_0,X2C_GET_TD(buffer),5)(buffer, &elm);
   outStr = (PrintString)elm;
   if (LongStrs_Length1(*tail)>0L && type->base->type!=1002L) {
      LongStrs_Append("(", 2ul, &outStr->str);
      LongStrs_Insert(")", 2ul, 0L, tail);
   }
   HMakeModifier(type->modifier, &outStr->str, 7704L);
   LongStrs_Insert("]", 2ul, 0L, tail);
   NamberArrayElement(outStr, tail, type);
   if (H2DMsg_WasError) return;
   LongStrs_Insert("[", 2ul, 0L, tail);
} /* end HMakeArrayType() */


static void MakeOneArguments(LongStrs_String * tail,
                H2DObjs_TypedObject arg)
{
   adt_List localBuffer = 0;
   LongStrs_String localTail = 0;
   PrintString loutStr = 0;
   adt_Element lelm = 0;
   X2C_INT32 id;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   NewPrintString(&loutStr, 0L, 0L, 1);
   adt_NewList(&localBuffer);
   X2C_CALL(adt_Insert_0,X2C_GET_TD(localBuffer),14)(localBuffer,
                (adt_Element)loutStr);
   Assign("", 1ul, &loutStr->str);
   if (arg->obj==2003L) Assign(" ...", 5ul, &loutStr->str);
   else HGenType(arg->type, localBuffer, &localTail);
   if (H2DMsg_WasError) return;
   X2C_CALL(adt_FindLast_0,X2C_GET_TD(localBuffer),5)(localBuffer, &lelm);
   X2C_CALL(adt_Backup_0,X2C_GET_TD(localBuffer),2)(localBuffer, &id);
   loutStr = (PrintString)lelm;
   if (LongStrs_Length1(arg->name)>0L) {
      anonym = arg->name;
      LongStrs_Insert(anonym->Adr, anonym->Len0, 0L, &localTail);
      LongStrs_Insert(" ", 2ul, 0L, &localTail);
   }
   anonym0 = loutStr->str;
   LongStrs_Insert(anonym0->Adr, anonym0->Len0, 0L, &localTail);
   X2C_CALL(adt_Restore_0,X2C_GET_TD(localBuffer),1)(localBuffer, id);
   X2C_CALL(adt_FindPrev_0,X2C_GET_TD(localBuffer),7)(localBuffer, &lelm);
   while (lelm) {
      X2C_CALL(adt_Backup_0,X2C_GET_TD(localBuffer),2)(localBuffer, &id);
      anonym1 = ((PrintString)lelm)->str;
      LongStrs_Insert(anonym1->Adr, anonym1->Len0, 0L, &localTail);
      X2C_CALL(adt_Restore_0,X2C_GET_TD(localBuffer),1)(localBuffer, id);
      Deallocate((adt_Element)lelm);
      X2C_CALL(adt_FindPrev_0,X2C_GET_TD(localBuffer),7)(localBuffer, &lelm);
   }
   X2C_CALL(adt_Clean_,X2C_GET_TD(localBuffer),15)(localBuffer);
   adt_Deallocate((adt_Element)localBuffer);
   LongStrs_Insert(localTail->Adr, localTail->Len0, 0L, tail);
   LongStrs_Deallocate(&localTail);
} /* end MakeOneArguments() */


static void HMakeFuncType(H2DObjs_Type type, adt_List buffer,
                LongStrs_String * tail)
{
   adt_Element elm = 0;
   PrintString outStr = 0;
   X2C_INT32 id;
   X2C_CALL(adt_FindLast_0,X2C_GET_TD(buffer),5)(buffer, &elm);
   outStr = (PrintString)elm;
   HGenType(type->base, buffer, tail);
   if (H2DMsg_WasError) return;
   if (LongStrs_Length1(*tail)>0L) {
      LongStrs_Append("(", 2ul, &outStr->str);
      LongStrs_Insert(")", 2ul, 0L, tail);
   }
   HMakeModifier(type->modifier, &outStr->str, 7704L);
   LongStrs_Insert(" )", 3ul, 0L, tail);
   X2C_CALL(adt_FindLast_0,X2C_GET_TD(type->vars),5)(type->vars, &elm);
   while (elm && X2C_GET_TD(elm)->base[3]!=&H2DObjs_TypedObjectDesc_desc) {
      X2C_CALL(adt_FindPrev_0,X2C_GET_TD(type->vars),7)(type->vars, &elm);
   }
   if (elm) {
      X2C_CALL(adt_Backup_0,X2C_GET_TD(type->vars),2)(type->vars, &id);
      MakeOneArguments(tail, (H2DObjs_TypedObject)elm);
      if (H2DMsg_WasError) return;
      X2C_CALL(adt_Restore_0,X2C_GET_TD(type->vars),1)(type->vars, id);
      X2C_CALL(adt_FindPrev_0,X2C_GET_TD(type->vars),7)(type->vars, &elm);
      while (elm) {
         X2C_CALL(adt_Backup_0,X2C_GET_TD(type->vars),2)(type->vars, &id);
         if (X2C_GET_TD(elm)->base[3]==&H2DObjs_TypedObjectDesc_desc) {
            LongStrs_Insert(",", 2ul, 0L, tail);
            MakeOneArguments(tail, (H2DObjs_TypedObject)elm);
            if (H2DMsg_WasError) return;
         }
         X2C_CALL(adt_Restore_0,X2C_GET_TD(type->vars),1)(type->vars, id);
         X2C_CALL(adt_FindPrev_0,X2C_GET_TD(type->vars),7)(type->vars, &elm);
      }
   }
   LongStrs_Insert("(", 2ul, 0L, tail);
} /* end HMakeFuncType() */


static void HMakePointerType(H2DObjs_Type type, adt_List buffer,
                LongStrs_String * tail)
{
   adt_Element elm = 0;
   PrintString outStr = 0;
   adt_List modifier = 0;
   X2C_CALL(adt_FindLast_0,X2C_GET_TD(buffer),5)(buffer, &elm);
   outStr = (PrintString)elm;
   HMakeModifier(type->modifier, &outStr->str, 7703L);
   HGenType(type->base, buffer, tail);
   if (H2DMsg_WasError) return;
   X2C_CALL(adt_FindLast_0,X2C_GET_TD(buffer),5)(buffer, &elm);
   outStr = (PrintString)elm;
   HMakeModifier(type->modifier, &outStr->str, 7705L);
   if (LongStrs_Length1(*tail)>0L) {
      LongStrs_Append("(", 2ul, &outStr->str);
      LongStrs_Insert(")", 2ul, 0L, tail);
   }
   HMakeModifier(type->modifier, &outStr->str, 7702L);
   if (type->ptr_modifier->modifier!=3009L) {
      adt_NewList(&modifier);
      X2C_CALL(adt_Insert_0,X2C_GET_TD(modifier),14)(modifier,
                (adt_Element)type->ptr_modifier);
      HMakeModifier(modifier, &outStr->str, 7704L);
   }
   LongStrs_Append(" *", 3ul, &outStr->str);
   HMakeModifier(type->modifier, &outStr->str, 7701L);
} /* end HMakePointerType() */


static void MakeField(PrintString * outStr, adt_List buffer,
                H2DObjs_TypedObject field)
{
   LongStrs_String s = 0;
   LongStrs_String tail = 0;
   PrintString loutStr = 0;
   adt_Element elm = 0;
   H2DObjs_ConstantValue result = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   X2C_SEQ tmp[3];
   switch (field->obj) {
   case 2000L:
      X2C_CALL(adt_Insert_0,X2C_GET_TD(buffer),14)(buffer,
                (adt_Element)*outStr);
      HGenType(field->type, buffer, &tail);
      X2C_CALL(adt_FindLast_0,X2C_GET_TD(buffer),5)(buffer, &elm);
      loutStr = (PrintString)elm;
      LongStrs_Append(" ", 2ul, &loutStr->str);
      anonym = field->name;
      LongStrs_Append(anonym->Adr, anonym->Len0, &loutStr->str);
      LongStrs_Append(tail->Adr, tail->Len0, &loutStr->str);
      break;
   case 2002L:
      X2C_CALL(adt_Insert_0,X2C_GET_TD(buffer),14)(buffer,
                (adt_Element)*outStr);
      HGenType(field->type, buffer, &tail);
      X2C_CALL(adt_FindLast_0,X2C_GET_TD(buffer),5)(buffer, &elm);
      loutStr = (PrintString)elm;
      LongStrs_Append(" ", 2ul, &loutStr->str);
      if (LongStrs_Length1(field->name)>0L) {
         anonym0 = field->name;
         LongStrs_Append(anonym0->Adr, anonym0->Len0, &loutStr->str);
         LongStrs_Append(" ", 2ul, &loutStr->str);
      }
      LongStrs_Append(": ", 3ul, &loutStr->str);
      X2C_CALL(H2DObjs_ComputeExpression_,X2C_GET_TD(field->expr),
                2)(field->expr, &result, 0);
      if (result->type==6072L) {
         s = X2C_CALL(H2DObjs_GetText_,X2C_GET_TD(result),1)(result, 0);
         LongStrs_Append(s->Adr, s->Len0, &loutStr->str);
         H2DObjs_Deallocate((adt_Element)result);
      }
      else {
         H2DObjs_Deallocate((adt_Element)result);
         LongStrs_Append(" illegal size of array", 23ul, &loutStr->str);
         Error(28L, (tmp[0].adr = "H2DGen.HMakeStructType.MakeField",
                tmp[1].val = 0, tmp[2].val = 33u-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
         return;
      }
      LongStrs_Append(tail->Adr, tail->Len0, &loutStr->str);
      break;
   default:;
      Error(28L, (tmp[0].adr = "H2DGen.HMakeStructType", tmp[1].val = 0,
                tmp[2].val = 23u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      return;
   } /* end switch */
   LongStrs_Append(";", 2ul, &loutStr->str);
} /* end MakeField() */


static void HMakeStructUnionType(H2DObjs_Type type, adt_List buffer,
                LongStrs_String * tail)
{
   adt_Element elm = 0;
   PrintString outStr = 0;
   X2C_INT32 tab;
   X2C_INT32 leadtab;
   X2C_INT32 id;
   X2C_CALL(adt_FindLast_0,X2C_GET_TD(buffer),5)(buffer, &elm);
   outStr = (PrintString)elm;
   leadtab = outStr->leadtab-7L;
   tab = outStr->tab;
   Assign("", 1ul, tail);
   if (leadtab<0L) leadtab = 0L;
   HMakeModifier(type->modifier, &outStr->str, 7703L);
   if (type->type==1001L) LongStrs_Append(" struct", 8ul, &outStr->str);
   else LongStrs_Append(" union", 7ul, &outStr->str);
   if (LongStrs_Length1(type->name)>0L) {
      LongStrs_Append(" ", 2ul, &outStr->str);
      HMakeQualident(type, &outStr->str);
      if (!OutFile->header->preheader || type->h_generated) return;
      type->h_generated = 1;
   }
   LongStrs_Append(" ", 2ul, &outStr->str);
   LongStrs_Append("{", 2ul, &outStr->str);
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(type->vars),6)(type->vars, &elm);
   while (elm) {
      X2C_CALL(adt_Backup_0,X2C_GET_TD(type->vars),2)(type->vars, &id);
      NewPrintString(&outStr, 0L, 0L, 1);
      outStr->leadtab = leadtab+9L;
      if (X2C_GET_TD(elm)->base[3]==&H2DObjs_TypedObjectDesc_desc) {
         MakeField(&outStr, buffer, (H2DObjs_TypedObject)elm);
         if (H2DMsg_WasError) return;
      }
      X2C_CALL(adt_Restore_0,X2C_GET_TD(type->vars),1)(type->vars, id);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(type->vars),8)(type->vars, &elm);
   }
   NewPrintString(&outStr, 0L, 0L, 1);
   outStr->leadtab = leadtab+8L;
   outStr->tab = tab+4L;
   Assign("}", 2ul, &outStr->str);
   X2C_CALL(adt_Insert_0,X2C_GET_TD(buffer),14)(buffer, (adt_Element)outStr);
} /* end HMakeStructUnionType() */


static void MakeEnumElm(X2C_INT32 * prevValue, PrintString outStr,
                H2DObjs_TypedObject enum0)
{
   H2DObjs_ConstantValue result = 0;
   LongStrs_String value = 0;
   LongStrs_String anonym = 0;
   X2C_SEQ tmp[3];
   LongStrs_Append(" ", 2ul, &outStr->str);
   anonym = enum0->name;
   LongStrs_Append(anonym->Adr, anonym->Len0, &outStr->str);
   X2C_CALL(H2DObjs_ComputeExpression_,X2C_GET_TD(enum0->expr),
                2)(enum0->expr, &result, 0);
   if (result->type==6072L) {
      if (result->int0!=*prevValue+1L) {
         value = X2C_CALL(H2DObjs_GetText_,X2C_GET_TD(result),1)(result, 0);
         LongStrs_Append("=", 2ul, &outStr->str);
         LongStrs_Append(value->Adr, value->Len0, &outStr->str);
         *prevValue = result->int0;
      }
      else ++*prevValue;
   }
   else {
      Error(28L, (tmp[0].adr = "H2DGen.MakeEnumConst", tmp[1].val = 0,
                tmp[2].val = 21u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
   }
   H2DObjs_Deallocate((adt_Element)result);
} /* end MakeEnumElm() */


static void HMakeEnumType(H2DObjs_Type type, adt_List buffer,
                LongStrs_String * tail)
{
   adt_Element elm = 0;
   PrintString outStr = 0;
   X2C_INT32 prevValue;
   X2C_INT32 id;
   prevValue = -1L;
   X2C_CALL(adt_FindLast_0,X2C_GET_TD(buffer),5)(buffer, &elm);
   outStr = (PrintString)elm;
   Assign("", 1ul, tail);
   HMakeModifier(type->modifier, &outStr->str, 7703L);
   LongStrs_Append(" enum", 6ul, &outStr->str);
   if (LongStrs_Length1(type->name)>0L) {
      LongStrs_Append(" ", 2ul, &outStr->str);
      HMakeQualident(type, &outStr->str);
      if (!OutFile->header->preheader || type->h_generated) return;
      type->h_generated = 1;
   }
   LongStrs_Append(" ", 2ul, &outStr->str);
   LongStrs_Append("{", 2ul, &outStr->str);
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(type->vars),6)(type->vars, &elm);
   X2C_CALL(adt_Backup_0,X2C_GET_TD(type->vars),2)(type->vars, &id);
   if (X2C_GET_TD(elm)->base[3]==&H2DObjs_TypedObjectDesc_desc) {
      MakeEnumElm(&prevValue, outStr, (H2DObjs_TypedObject)elm);
   }
   X2C_CALL(adt_Restore_0,X2C_GET_TD(type->vars),1)(type->vars, id);
   X2C_CALL(adt_FindNext_0,X2C_GET_TD(type->vars),8)(type->vars, &elm);
   while (elm) {
      X2C_CALL(adt_Backup_0,X2C_GET_TD(type->vars),2)(type->vars, &id);
      LongStrs_Append(",", 2ul, &outStr->str);
      if (X2C_GET_TD(elm)->base[3]==&H2DObjs_TypedObjectDesc_desc) {
         MakeEnumElm(&prevValue, outStr, (H2DObjs_TypedObject)elm);
      }
      X2C_CALL(adt_Restore_0,X2C_GET_TD(type->vars),1)(type->vars, id);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(type->vars),8)(type->vars, &elm);
   }
   LongStrs_Append("}", 2ul, &outStr->str);
} /* end HMakeEnumType() */


static void HGenType(H2DObjs_Type type, adt_List buffer,
                LongStrs_String * tail)
{
   X2C_SEQ tmp[3];
   Assign("", 1ul, tail);
   switch (type->type) {
   case 0L:
   case 1L:
   case 2L:
   case 3L:
   case 4L:
   case 5L:
   case 6L:
   case 7L:
   case 8L:
   case 9L:
   case 10L:
   case 11L:
   case 12L:
      HMakeBaseType(type, buffer, tail);
      break;
   case 1000L:
      HMakePointerType(type, buffer, tail);
      break;
   case 1001L:
      HMakeStructUnionType(type, buffer, tail);
      break;
   case 1002L:
      HMakeArrayType(type, buffer, tail);
      break;
   case 1005L:
      HMakeStructUnionType(type, buffer, tail);
      break;
   case 1006L:
      HMakeEnumType(type, buffer, tail);
      break;
   case 1004L:
      HMakeFuncType(type, buffer, tail);
      break;
   case 1003L:
      HMakeSynonym(type, buffer, tail);
      break;
   default:;
      Error(28L, (tmp[0].adr = "HGenType", tmp[1].val = 0, tmp[2].val = 9u-1,
                 (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      break;
   } /* end switch */
} /* end HGenType() */


static void Ifndef(H2DObjs_Type type, LongStrs_String * ident)
{
   LongStrs_String anonym = 0;
   Assign("_H2D_TYPE__", 12ul, ident);
   anonym = type->name;
   LongStrs_Append(anonym->Adr, anonym->Len0, ident);
   HWriteStrLn("", 1ul, 0L, 0L);
   HWriteStrLn("#ifndef ", 9ul, 0L, 0L);
   HWriteStr((*ident)->Adr, (*ident)->Len0, 0L, 0L);
   HWriteStrLn("#define ", 9ul, 0L, 0L);
   HWriteStr((*ident)->Adr, (*ident)->Len0, 0L, 0L);
} /* end Ifndef() */


static void Endif(LongStrs_String * ident)
{
   HWriteStrLn("#endif  /* ", 12ul, 0L, 0L);
   HWriteStr((*ident)->Adr, (*ident)->Len0, 0L, 0L);
   HWriteStr(" */", 4ul, 0L, 0L);
   LongStrs_Deallocate(ident);
} /* end Endif() */


static void FlushBuffer(adt_List * buffer, LongStrs_String * ident,
                H2DObjs_Type type)
{
   X2C_INT32 id;
   adt_Element elm = 0;
   LongStrs_String anonym = 0;
   Ifndef(type, ident);
   HWriteEmptyLine();
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(*buffer),6)(*buffer, &elm);
   while (elm) {
      X2C_CALL(adt_Backup_0,X2C_GET_TD(*buffer),2)(*buffer, &id);
      if (X2C_GET_TD(elm)->base[1]==&H2DGen_PrintStringDesc_desc) {
         anonym = ((PrintString)elm)->str;
         HWriteStrLn(anonym->Adr, anonym->Len0, ((PrintString)elm)->leadtab,
                ((PrintString)elm)->tab);
         Deallocate((adt_Element)elm);
      }
      X2C_CALL(adt_Restore_0,X2C_GET_TD(*buffer),1)(*buffer, id);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(*buffer),8)(*buffer, &elm);
   }
   Endif(ident);
   X2C_CALL(adt_Clean_,X2C_GET_TD(*buffer),15)(*buffer);
   adt_Deallocate((adt_Element)*buffer);
} /* end FlushBuffer() */


static void HGenSynonym(H2DObjs_Type type)
{
   PrintString outStr = 0;
   adt_List buffer = 0;
   adt_Element elm = 0;
   LongStrs_String ident = 0;
   LongStrs_String tail = 0;
   LongStrs_String anonym = 0;
   X2C_SEQ tmp[3];
   if (type->h_generated || HFile0==0) return;
   adt_NewList(&buffer);
   NewPrintString(&outStr, 0L, 0L, 1);
   outStr->tab = 8L;
   X2C_CALL(adt_Insert_0,X2C_GET_TD(buffer),14)(buffer, (adt_Element)outStr);
   if (type->type==1003L) {
      Assign("typedef", 8ul, &outStr->str);
      type->h_generated = 1;
      HGenType(type->base, buffer, &tail);
   }
   else {
      if (!OutFile->header->preheader) {
         Error(28L, (tmp[0].adr = "H2DGen.HMakeStructType.MakeField",
                tmp[1].val = 0, tmp[2].val = 33u-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
         return;
      }
      HGenType(type, buffer, &tail);
      outStr->leadtab = 0L;
   }
   if (H2DMsg_WasError) return;
   X2C_CALL(adt_FindLast_0,X2C_GET_TD(buffer),5)(buffer, &elm);
   if (X2C_GET_TD(elm)->base[1]==&H2DGen_PrintStringDesc_desc) {
      if (type->type==1003L) {
         LongStrs_Append(" ", 2ul, &((PrintString)elm)->str);
         anonym = type->name;
         LongStrs_Append(anonym->Adr, anonym->Len0,
                &((PrintString)elm)->str);
      }
      LongStrs_Append(tail->Adr, tail->Len0, &((PrintString)elm)->str);
      LongStrs_Append(";", 2ul, &((PrintString)elm)->str);
   }
   FlushBuffer(&buffer, &ident, type);
   LongStrs_Deallocate(&tail);
} /* end HGenSynonym() */


static void NewGeneratedType(GeneratedType * node, H2DObjs_Type type)
{
   adt_Element e = 0;
   X2C_BOOLEAN tmp;
   if (X2C_CALL(adt_IsEmpty_1,X2C_GET_TD(GeneratedTypeStorage),
                4)(GeneratedTypeStorage)) {
      X2C_NEW(&H2DGen_GeneratedTypeDesc_desc,(X2C_ADDRESS*)node,
                sizeof(struct H2DGen_GeneratedTypeDesc),0);
   }
   else {
      X2C_CALL(adt_FindFirst_0,X2C_GET_TD(GeneratedTypeStorage),
                6)(GeneratedTypeStorage, &e);
      X2C_CALL(adt_DeleteCurrent_,X2C_GET_TD(GeneratedTypeStorage),
                3)(GeneratedTypeStorage);
      *node = (GeneratedType)e;
      LongStrs_Assign("", 1ul, &(*node)->name);
   }
   (*node)->type = type;
   tmp = ValueHandlerOn;
   ValueHandlerOn = 0;
   H2DObjs_TranslateTypeToString(type, &(*node)->name);
   ValueHandlerOn = tmp;
} /* end NewGeneratedType() */


static X2C_BOOLEAN IsPointerToBaseType(H2DObjs_Type type)
{
   if (type==0) return 0;
   while (type->type==1003L || type->type==1000L) type = type->base;
   if (X2C_IN(type->type,32,0x1FFFUL)) return 1;
   else return 0;
   return 0;
} /* end IsPointerToBaseType() */


static X2C_BOOLEAN CompareType(H2DObjs_Type type1, H2DObjs_Type type2)
{
   GeneratedType node2 = 0;
   GeneratedType node1 = 0;
   NewGeneratedType(&node1, type1);
   NewGeneratedType(&node2, type2);
   return X2C_CALL(adt_Compare_0,X2C_GET_TD(node1),
                0)((adt_NamedElement)node1, (adt_Element)node2)==0L;
} /* end CompareType() */


static H2DObjs_Type FindCompatibleType(H2DObjs_Type pattern)
{
   adt_Element elm = 0;
   GeneratedType node = 0;
   H2DObjs_Type type = 0;
   X2C_SEQ tmp[3];
   if (pattern==0) {
      Error(28L, (tmp[0].adr = "H2DGen.FindCompatibleType", tmp[1].val = 0,
                tmp[2].val = 26u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      return 0;
   }
   if (pattern->translation_variant) return pattern;
   type = 0;
   NewGeneratedType(&node, pattern);
   X2C_CALL(adt_Find_,X2C_GET_TD(GeneratedTypes),12)(GeneratedTypes,
                (adt_Element)node, &elm);
   if (elm) type = ((GeneratedType)elm)->type;
   Deallocate((adt_Element)node);
   return type;
} /* end FindCompatibleType() */


static void ReplaceCompatibleType(H2DObjs_Type pattern)
{
   adt_Element elm = 0;
   GeneratedType findNode = 0;
   GeneratedType node = 0;
   if ((pattern==0 || !(pattern->header!=OutFile->header || pattern->generated)
                ) || pattern->created_by_back_end) return;
   NewGeneratedType(&node, pattern);
   X2C_CALL(adt_Find_,X2C_GET_TD(GeneratedTypes),12)(GeneratedTypes,
                (adt_Element)node, &elm);
   if (elm) {
      findNode = (GeneratedType)elm;
      if (((X2C_IN(findNode->type->type,32,
                0x1FFFUL) && findNode->type->type!=12L)
                && !IsPointerToBaseType(pattern))
                && (findNode->type->type!=1000L || findNode->type->base->type!=12L)
                ) findNode->type = pattern;
   }
   Deallocate((adt_Element)node);
} /* end ReplaceCompatibleType() */


static void ins(adt_NamedElement * ne, const X2C_CHAR w[], X2C_CARD32 w_len)
{
   X2C_NEW(&adt_NamedElementDesc_desc,(X2C_ADDRESS*)ne,
                sizeof(struct adt_NamedElementDesc),0);
   X2C_CALL(adt_SetName_,X2C_GET_TD(*ne),1)(*ne, w, w_len);
   X2C_CALL(adt_Insert_,X2C_GET_TD(Modula2KeyWords),11)(Modula2KeyWords,
                (adt_Element)*ne);
} /* end ins() */


static void SetModula2KeyWords(void)
{
   adt_NamedElement ne = 0;
   adt_NewTree(&Modula2KeyWords);
   ins(&ne, "AND", 4ul);
   ins(&ne, "MODULE", 7ul);
   ins(&ne, "ARRAY", 6ul);
   ins(&ne, "NOT", 4ul);
   ins(&ne, "BEGIN", 6ul);
   ins(&ne, "OF", 3ul);
   ins(&ne, "BY", 3ul);
   ins(&ne, "OR", 3ul);
   ins(&ne, "CASE", 5ul);
   ins(&ne, "PACKEDSET", 10ul);
   ins(&ne, "CONST", 6ul);
   ins(&ne, "PROCEDURE", 10ul);
   ins(&ne, "DEFINITION", 11ul);
   ins(&ne, "QUALIFIED", 10ul);
   ins(&ne, "DIV", 4ul);
   ins(&ne, "RECORD", 7ul);
   ins(&ne, "EXIT", 5ul);
   ins(&ne, "REM", 4ul);
   ins(&ne, "EXCEPT", 7ul);
   ins(&ne, "REPEAT", 7ul);
   ins(&ne, "EXPORT", 7ul);
   ins(&ne, "RETRY", 6ul);
   ins(&ne, "FINALLY", 8ul);
   ins(&ne, "RETURN", 7ul);
   ins(&ne, "FOR", 4ul);
   ins(&ne, "SET", 4ul);
   ins(&ne, "FORWARD", 8ul);
   ins(&ne, "THEN", 5ul);
   ins(&ne, "FROM", 5ul);
   ins(&ne, "TO", 3ul);
   ins(&ne, "IF", 3ul);
   ins(&ne, "TYPE", 5ul);
   ins(&ne, "IMPLEMENTATION", 15ul);
   ins(&ne, "UNTIL", 6ul);
   ins(&ne, "IMPORT", 7ul);
   ins(&ne, "VAR", 4ul);
   ins(&ne, "IN", 3ul);
   ins(&ne, "WHILE", 6ul);
   ins(&ne, "LOOP", 5ul);
   ins(&ne, "WITH", 5ul);
   ins(&ne, "MOD", 4ul);
   ins(&ne, "IS", 3ul);
   ins(&ne, "DO", 3ul);
   ins(&ne, "ABS", 4ul);
   ins(&ne, "ASH", 4ul);
   ins(&ne, "BITSET", 7ul);
   ins(&ne, "BOOLEAN", 8ul);
   ins(&ne, "CARDINAL", 9ul);
   ins(&ne, "CAP", 4ul);
   ins(&ne, "CHR", 4ul);
   ins(&ne, "CHAR", 5ul);
   ins(&ne, "COMPLEX", 8ul);
   ins(&ne, "CMPLX", 6ul);
   ins(&ne, "COPY", 5ul);
   ins(&ne, "DEC", 4ul);
   ins(&ne, "DISPOSE", 8ul);
   ins(&ne, "ENTIER", 7ul);
   ins(&ne, "ENTER", 6ul);
   ins(&ne, "EXKL", 5ul);
   ins(&ne, "FALSE", 6ul);
   ins(&ne, "FLOAT", 6ul);
   ins(&ne, "HALT", 5ul);
   ins(&ne, "HIGH", 5ul);
   ins(&ne, "IM", 3ul);
   ins(&ne, "INC", 4ul);
   ins(&ne, "INCL", 5ul);
   ins(&ne, "INT", 4ul);
   ins(&ne, "INTERRUPTIBLE", 14ul);
   ins(&ne, "INTEGER", 8ul);
   ins(&ne, "LEAV", 5ul);
   ins(&ne, "LEN", 4ul);
   ins(&ne, "LENGTH", 7ul);
   ins(&ne, "LFLOAT", 7ul);
   ins(&ne, "LONG", 5ul);
   ins(&ne, "LONGCOMPLEX", 12ul);
   ins(&ne, "LONGINT", 8ul);
   ins(&ne, "LONGREAL", 9ul);
   ins(&ne, "MAX", 4ul);
   ins(&ne, "MIN", 4ul);
   ins(&ne, "NEW", 4ul);
   ins(&ne, "NIL", 4ul);
   ins(&ne, "ODD", 4ul);
   ins(&ne, "ORD", 4ul);
   ins(&ne, "PROC", 5ul);
   ins(&ne, "PROTECTION", 11ul);
   ins(&ne, "RE", 3ul);
   ins(&ne, "REAL", 5ul);
   ins(&ne, "SIZE", 5ul);
   ins(&ne, "SHORT", 6ul);
   ins(&ne, "SHORTINT", 9ul);
   ins(&ne, "TRUE", 5ul);
   ins(&ne, "TRUNC", 6ul);
   ins(&ne, "UNINTERRUPTIBLE", 16ul);
   ins(&ne, "VAL", 4ul);
} /* end SetModula2KeyWords() */


static void SetNothingdDivideChars(void)
{
   LongStrs_Assign("", 1ul, &nothingDivideChars);
} /* end SetNothingdDivideChars() */


static void SetStdDivideChars(void)
{
   LongStrs_Assign(" ,;", 4ul, &stdDivideChars);
} /* end SetStdDivideChars() */


static void SetDivideCharsForProcedure(void)
{
   LongStrs_Assign(",;", 3ul, &divideCharsForProcedure);
} /* end SetDivideCharsForProcedure() */

static adt_List BaseTypesStorage;


extern void H2DGen_InitBaseType(X2C_INT32 cType,
                X2C_CHAR defaultModulaType[],
                X2C_CARD32 defaultModulaType_len, X2C_BOOLEAN default0)
{
   H2DObjs_Type type = 0;
   GeneratedType node = 0;
   H2DObjs_NewType(&type);
   type->type = cType;
   if (!default0) H2DCfg_GetBaseType(cType, &type->name);
   if (type->name==0) {
      LongStrs_Assign(defaultModulaType, defaultModulaType_len, &type->name);
   }
   type->header = 0;
   type->generated = 1;
   NewGeneratedType(&node, type);
   X2C_CALL(adt_Insert_,X2C_GET_TD(GeneratedTypes),11)(GeneratedTypes,
                (adt_Element)node);
   X2C_CALL(adt_Insert_0,X2C_GET_TD(BaseTypesStorage),14)(BaseTypesStorage,
                (adt_Element)type);
} /* end InitBaseType() */

static H2DObjs_Type GetType(H2DObjs_Type);


static void InitPreDefinedTypes(void)
{
   H2DObjs_Type baseType = 0;
   H2DObjs_Type ptrVoid = 0;
   GeneratedType node = 0;
   H2DObjs_NewType(&ptrVoid);
   X2C_CALL(adt_SetName_,X2C_GET_TD(ptrVoid),1)((adt_NamedElement)ptrVoid, "S\
YSTEM.ADDRESS", 15ul);
   ptrVoid->type = 1000L;
   ptrVoid->header = 0;
   ptrVoid->generated = 1;
   H2DObjs_NewType(&baseType);
   baseType->type = 12L;
   baseType->header = 0;
   baseType->generated = 0;
   ptrVoid->base = GetType(baseType);
   NewGeneratedType(&node, ptrVoid);
   X2C_CALL(adt_Insert_,X2C_GET_TD(GeneratedTypes),11)(GeneratedTypes,
                (adt_Element)node);
   X2C_CALL(adt_Insert_0,X2C_GET_TD(BaseTypesStorage),14)(BaseTypesStorage,
                (adt_Element)ptrVoid);
   X2C_CALL(adt_Insert_0,X2C_GET_TD(BaseTypesStorage),14)(BaseTypesStorage,
                (adt_Element)baseType);
} /* end InitPreDefinedTypes() */


static void RemoveBaseTypesStorage(void)
{
   adt_Element e = 0;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(BaseTypesStorage),6)(BaseTypesStorage,
                 &e);
   while (e) {
      H2DObjs_Deallocate((adt_Element)e);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(BaseTypesStorage),
                8)(BaseTypesStorage, &e);
   }
   X2C_CALL(adt_Clean_,X2C_GET_TD(BaseTypesStorage),15)(BaseTypesStorage);
} /* end RemoveBaseTypesStorage() */


static void SetBaseTypes(void)
{
   H2DGen_InitBaseType(0L, "SYSTEM.INT8", 12ul, 0);
   H2DGen_InitBaseType(1L, "SYSTEM.int", 11ul, 0);
   H2DGen_InitBaseType(2L, "SYSTEM.INT16", 13ul, 0);
   H2DGen_InitBaseType(3L, "SYSTEM.INT32", 13ul, 0);
   H2DGen_InitBaseType(4L, "SYSTEM.CARD8", 13ul, 0);
   H2DGen_InitBaseType(5L, "SYSTEM.unsigned", 16ul, 0);
   H2DGen_InitBaseType(6L, "SYSTEM.CARD16", 14ul, 0);
   H2DGen_InitBaseType(7L, "SYSTEM.CARD32", 14ul, 0);
   H2DGen_InitBaseType(8L, "REAL", 5ul, 0);
   H2DGen_InitBaseType(9L, "LONGREAL", 9ul, 0);
   H2DGen_InitBaseType(10L, "LONGFLOAT", 10ul, 0);
   H2DGen_InitBaseType(11L, "LONGDOUDLE", 11ul, 0);
   H2DGen_InitBaseType(12L, "SYSTEM.void", 12ul, 0);
   InitPreDefinedTypes();
} /* end SetBaseTypes() */


static X2C_BOOLEAN IsGoodChar(X2C_CHAR c)
{
   return ((c=='_' || (X2C_CARD8)c>='A' && (X2C_CARD8)c<='Z') || (X2C_CARD8)
                c>='a' && (X2C_CARD8)c<='z') || (X2C_CARD8)
                c>='0' && (X2C_CARD8)c<='9';
} /* end IsGoodChar() */


static X2C_BOOLEAN IsIdentifier(const X2C_CHAR name[], X2C_CARD32 name_len,
                X2C_INT32 type)
{
   X2C_INT32 size;
   X2C_INT32 i;
   X2C_BOOLEAN res;
   X2C_INT32 tmp;
   size = LongStrs_Length(name, name_len);
   if ((size<1L || !IsGoodChar(name[0UL])) || ((X2C_CARD8)
                name[0UL]<='9' && (X2C_CARD8)name[0UL]>='0')
                && !(type==7801L && LongStrs_Length1(H2DCfg_DefinitionFilePrefix)
                >0L || type!=7801L && LongStrs_Length1(H2DCfg_MacrosFilePrefix)
                >0L)) return 0;
   res = 1;
   tmp = size-1L;
   i = 1L;
   if (i<=tmp) for (;; i++) {
      res = res && IsGoodChar(name[i]);
      if (i==tmp) break;
   } /* end for */
   return res;
} /* end IsIdentifier() */


static void CheckModuleName(const X2C_CHAR name[], X2C_CARD32 name_len,
                X2C_INT32 * res, X2C_INT32 type)
{
   LongStrs_String fileName = 0;
   LongStrs_String ext = 0;
   LongStrs_String path = 0;
   *res = 7401L;
   H2DFile_SplitName(name, name_len, &path, &fileName, &ext);
   if (LongStrs_Length(path->Adr, path->Len0)>0L) *res = 7403L;
   if (LongStrs_Length(fileName->Adr, fileName->Len0)<=0L) *res = 7404L;
   else if (!IsIdentifier(fileName->Adr, fileName->Len0, type)) *res = 7402L;
   LongStrs_Deallocate(&path);
   LongStrs_Deallocate(&ext);
   LongStrs_Deallocate(&fileName);
} /* end CheckModuleName() */


static void Translate2LongName(LongStrs_String * str)
{
   X2C_BOOLEAN found;
   X2C_CARD32 pos;
   X2C_CHAR pathSep0[2];
   pathSep0[0UL] = pathSep;
   pathSep0[1UL] = 0x0U ;
   Strings_FindNext(pathSep0, 2ul, (*str)->Adr, (*str)->Len0, 0UL, &found,
                &pos);
   while (found) {
      (*str)->Adr[pos] = '_';
      Strings_FindNext(pathSep0, 2ul, (*str)->Adr, (*str)->Len0, pos, &found,
                 &pos);
   }
   LongStrs_Append("_", 2ul, str);
} /* end Translate2LongName() */


static void GetModuleName(const X2C_CHAR fileName[], X2C_CARD32 fileName_len,
                 LongStrs_String * modName, X2C_INT32 type)
{
   LongStrs_String ext = 0;
   LongStrs_String path = 0;
   X2C_INT32 res;
   adt_NamedElement nelm = 0;
   adt_Element elm = 0;
   LongStrs_String anonym = 0;
   X2C_SEQ tmp[3];
   adt_NewNamedElement(&nelm, fileName, fileName_len);
   X2C_CALL(adt_Find_,X2C_GET_TD(H2DObjs_ModuleNames),
                12)(H2DObjs_ModuleNames, (adt_Element)nelm, &elm);
   adt_Deallocate((adt_Element)nelm);
   if (elm) {
      anonym = ((H2DObjs_NameSynonym)elm)->newname;
      LongStrs_Assign(anonym->Adr, anonym->Len0, modName);
   }
   else {
      CheckModuleName(fileName, fileName_len, &res, type);
      switch (res) {
      case 7401L:
      case 7403L:
         H2DFile_SplitName(fileName, fileName_len, &path, modName, &ext);
         if ((H2DCfg_LongFileName && LongStrs_Length1(path)>0L)
                && !H2DFile_IsAbsolutePath(path->Adr, path->Len0)) {
            Translate2LongName(&path);
            LongStrs_Append((*modName)->Adr, (*modName)->Len0, &path);
            LongStrs_Assign(path->Adr, path->Len0, modName);
         }
         LongStrs_Deallocate(&ext);
         LongStrs_Deallocate(&path);
         break;
      case 7402L:
         Error(48L, (tmp[0].adr = fileName, tmp[1].val = 0,
                tmp[2].val = fileName_len-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
         return;
      case 7404L:
         Error(28L, (tmp[0].adr = "H2DGen.GetModuleName", tmp[1].val = 0,
                tmp[2].val = 21u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
         return;
      default:
         X2C_TRAP(X2C_CASE_TRAP);
      } /* end switch */
   }
   if (type==7801L) {
      LongStrs_Insert(H2DCfg_DefinitionFilePrefix->Adr,
                H2DCfg_DefinitionFilePrefix->Len0, 0L, modName);
   }
   else {
      LongStrs_Insert(H2DCfg_MacrosFilePrefix->Adr,
                H2DCfg_MacrosFilePrefix->Len0, 0L, modName);
   }
} /* end GetModuleName() */


static void OpenFile(void)
{
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   X2C_SEQ tmp[3];
   if (anonym = OutFile->name,H2DFile_Open(anonym->Adr, anonym->Len0, 2L,
                &OutFile->hand, 0x8U)) {
      OutFile->created = 1;
      anonym0 = OutFile->name;
      LongStrs_Assign(anonym0->Adr, anonym0->Len0, &H2DMsg_File);
      OutFile->line = 0L;
      OutFile->pos = 0L;
   }
   else {
      anonym1 = OutFile->name;
      Error(6L, (tmp[0].adr = anonym1->Adr, tmp[1].val = 0,
                tmp[2].val = anonym1->Len0*1u-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
      return;
   }
} /* end OpenFile() */

static void WriteStr2File(const X2C_CHAR [], X2C_CARD32, LongStrs_String *,
                X2C_INT32, X2C_INT32);


static void WriteStr2File(const X2C_CHAR str[], X2C_CARD32 str_len,
                LongStrs_String * pstr, X2C_INT32 leadtab, X2C_INT32 tab)
{
   X2C_INT32 numberLine;
   LongStrs_String anonym = 0;
   numberLine = H2DFile_FWriteStr(OutFile->hand, str, str_len, leadtab, tab);
   if (numberLine==1L) OutFile->pos = LongStrs_Length(str, str_len)+leadtab;
   else OutFile->pos = 0L;
   OutFile->line = OutFile->line+numberLine;
   anonym = OutFile->name;
   H2DMsg_Progress0(anonym->Adr, anonym->Len0, OutFile->line);
   comment_was_just_generated = 0;
   comment_was_just_generated_in_ = 0;
   last_string_length = LongStrs_Length(str, str_len)+leadtab;
   LongStrs_Deallocate(pstr);
} /* end WriteStr2File() */

static void WriteStrLn2File(const X2C_CHAR [], X2C_CARD32, LongStrs_String *,
                 X2C_INT32, X2C_INT32);


static void WriteStrLn2File(const X2C_CHAR str[], X2C_CARD32 str_len,
                LongStrs_String * pstr, X2C_INT32 leadtab, X2C_INT32 tab)
{
   X2C_INT32 numberLine;
   LongStrs_String anonym = 0;
   if (LongStrs_Length(str, str_len)==0L) {
      if (OutFile->emptyLine || !InsertEmptyLine) {
         LongStrs_Deallocate(pstr);
         return;
      }
      OutFile->emptyLine = 1;
   }
   else OutFile->emptyLine = 0;
   numberLine = H2DFile_FWriteStrLn(OutFile->hand, str, str_len, leadtab,
                tab);
   OutFile->line = OutFile->line+numberLine;
   OutFile->pos = 0L;
   anonym = OutFile->name;
   H2DMsg_Progress0(anonym->Adr, anonym->Len0, OutFile->line);
   comment_was_just_generated = 0;
   comment_was_just_generated_in_ = 0;
   last_string_length = LongStrs_Length(str, str_len)+leadtab;
   LongStrs_Deallocate(pstr);
} /* end WriteStrLn2File() */

static void WriteStr2Null(const X2C_CHAR [], X2C_CARD32, LongStrs_String *,
                X2C_INT32, X2C_INT32);


static void WriteStr2Null(const X2C_CHAR str[], X2C_CARD32 str_len,
                LongStrs_String * pstr, X2C_INT32 leadtab, X2C_INT32 tab)
{
   return;
} /* end WriteStr2Null() */

static void WriteStrLn2Buffer(const X2C_CHAR [], X2C_CARD32,
                LongStrs_String *, X2C_INT32, X2C_INT32);


static void WriteStrLn2Buffer(const X2C_CHAR str[], X2C_CARD32 str_len,
                LongStrs_String * pstr, X2C_INT32 leadtab, X2C_INT32 tab)
{
   PrintString prStr = 0;
   if (*pstr==0) LongStrs_Assign(str, str_len, pstr);
   if (LongStrs_Length(str, str_len)==0L) {
      if (OutFile->emptyLine || !InsertEmptyLine) {
         LongStrs_Deallocate(pstr);
         return;
      }
      OutFile->emptyLine = 1;
   }
   else OutFile->emptyLine = 0;
   NewPrintString(&prStr, leadtab, tab, 1);
   prStr->str = *pstr;
   X2C_CALL(adt_Insert_0,X2C_GET_TD(WriteBuffer),14)(WriteBuffer,
                (adt_Element)prStr);
   last_string_length = LongStrs_Length(str, str_len)+leadtab;
   *pstr = 0;
} /* end WriteStrLn2Buffer() */

static void WriteStr2Buffer(const X2C_CHAR [], X2C_CARD32, LongStrs_String *,
                 X2C_INT32, X2C_INT32);


static void WriteStr2Buffer(const X2C_CHAR str[], X2C_CARD32 str_len,
                LongStrs_String * pstr, X2C_INT32 leadtab, X2C_INT32 tab)
{
   PrintString prStr = 0;
   if (*pstr==0) LongStrs_Assign(str, str_len, pstr);
   NewPrintString(&prStr, leadtab, tab, 0);
   prStr->str = *pstr;
   X2C_CALL(adt_Insert_0,X2C_GET_TD(WriteBuffer),14)(WriteBuffer,
                (adt_Element)prStr);
   last_string_length = LongStrs_Length(str, str_len)+leadtab;
   *pstr = 0;
} /* end WriteStr2Buffer() */


static void WriteEmptyLine(void)
{
   WriteStrLn("", 1ul, &null, 0L, 0L);
} /* end WriteEmptyLine() */


static void CloseFile(void)
{
   if (OutFile==0) return;
   if (OutFile->created) {
      H2DFile_Close(OutFile->hand);
      OutFile->created = 0;
   }
} /* end CloseFile() */


static void FlushWriteBuffer(void)
{
   adt_Element e = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(WriteBuffer),6)(WriteBuffer, &e);
   while (e) {
      if (X2C_GET_TD(e)->base[1]==&H2DGen_PrintStringDesc_desc) {
         if (((PrintString)e)->ln) {
            anonym = ((PrintString)e)->str;
            WriteStrLn(anonym->Adr, anonym->Len0, &((PrintString)e)->str,
                ((PrintString)e)->leadtab, ((PrintString)e)->tab);
         }
         else {
            anonym0 = ((PrintString)e)->str;
            WriteStr(anonym0->Adr, anonym0->Len0, &((PrintString)e)->str,
                ((PrintString)e)->leadtab, ((PrintString)e)->tab);
         }
         Deallocate((adt_Element)e);
      }
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(WriteBuffer),8)(WriteBuffer, &e);
   }
   X2C_CALL(adt_Clean_,X2C_GET_TD(WriteBuffer),15)(WriteBuffer);
} /* end FlushWriteBuffer() */


static void EmitSection(X2C_INT32 backEnd)
{
   if (BackEndSection==backEnd) return;
   if (H2DCfg_BackEnd==7100L && backEnd==7100L) {
      WriteStrLn = (void ( *)(X2C_CHAR [], X2C_CARD32, LongStrs_String *,
                X2C_INT32, X2C_INT32))WriteStrLn2File;
      WriteStr = (void ( *)(X2C_CHAR [], X2C_CARD32, LongStrs_String *,
                X2C_INT32, X2C_INT32))WriteStr2File;
      if (BackEndSection==7102L && !X2C_CALL(adt_IsEmpty_1,
                X2C_GET_TD(WriteBuffer),
                4)(WriteBuffer) || (BackEndSection==7101L && !X2C_CALL(adt_IsEmpty_1,
                X2C_GET_TD(WriteBuffer),
                4)(WriteBuffer)) && C_CodeSectionOpen) {
         WriteEmptyLine();
         WriteStrLn("<* ELSE *>", 11ul, &null, 0L, 0L);
         WriteEmptyLine();
         FlushWriteBuffer();
         WriteEmptyLine();
         OSectionNative = 7501L;
         OSectionC_Code = 7501L;
         OSectionCommon = 7501L;
      }
      else if (BackEndSection==7101L && !X2C_CALL(adt_IsEmpty_1,
                X2C_GET_TD(WriteBuffer),4)(WriteBuffer)) {
         WriteEmptyLine();
         WriteStrLn("<* IF NOT __GEN_C__ THEN *>", 28ul, &null, 0L, 0L);
         WriteEmptyLine();
         FlushWriteBuffer();
         WriteEmptyLine();
         OSectionNative = 7501L;
         OSectionC_Code = 7501L;
         OSectionCommon = 7501L;
      }
      WriteStrLn2File("<* END *>", 10ul, &null, 0L, 0L);
      C_CodeSectionOpen = 0;
      WriteEmptyLine();
   }
   else if (H2DCfg_BackEnd==7100L && backEnd==7102L) {
      WriteStrLn = (void ( *)(X2C_CHAR [], X2C_CARD32, LongStrs_String *,
                X2C_INT32, X2C_INT32))WriteStrLn2File;
      WriteStr = (void ( *)(X2C_CHAR [], X2C_CARD32, LongStrs_String *,
                X2C_INT32, X2C_INT32))WriteStr2File;
      if (BackEndSection==7100L || BackEndSection==7101L && !C_CodeSectionOpen)
                 {
         WriteEmptyLine();
         WriteStrLn("<* IF  __GEN_C__ THEN *>", 25ul, &null, 0L, 0L);
         WriteEmptyLine();
      }
      C_CodeSectionOpen = 1;
   }
   else if (H2DCfg_BackEnd==7100L && backEnd==7101L) {
      WriteStrLn = (void ( *)(X2C_CHAR [], X2C_CARD32, LongStrs_String *,
                X2C_INT32, X2C_INT32))WriteStrLn2Buffer;
      WriteStr = (void ( *)(X2C_CHAR [], X2C_CARD32, LongStrs_String *,
                X2C_INT32, X2C_INT32))WriteStr2Buffer;
   }
   else if (H2DCfg_BackEnd==7102L && backEnd==7101L) {
      WriteStrLn = (void ( *)(X2C_CHAR [], X2C_CARD32, LongStrs_String *,
                X2C_INT32, X2C_INT32))WriteStr2Null;
      WriteStr = (void ( *)(X2C_CHAR [], X2C_CARD32, LongStrs_String *,
                X2C_INT32, X2C_INT32))WriteStr2Null;
   }
   else if (H2DCfg_BackEnd==7101L && backEnd==7102L) {
      WriteStrLn = (void ( *)(X2C_CHAR [], X2C_CARD32, LongStrs_String *,
                X2C_INT32, X2C_INT32))WriteStr2Null;
      WriteStr = (void ( *)(X2C_CHAR [], X2C_CARD32, LongStrs_String *,
                X2C_INT32, X2C_INT32))WriteStr2Null;
   }
   else {
      WriteStrLn = (void ( *)(X2C_CHAR [], X2C_CARD32, LongStrs_String *,
                X2C_INT32, X2C_INT32))WriteStrLn2File;
      WriteStr = (void ( *)(X2C_CHAR [], X2C_CARD32, LongStrs_String *,
                X2C_INT32, X2C_INT32))WriteStr2File;
   }
   BackEndSection = backEnd;
} /* end EmitSection() */


static void GenHeadingObject(X2C_INT32 osection, X2C_INT32 genTypeDef,
                X2C_INT32 backEnd)
{
   if (backEnd==7002L) backEnd = BackEndSection;
   EmitSection(backEnd);
   switch (backEnd) {
   case 7101L:
      if (osection==OSectionNative) return;
      OSectionNative = osection;
      break;
   case 7102L:
      if (osection==OSectionC_Code) return;
      OSectionC_Code = osection;
      break;
   case 7100L:
      if (osection==OSectionCommon) return;
      OSectionCommon = osection;
      break;
   default:
      X2C_TRAP(X2C_CASE_TRAP);
   } /* end switch */
   WriteEmptyLine();
   switch (osection) {
   case 7302L:
      WriteStrLn("CONST ", 7ul, &null, 0L, 0L);
      OutFile->emptyLine = 1;
      break;
   case 7303L:
      WriteStrLn("TYPE ", 6ul, &null, 0L, 0L);
      OutFile->emptyLine = 1;
      break;
   case 7304L:
      WriteStrLn("VAR ", 5ul, &null, 0L, 0L);
      OutFile->emptyLine = 1;
      break;
   } /* end switch */
   ObjectSection = osection;
} /* end GenHeadingObject() */


static void MakeQualident(H2DObjs_Object type, LongStrs_String * outStr)
{
   LongStrs_String qualident = 0;
   X2C_INT32 res;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   LongStrs_String anonym2 = 0;
   LongStrs_String anonym3 = 0;
   LongStrs_String anonym4 = 0;
   LongStrs_String anonym5 = 0;
   X2C_SEQ tmp[3];
   if (type==0 || LongStrs_Length1(type->name)<=0L) {
      Error(28L, (tmp[0].adr = "H2DGen.Make.Qualident", tmp[1].val = 0,
                tmp[2].val = 22u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      return;
   }
   if (X2C_GET_TD(type)->base[3]==&H2DObjs_TypeDesc_desc && ((H2DObjs_Type)
                type)->translation_variant) {
      ((H2DObjs_Type)type)->translation_variant->generated = 1;
      anonym = ((H2DObjs_Type)type)->translation_variant->name;
      LongStrs_Append(anonym->Adr, anonym->Len0, outStr);
   }
   else if (X2C_GET_TD(type)->base[3]==&H2DObjs_TypedObjectDesc_desc && ((H2DObjs_TypedObject)
                type)->type_name) {
      ((H2DObjs_TypedObject)type)->type_name->generated = 1;
      anonym0 = ((H2DObjs_TypedObject)type)->type_name->name;
      LongStrs_Append(anonym0->Adr, anonym0->Len0, outStr);
   }
   else {
      if ((((type->header && type->header!=OutFile->header)
                && (X2C_GET_TD(type)
                ->base[3]!=&H2DObjs_TypeDesc_desc || ((H2DObjs_Type)type)
                ->tag_description_header!=OutFile->header))
                && type->header->name) && (anonym1 = type->name,
                LongStrs_FindPos(anonym1->Adr, anonym1->Len0, '.'))==-1L) {
         anonym2 = type->header->name;
         CheckModuleName(anonym2->Adr, anonym2->Len0, &res, OutFile->type);
         switch (res) {
         case 7401L:
         case 7403L:
            anonym3 = type->header->name;
            GetModuleName(anonym3->Adr, anonym3->Len0, &qualident, 7801L);
            if (H2DMsg_WasError) return;
            LongStrs_Append(qualident->Adr, qualident->Len0, outStr);
            LongStrs_Deallocate(&qualident);
            LongStrs_AppendChar('.', outStr);
            break;
         default:;
            anonym4 = type->header->name;
            Error(48L, (tmp[0].adr = anonym4->Adr, tmp[1].val = 0,
                tmp[2].val = anonym4->Len0*1u-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
            return;
         } /* end switch */
      }
      anonym5 = type->name;
      LongStrs_Append(anonym5->Adr, anonym5->Len0, outStr);
   }
} /* end MakeQualident() */


static void MakeOnlyLanguageModifier(adt_List modifier, X2C_INT32 mode,
                LongStrs_String * outStr)
{
   adt_Element elm = 0;
   X2C_INT32 id;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(modifier),6)(modifier, &elm);
   while (elm) {
      X2C_CALL(adt_Backup_0,X2C_GET_TD(modifier),2)(modifier, &id);
      switch (((H2DObjs_Modifier)elm)->modifier) {
      case 5034L:
         if (mode==7301L) {
            LongStrs_Append(" ", 2ul, outStr);
            LongStrs_Append("[\"StdCall\"]", 12ul, outStr);
         }
         else if (mode==7304L) {
            LongStrs_Append(" [] ", 5ul, outStr);
            LongStrs_Append("[\"Pascal\"]", 11ul, outStr);
         }
         else {
            LongStrs_Append(" ", 2ul, outStr);
            LongStrs_Append("[\"Pascal\"]", 11ul, outStr);
         }
         break;
      case 5037L:
         LongStrs_Append(" ", 2ul, outStr);
         LongStrs_Append("[\"SysCall\"]", 12ul, outStr);
         break;
      case 5036L:
      case 5035L:
         break;
      } /* end switch */
      X2C_CALL(adt_Restore_0,X2C_GET_TD(modifier),1)(modifier, id);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(modifier),8)(modifier, &elm);
   }
} /* end MakeOnlyLanguageModifier() */


static void MakeOtherModifier(adt_List modifier, LongStrs_String * outStr)
{
   adt_Element elm = 0;
   X2C_INT32 id;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(modifier),6)(modifier, &elm);
   while (elm) {
      X2C_CALL(adt_Backup_0,X2C_GET_TD(modifier),2)(modifier, &id);
      switch (((H2DObjs_Modifier)elm)->modifier) {
      case 5009L:
         LongStrs_Append(" -", 3ul, outStr);
         break;
      } /* end switch */
      X2C_CALL(adt_Restore_0,X2C_GET_TD(modifier),1)(modifier, id);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(modifier),8)(modifier, &elm);
   }
} /* end MakeOtherModifier() */


static void MakeModifier(adt_List modifier, X2C_INT32 mode,
                LongStrs_String * outStr)
{
   MakeOnlyLanguageModifier(modifier, mode, outStr);
   MakeOtherModifier(modifier, outStr);
} /* end MakeModifier() */


static void NumberArrayElement(H2DObjs_Expression expr,
                LongStrs_String * outStr)
{
   H2DObjs_ConstantValue result = 0;
   LongStrs_String s = 0;
   H2DObjs_BinaryOperation dimension = 0;
   H2DObjs_Value value = 0;
   X2C_SEQ tmp[3];
   if (expr==0) return;
   H2DObjs_NewValue(&value);
   value->type = 6072L;
   value->hex = 0;
   value->pos = expr->pos;
   value->line = expr->line;
   Assign("1", 2ul, &value->value);
   H2DObjs_NewBinaryOperation(&dimension);
   dimension->operation = 6003L;
   dimension->operation = 6003L;
   dimension->pos = expr->pos;
   dimension->line = expr->line;
   dimension->first = expr;
   dimension->second = (H2DObjs_Expression)value;
   X2C_CALL(H2DObjs_ComputeExpression_1,X2C_GET_TD(dimension),2)(dimension,
                &result, 0);
   if (result->type==6072L) {
      result->int0 = result->int0;
      s = X2C_CALL(H2DObjs_GetText_,X2C_GET_TD(result),1)(result, 1);
      LongStrs_Append(s->Adr, s->Len0, outStr);
   }
   else {
      LongStrs_Append(" illegal size of array", 23ul, outStr);
      Error(28L, (tmp[0].adr = "H2DGen.NumberArrayElement", tmp[1].val = 0,
                tmp[2].val = 26u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
   }
   H2DObjs_Deallocate((adt_Element)result);
   H2DObjs_Deallocate((adt_Element)dimension);
   H2DObjs_Deallocate((adt_Element)value);
} /* end NumberArrayElement() */


static X2C_INT32 IsTypeInCBackEnd(H2DObjs_Type type)
{
   H2DObjs_Type tmpType = 0;
   if (type==0) return 7002L;
   tmpType = type;
   while (tmpType) {
      if (tmpType->back_end==7102L) return 7102L;
      tmpType = tmpType->base;
   }
   return 7100L;
} /* end IsTypeInCBackEnd() */


static X2C_INT32 IsAnyTypeInCBackEnd(adt_List list)
{
   adt_Element elm = 0;
   X2C_INT32 id;
   if (list==0) return 7002L;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(list),6)(list, &elm);
   while (elm) {
      X2C_CALL(adt_Backup_0,X2C_GET_TD(list),2)(list, &id);
      if (X2C_GET_TD(elm)->base[3]==&H2DObjs_TypedObjectDesc_desc) {
         if (IsTypeInCBackEnd(((H2DObjs_TypedObject)elm)->type)==7102L) {
            X2C_CALL(adt_Restore_0,X2C_GET_TD(list),1)(list, id);
            return 7102L;
         }
      }
      else if (X2C_GET_TD(elm)->base[3]==&H2DObjs_TypeDesc_desc) {
         if (IsTypeInCBackEnd((H2DObjs_Type)elm)==7102L) {
            X2C_CALL(adt_Restore_0,X2C_GET_TD(list),1)(list, id);
            return 7102L;
         }
      }
      X2C_CALL(adt_Restore_0,X2C_GET_TD(list),1)(list, id);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(list),8)(list, &elm);
   }
   return 7100L;
} /* end IsAnyTypeInCBackEnd() */


static X2C_BOOLEAN IsFunction(H2DObjs_Type * type, adt_List * modifier)
{
   H2DObjs_Type func = 0;
   adt_List tmpModifier = 0;
   if (*type==0) return 0;
   func = *type;
   adt_NewList(&tmpModifier);
   while (func->type==1003L) {
      BlendLists(func->modifier, &tmpModifier);
      func = func->base;
   }
   if (func->type==1004L) {
      BlendLists(tmpModifier, modifier);
      *type = func;
   }
   adt_Deallocate((adt_Element)tmpModifier);
   return (*type)->type==1004L;
} /* end IsFunction() */


static void AddSynonymsModifier(H2DObjs_TypedObject tobj, adt_List modifier)
{
   adt_Element elm = 0;
   adt_List buffer = 0;
   X2C_INT32 id;
   adt_NewList(&buffer);
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(modifier),6)(modifier, &elm);
   while (elm) {
      X2C_CALL(adt_Backup_0,X2C_GET_TD(modifier),2)(modifier, &id);
      switch (((H2DObjs_Modifier)elm)->modifier) {
      case 5032L:
      case 5009L:
      case 5034L:
      case 5035L:
      case 5036L:
         X2C_CALL(adt_Insert_0,X2C_GET_TD(buffer),14)(buffer, elm);
         break;
      } /* end switch */
      X2C_CALL(adt_Restore_0,X2C_GET_TD(modifier),1)(modifier, id);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(modifier),8)(modifier, &elm);
   }
   BlendLists(buffer, &tobj->modifier);
} /* end AddSynonymsModifier() */


static void ExtractSynonymModifier(H2DObjs_TypedObject tobj)
{
   H2DObjs_Type type = 0;
   type = tobj->type;
   while (type->type==1003L) {
      AddSynonymsModifier(tobj, type->modifier);
      type = type->base;
   }
} /* end ExtractSynonymModifier() */

#define H2DGen_yes0 0

#define H2DGen_no0 1

#define H2DGen_continue 2


static void ExistSuchName(LongStrs_String * modName, adt_Element * found,
                adt_NamedElement * ne, X2C_INT32 * existSuchName)
{
   adt_Tree anonym = 0;
   LongStrs_String anonym0 = 0;
   *existSuchName = 0L;
   H2DObjs_FindInTags(OutFile->header, *ne, found);
   if (*found==0) {
      H2DObjs_FindInNames(OutFile->header, *ne, found);
      if (*found==0) {
         anonym = OutFile->header->Macros;
         X2C_CALL(adt_Find_,X2C_GET_TD(anonym),12)(anonym, (adt_Element)*ne,
                found);
         if (*found==0) {
            X2C_CALL(adt_Find_,X2C_GET_TD(OutFile->creatednames),
                12)(OutFile->creatednames, (adt_Element)*ne, found);
            if (*found==0 && (anonym0 = (*ne)->name,X2C_STRCMP(anonym0->Adr,
                anonym0->Len0,(*modName)->Adr,(*modName)->Len0))) {
               *existSuchName = 1L;
            }
            else *existSuchName = 2L;
         }
         else if (((H2DObjs_Object)*found)->header==OutFile->header) {
            *existSuchName = 2L;
         }
      }
      else if (((H2DObjs_Object)*found)->header==OutFile->header) {
         *existSuchName = 2L;
      }
   }
   else if (((H2DObjs_Object)*found)->header==OutFile->header) {
      *existSuchName = 2L;
   }
} /* end ExistSuchName() */


static X2C_BOOLEAN RepairName(adt_NamedElement pattern)
{
   adt_Element found = 0;
   LongStrs_String modName = 0;
   X2C_INT32 existSuchName;
   X2C_INT32 counter;
   adt_NamedElement ne = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   LongStrs_String anonym2 = 0;
   X2C_SEQ tmp[3];
   if (pattern==0 || pattern->name==0) {
      Error(28L, (tmp[0].adr = "H2DGen.RepairName", tmp[1].val = 0,
                tmp[2].val = 18u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      return 0;
   }
   counter = 0L;
   anonym = pattern->name;
   adt_NewNamedElement(&ne, anonym->Adr, anonym->Len0);
   anonym0 = ModuleSystem->name;
   GetModuleName(anonym0->Adr, anonym0->Len0, &modName, 7801L);
   ExistSuchName(&modName, &found, &ne, &existSuchName);
   while (existSuchName==2L || existSuchName==0L) {
      anonym1 = pattern->name;
      X2C_CALL(adt_SetName_,X2C_GET_TD(ne),1)(ne, anonym1->Adr,
                anonym1->Len0);
      IntToStr(counter, &ne->name);
      ++counter;
      ExistSuchName(&modName, &found, &ne, &existSuchName);
   }
   anonym2 = ne->name;
   X2C_CALL(adt_SetName_,X2C_GET_TD(pattern),1)(pattern, anonym2->Adr,
                anonym2->Len0);
   adt_Deallocate((adt_Element)ne);
   LongStrs_Deallocate(&modName);
   return existSuchName==1L;
} /* end RepairName() */

static void CreateSmartTypeName(H2DObjs_Type, LongStrs_String *);


static void GetName(const X2C_CHAR from[], X2C_CARD32 from_len,
                LongStrs_String * to)
{
   LongStrs_String tmpStr = 0;
   X2C_INT32 point_pos;
   point_pos = LongStrs_BackFindPos(from, from_len, '.');
   if (point_pos!=-1L) {
      LongStrs_Extract(from, from_len, point_pos+1L, (LongStrs_Length(from,
                from_len)-point_pos)-1L, to);
   }
   else LongStrs_Append(from, from_len, to);
   LongStrs_AppendChar((*to)->Adr[0UL], &tmpStr);
   LongStrs_Capitalize(tmpStr->Adr, tmpStr->Len0);
   (*to)->Adr[0UL] = tmpStr->Adr[0UL];
   LongStrs_Deallocate(&tmpStr);
} /* end GetName() */


static void CreateSmartTypeName(H2DObjs_Type type, LongStrs_String * name)
{
   LongStrs_String str = 0;
   H2DObjs_ConstantValue result = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   X2C_SEQ tmp[3];
   if (LongStrs_Length1(type->name)>0L && !X2C_IN(type->type,32,0x1FFFUL)) {
      anonym = type->name;
      GetName(anonym->Adr, anonym->Len0, name);
      return;
   }
   switch (type->type) {
   case 0L:
      LongStrs_Append("SChar", 6ul, name);
      break;
   case 1L:
      LongStrs_Append("SInt", 5ul, name);
      break;
   case 2L:
      LongStrs_Append("SShInt", 7ul, name);
      break;
   case 3L:
      LongStrs_Append("SLInt", 6ul, name);
      break;
   case 4L:
      LongStrs_Append("UChar", 6ul, name);
      break;
   case 5L:
      LongStrs_Append("UInt", 5ul, name);
      break;
   case 6L:
      LongStrs_Append("UShInt", 7ul, name);
      break;
   case 7L:
      LongStrs_Append("ULInt", 6ul, name);
      break;
   case 8L:
      LongStrs_Append("Float", 6ul, name);
      break;
   case 9L:
      LongStrs_Append("Double", 7ul, name);
      break;
   case 10L:
      LongStrs_Append("LFloat", 7ul, name);
      break;
   case 11L:
      LongStrs_Append("LDouble", 8ul, name);
      break;
   case 12L:
      LongStrs_Append("Void", 5ul, name);
      break;
   case 1000L:
      LongStrs_Append("Ptr", 4ul, name);
      CreateSmartTypeName(type->base, name);
      break;
   case 1001L:
      if (LongStrs_Length1(type->name)) {
         anonym0 = type->name;
         LongStrs_Append(anonym0->Adr, anonym0->Len0, name);
      }
      else LongStrs_Append("Struct", 7ul, name);
      break;
   case 1002L:
      if (type->expr==0) LongStrs_Append("OpenArray", 10ul, name);
      else {
         X2C_CALL(H2DObjs_ComputeExpression_,X2C_GET_TD(type->expr),
                2)(type->expr, &result, 0);
         str = X2C_CALL(H2DObjs_GetText_,X2C_GET_TD(result),1)(result, 0);
         LongStrs_Append("Array", 6ul, name);
         LongStrs_Append(str->Adr, str->Len0, name);
         LongStrs_Deallocate(&str);
         H2DObjs_Deallocate((adt_Element)result);
      }
      CreateSmartTypeName(type->base, name);
      break;
   case 1005L:
      LongStrs_Append("Union", 6ul, name);
      break;
   case 1006L:
      LongStrs_Append("Enum", 5ul, name);
      break;
   case 1004L:
      LongStrs_Append("Proc", 5ul, name);
      break;
   case 1003L:
      anonym1 = type->name;
      LongStrs_Append(anonym1->Adr, anonym1->Len0, name);
      break;
   default:;
      Error(28L, (tmp[0].adr = "H2DGen.CreateSmartTypeName", tmp[1].val = 0,
                tmp[2].val = 27u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      break;
   } /* end switch */
} /* end CreateSmartTypeName() */


static H2DObjs_Type CreateTypeName(H2DObjs_Type type, adt_List modifier)
{
   adt_NamedElement nelm = 0;
   LongStrs_String name = 0;
   H2DObjs_Type synonym = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   X2C_SEQ tmp[3];
   LongStrs_Assign("H2D_", 5ul, &name);
   CreateSmartTypeName(type, &name);
   H2DObjs_NewType(&synonym);
   synonym->header = OutFile->header;
   synonym->type = 1003L;
   synonym->gen_type_def = 7000L;
   synonym->base = type;
   BlendLists(modifier, &synonym->modifier);
   X2C_CALL(adt_SetName_,X2C_GET_TD(synonym),1)((adt_NamedElement)synonym,
                name->Adr, name->Len0);
   LongStrs_Deallocate(&name);
   if (!RepairName((adt_NamedElement)synonym)) {
      anonym = synonym->name;
      Error(48L, (tmp[0].adr = anonym->Adr, tmp[1].val = 0,
                tmp[2].val = anonym->Len0*1u-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
      return synonym;
   }
   anonym0 = synonym->name;
   adt_NewNamedElement(&nelm, anonym0->Adr, anonym0->Len0);
   X2C_CALL(adt_Insert_,X2C_GET_TD(OutFile->creatednames),
                11)(OutFile->creatednames, (adt_Element)nelm);
   if ((H2DCfg_BackEnd==7102L || H2DCfg_BackEnd==7100L)
                && !OutFile->header->preheader) {
      synonym->created_by_back_end = 1;
   }
   return synonym;
} /* end CreateTypeName() */


static void ResolveCollisionOfName(H2DObjs_Type type)
{
   LongStrs_String name = 0;
   adt_NamedElement nelm = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   LongStrs_String anonym2 = 0;
   LongStrs_String anonym3 = 0;
   X2C_SEQ tmp[3];
   if (LongStrs_Length1(type->header->name)
                >0L && !(anonym = type->header->name,
                (anonym0 = OutFile->header->name,Strings_Equal(anonym->Adr,
                anonym->Len0, anonym0->Adr, anonym0->Len0)))) return;
   anonym1 = type->name;
   LongStrs_Assign(anonym1->Adr, anonym1->Len0, &name);
   switch (type->type) {
   case 1001L:
      LongStrs_Append("_struct", 8ul, &name);
      break;
   case 1005L:
      LongStrs_Append("_union", 7ul, &name);
      break;
   case 1006L:
      LongStrs_Append("_enum", 6ul, &name);
      break;
   default:;
      Error(28L, (tmp[0].adr = "H2DGen.ResolveCollisionOfName",
                tmp[1].val = 0, tmp[2].val = 30u-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
      return;
   } /* end switch */
   adt_NewNamedElement(&nelm, name->Adr, name->Len0);
   if (!RepairName(nelm)) {
      anonym2 = type->name;
      Error(48L, (tmp[0].adr = anonym2->Adr, tmp[1].val = 0,
                tmp[2].val = anonym2->Len0*1u-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
      return;
   }
   anonym3 = type->name;
   HGenDefine(name->Adr, name->Len0, anonym3->Adr, anonym3->Len0);
   X2C_CALL(adt_Insert_,X2C_GET_TD(OutFile->creatednames),
                11)(OutFile->creatednames, (adt_Element)nelm);
   X2C_CALL(adt_SetName_,X2C_GET_TD(type),1)((adt_NamedElement)type,
                name->Adr, name->Len0);
   LongStrs_Deallocate(&name);
} /* end ResolveCollisionOfName() */


static X2C_INT32 UniqueTagName(H2DObjs_Type pattern)
{
   adt_Element found = 0;
   adt_Tree anonym = 0;
   anonym = OutFile->header->Macros;
   X2C_CALL(adt_Find_,X2C_GET_TD(anonym),12)(anonym, (adt_Element)pattern,
                &found);
   if (found) return 7601L;
   else {
      H2DObjs_FindInNames(OutFile->header, (adt_NamedElement)pattern,
                &found);
      if (found) {
         if (X2C_GET_TD(found)->base[3]==&H2DObjs_TypeDesc_desc) {
            if (((H2DObjs_Type)found)->type==1003L && CompareType(pattern,
                (H2DObjs_Type)found)) return 7603L;
         }
         return 7601L;
      }
      else return 7602L;
   }
   return 0;
} /* end UniqueTagName() */


static void SetCommentTab(LongStrs_String str, X2C_INT32 leadtab,
                X2C_INT32 tab)
{
   X2C_INT32 size;
   size = LongStrs_Length1(str);
   if (size<H2DFile_SizeOutputLine-(3L+leadtab)) OutFile->tab = size+3L;
   else OutFile->tab = tab+3L;
} /* end SetCommentTab() */


static void AddCommentMark(LongStrs_String * str)
{
   X2C_INT32 size;
   X2C_BOOLEAN found;
   X2C_CARD32 pos;
   size = LongStrs_Length1(*str);
   if (size>0L) {
      Strings_FindNext("*", 2ul, (*str)->Adr, (*str)->Len0, 0UL, &found,
                &pos);
      while (found) {
         if (pos>0UL && (*str)->Adr[pos-1UL]=='(') {
            LongStrs_Insert(" ", 2ul, (X2C_INT32)pos, str);
            ++pos;
            ++size;
         }
         if (pos<(X2C_CARD32)(size-1L) && (*str)->Adr[pos+1UL]==')') {
            LongStrs_Insert(" ", 2ul, (X2C_INT32)(pos+1UL), str);
         }
         Strings_FindNext("*", 2ul, (*str)->Adr, (*str)->Len0, pos+1UL,
                &found, &pos);
      }
   }
   LongStrs_Insert("(* ", 4ul, 0L, str);
   LongStrs_Append(" *)", 4ul, str);
} /* end AddCommentMark() */


static void WriteComment(const X2C_CHAR content[], X2C_CARD32 content_len,
                X2C_INT32 leadtab, X2C_INT32 tab)
{
   LongStrs_String str = 0;
   Assign(content, content_len, &str);
   AddCommentMark(&str);
   WriteStrLn(str->Adr, str->Len0, &str, leadtab, tab);
} /* end WriteComment() */


static void NewOutString(OutString * outStr)
{
   adt_Element e = 0;
   if (X2C_CALL(adt_IsEmpty_1,X2C_GET_TD(OutStringStorage),
                4)(OutStringStorage)) {
      X2C_NEW(&H2DGen_OutStringDesc_desc,(X2C_ADDRESS*)outStr,
                sizeof(struct H2DGen_OutStringDesc),0);
      adt_NewList(&(*outStr)->comment0);
   }
   else {
      X2C_CALL(adt_FindFirst_0,X2C_GET_TD(OutStringStorage),
                6)(OutStringStorage, &e);
      X2C_CALL(adt_DeleteCurrent_,X2C_GET_TD(OutStringStorage),
                3)(OutStringStorage);
      *outStr = (OutString)e;
   }
   Assign("", 1ul, &(*outStr)->str);
   (*outStr)->leadtab = 0L;
   (*outStr)->tab = 0L;
   (*outStr)->line = 0L;
   (*outStr)->backend = 7100L;
} /* end NewOutString() */


static void CommentInFile(OutString outStr, X2C_INT32 startPos,
                X2C_INT32 size)
{
   adt_Element elm = 0;
   X2C_INT32 tmp;
   X2C_INT32 tab;
   LongStrs_String str = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   tmp = H2DFile_SizeOutputLine;
   H2DFile_SizeOutputLine = X2C_max_longint;
   tab = (startPos-size)+3L+3L;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(outStr->comment0),6)(outStr->comment0,
                 &elm);
   if (elm) {
      anonym = ((adt_NamedElement)elm)->name;
      Assign(anonym->Adr, anonym->Len0, &str);
      AddCommentMark(&str);
      if (0L<=startPos) WriteStr(str->Adr, str->Len0, &str, tab, tab);
      else WriteStr(str->Adr, str->Len0, &str, 3L, 3L);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(outStr->comment0),
                8)(outStr->comment0, &elm);
      while (elm) {
         if (X2C_GET_TD(elm)->base[1]==&adt_NamedElementDesc_desc) {
            anonym0 = ((adt_NamedElement)elm)->name;
            Assign(anonym0->Adr, anonym0->Len0, &str);
            AddCommentMark(&str);
            WriteStrLn(str->Adr, str->Len0, &str, tab+size, tab+size);
         }
         X2C_CALL(adt_FindNext_0,X2C_GET_TD(outStr->comment0),
                8)(outStr->comment0, &elm);
      }
   }
   H2DFile_SizeOutputLine = tmp;
   LongStrs_Deallocate(&str);
} /* end CommentInFile() */


extern void H2DGen_GetOutputFileName(X2C_CHAR header[],
                X2C_CARD32 header_len, LongStrs_String * def)
{
   LongStrs_String ext = 0;
   LongStrs_String path = 0;
   LongStrs_String name = 0;
   LongStrs_String anonym = 0;
   X2C_NEW(&H2DGen_FILEDesc_desc,(X2C_ADDRESS*) &OutFile,
                sizeof(struct H2DGen_FILEDesc),0);
   X2C_NEW(&H2DObjs_HeaderDesc_desc,(X2C_ADDRESS*) &OutFile->header,
                sizeof(struct H2DObjs_HeaderDesc),0);
   X2C_CALL(adt_SetName_,X2C_GET_TD(OutFile->header),
                1)((adt_NamedElement)OutFile->header, "", 1ul);
   anonym = OutFile->header->name;
   H2DMsg_NewStatistics(&OutFile->header->stat, anonym->Adr, anonym->Len0);
   OutFile->line = 0L;
   OutFile->pos = 0L;
   LongStrs_Assign(header, header_len, &OutFile->name);
   H2DFile_SplitName(header, header_len, &path, &name, &ext);
   GetModuleName(header, header_len, &name, 7801L);
   if (H2DMsg_WasError) return;
   H2DFile_CreateName(path->Adr, path->Len0, name->Adr, name->Len0,
                H2DCfg_OutputExtension->Adr, H2DCfg_OutputExtension->Len0,
                def);
   LongStrs_Deallocate(&name);
   LongStrs_Deallocate(&path);
   LongStrs_Deallocate(&ext);
   OutFile = 0;
} /* end GetOutputFileName() */


static void NewFILE(FILE0 * file, H2DObjs_Header header, X2C_INT32 type)
{
   adt_Element elm = 0;
   LongStrs_String ext = 0;
   LongStrs_String fileName = 0;
   adt_NamedElement nelm = 0;
   X2C_INT32 id;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   LongStrs_String anonym2 = 0;
   LongStrs_String anonym3 = 0;
   LongStrs_String anonym4 = 0;
   LongStrs_String anonym5 = 0;
   LongStrs_String anonym6 = 0;
   LongStrs_String anonym7 = 0;
   LongStrs_String anonym8 = 0;
   LongStrs_String anonym9 = 0;
   LongStrs_String anonym10 = 0;
   LongStrs_String anonym11 = 0;
   *file = 0;
   X2C_NEW(&H2DGen_FILEDesc_desc,(X2C_ADDRESS*)file,
                sizeof(struct H2DGen_FILEDesc),0);
   (*file)->type = type;
   (*file)->header = header;
   (*file)->obj_line = -3L;
   (*file)->tab = 0L;
   (*file)->used = 0;
   (*file)->emptyLine = 0;
   (*file)->created = 0;
   anonym = header->name;
   LongStrs_Assign(anonym->Adr, anonym->Len0, &(*file)->name);
   anonym0 = header->name;
   H2DFile_SplitName(anonym0->Adr, anonym0->Len0, &(*file)->path, &fileName,
                &ext);
   anonym1 = header->name;
   GetModuleName(anonym1->Adr, anonym1->Len0, &(*file)->modname, type);
   if (H2DMsg_WasError) return;
   if (type==7803L) {
      if (anonym2 = (*file)->path,H2DFile_IsAbsolutePath(anonym2->Adr,
                anonym2->Len0)) {
         anonym3 = (*file)->modname;
         H2DFile_CreateName("", 1ul, anonym3->Adr, anonym3->Len0,
                H2DCfg_ModExtension->Adr, H2DCfg_ModExtension->Len0,
                &(*file)->name);
      }
      else {
         anonym4 = (*file)->path;
         anonym10 = (*file)->modname;
         H2DFile_CreateName(anonym4->Adr, anonym4->Len0, anonym10->Adr,
                anonym10->Len0, H2DCfg_ModExtension->Adr,
                H2DCfg_ModExtension->Len0, &(*file)->name);
      }
   }
   else if (anonym5 = (*file)->path,H2DFile_IsAbsolutePath(anonym5->Adr,
                anonym5->Len0)) {
      anonym6 = (*file)->modname;
      H2DFile_CreateName("", 1ul, anonym6->Adr, anonym6->Len0,
                H2DCfg_OutputExtension->Adr, H2DCfg_OutputExtension->Len0,
                &(*file)->name);
   }
   else {
      anonym7 = (*file)->path;
      anonym11 = (*file)->modname;
      H2DFile_CreateName(anonym7->Adr, anonym7->Len0, anonym11->Adr,
                anonym11->Len0, H2DCfg_OutputExtension->Adr,
                H2DCfg_OutputExtension->Len0, &(*file)->name);
   }
   if (type==7801L) {
      anonym8 = (*file)->modname;
      adt_NewNamedElement(&nelm, anonym8->Adr, anonym8->Len0);
      adt_NewTree(&(*file)->creatednames);
      X2C_CALL(adt_Insert_,X2C_GET_TD((*file)->creatednames),
                11)((*file)->creatednames, (adt_Element)nelm);
      X2C_CALL(adt_FindFirst_0,X2C_GET_TD(header->includes),
                6)(header->includes, &elm);
      while (elm) {
         X2C_CALL(adt_Backup_0,X2C_GET_TD(header->includes),
                2)(header->includes, &id);
         adt_NewNamedElement(&nelm, "", 1ul);
         anonym9 = ((adt_NamedElement)elm)->name;
         GetModuleName(anonym9->Adr, anonym9->Len0, &nelm->name, 7801L);
         if (H2DMsg_WasError) return;
         X2C_CALL(adt_Insert_,X2C_GET_TD((*file)->creatednames),
                11)((*file)->creatednames, (adt_Element)nelm);
         X2C_CALL(adt_Restore_0,X2C_GET_TD(header->includes),
                1)(header->includes, id);
         X2C_CALL(adt_FindNext_0,X2C_GET_TD(header->includes),
                8)(header->includes, &elm);
      }
      if ((H2DCfg_BackEnd==7102L || H2DCfg_BackEnd==7100L)
                && LongStrs_Length1(H2DCfg_DefinitionFilePrefix)>0L) {
         NewHFILE();
      }
   }
} /* end NewFILE() */


static void GenCopyright(void)
{
   LongStrs_String str = 0;
   LongStrs_String anonym = 0;
   Assign("Generated by H2D", 17ul, &str);
   LongStrs_Append(" v1.31.0 ", 10ul, &str);
   LongStrs_Append("from ", 6ul, &str);
   anonym = OutFile->header->name;
   LongStrs_Append(anonym->Adr, anonym->Len0, &str);
   LongStrs_Append(".", 2ul, &str);
   WriteComment(str->Adr, str->Len0, 0L, 0L);
   LongStrs_Deallocate(&str);
} /* end GenCopyright() */


static void BlendedHeadersList(void)
{
   adt_Element elm = 0;
   LongStrs_String str = 0;
   adt_List anonym = 0;
   adt_List anonym0 = 0;
   LongStrs_String anonym1 = 0;
   adt_List anonym2 = 0;
   LongStrs_String anonym3 = 0;
   adt_List anonym4 = 0;
   if (anonym = OutFile->header->mergedheaders,X2C_CALL(adt_IsEmpty_1,
                X2C_GET_TD(anonym),4)(anonym)) return;
   Assign("Merged headers: ", 17ul, &str);
   anonym0 = OutFile->header->mergedheaders;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(anonym0),6)(anonym0, &elm);
   anonym1 = ((adt_NamedElement)elm)->name;
   LongStrs_Append(anonym1->Adr, anonym1->Len0, &str);
   anonym2 = OutFile->header->mergedheaders;
   X2C_CALL(adt_FindNext_0,X2C_GET_TD(anonym2),8)(anonym2, &elm);
   while (elm) {
      LongStrs_Append(", ", 3ul, &str);
      anonym3 = ((adt_NamedElement)elm)->name;
      LongStrs_Append(anonym3->Adr, anonym3->Len0, &str);
      anonym4 = OutFile->header->mergedheaders;
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(anonym4),8)(anonym4, &elm);
   }
   AddCommentMark(&str);
   WriteStrLn(str->Adr, str->Len0, &str, 0L, 0L);
} /* end BlendedHeadersList() */


static void GenHeading(X2C_BOOLEAN wrCstdlib)
{
   LongStrs_String str = 0;
   LongStrs_String anonym = 0;
   str = 0;
   GetTime(&str);
   anonym = OutFile->name;
   LongStrs_Insert(anonym->Adr, anonym->Len0, 0L, &str);
   AddCommentMark(&str);
   WriteStr(str->Adr, str->Len0, &str, 0L, 0L);
   GenCopyright();
   WriteStrLn("<*+ M2ADDTYPES *>", 18ul, &null, 0L, 0L);
   WriteStrLn("<*+ M2EXTENSIONS *>", 20ul, &null, 0L, 0L);
   if (OutFile->type==7801L) {
      if (H2DCfg_BackEnd==7100L || H2DCfg_BackEnd==7102L) {
         WriteStrLn("<*+ NOHEADER *> ", 17ul, &null, 0L, 0L);
      }
      if (GenTypeDef) {
         WriteStrLn("<* IF NOT DEFINED(GENTYPEDEF) THEN *> <* NEW GENTYPEDEF+\
 *> <* END *>", 70ul, &null, 0L, 0L);
      }
      else {
         WriteStrLn("<* IF NOT DEFINED(GENTYPEDEF) THEN *> <* NEW GENTYPEDEF-\
 *> <* END *>", 70ul, &null, 0L, 0L);
      }
      if (wrCstdlib) WriteStrLn("<*+ CSTDLIB *>", 15ul, &null, 0L, 0L);
      BlendedHeadersList();
   }
   else {
      WriteStrLn("(* Prototypes for macro implementation *)", 42ul, &null,
                0L, 0L);
   }
} /* end GenHeading() */


static void MakeDirectLanguageSpecificatio(LongStrs_String * outStr)
{
   if (LongStrs_Length1(H2DCfg_DLSString)>0L) {
      LongStrs_Append("[\"", 3ul, outStr);
      LongStrs_Append(H2DCfg_DLSString->Adr, H2DCfg_DLSString->Len0, outStr);
      LongStrs_Append("\"]", 3ul, outStr);
   }
} /* end MakeDirectLanguageSpecification() */


static void GenModuleTitle(void)
{
   LongStrs_String outStr = 0;
   LongStrs_String anonym = 0;
   GenHeading(OutFile->header->cstdlib);
   WriteEmptyLine();
   if (OutFile->type==7801L) {
      Assign("DEFINITION MODULE ", 19ul, &outStr);
      MakeDirectLanguageSpecificatio(&outStr);
      LongStrs_Append(" ", 2ul, &outStr);
   }
   else if (OutFile->type==7802L) {
      Assign("DEFINITION MODULE ", 19ul, &outStr);
   }
   else Assign("IMPLEMENTATION MODULE ", 23ul, &outStr);
   anonym = OutFile->modname;
   LongStrs_Append(anonym->Adr, anonym->Len0, &outStr);
   LongStrs_Append(";", 2ul, &outStr);
   WriteStrLn(outStr->Adr, outStr->Len0, &outStr, 0L, 0L);
} /* end GenModuleTitle() */


static void MakeImportList(LongStrs_String * outStr)
{
   adt_Element elm = 0;
   LongStrs_String modName = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   X2C_SEQ tmp[3];
   if (X2C_CALL(adt_IsEmpty_1,X2C_GET_TD(Import),4)(Import)) return;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(Import),6)(Import, &elm);
   while (elm) {
      if (X2C_GET_TD(elm)->base[1]==&adt_NamedElementDesc_desc) {
         if (anonym = ((adt_NamedElement)elm)->name,
                (anonym0 = ModuleSystem->name,X2C_STRCMP(anonym->Adr,
                anonym->Len0,anonym0->Adr,anonym0->Len0))) {
            LongStrs_Append(", ", 3ul, outStr);
            anonym1 = ((adt_NamedElement)elm)->name;
            LongStrs_Append(anonym1->Adr, anonym1->Len0, outStr);
         }
      }
      else {
         Error(28L, (tmp[0].adr = "H2DGen.MakeImportList", tmp[1].val = 0,
                tmp[2].val = 22u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
         return;
      }
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(Import),8)(Import, &elm);
   }
   LongStrs_Deallocate(&modName);
} /* end MakeImportList() */


static void GenImportComment(void)
{
   LongStrs_String outStr = 0;
   LongStrs_String anonym = 0;
   Assign("(*", 3ul, &outStr);
   LongStrs_Append(" H2D: ", 7ul, &outStr);
   LongStrs_Append(" Required IMPORT clause: ", 26ul, &outStr);
   WriteStrLn(outStr->Adr, outStr->Len0, &outStr, 0L, 3L);
   Assign("IMPORT ", 8ul, &outStr);
   anonym = OutFile->modname;
   LongStrs_Append(anonym->Adr, anonym->Len0, &outStr);
   MakeImportList(&outStr);
   LongStrs_Append(";", 2ul, &outStr);
   WriteStrLn(outStr->Adr, outStr->Len0, &outStr, 0L, 2L);
   WriteStrLn("*)", 3ul, &null, 0L, 0L);
   WriteEmptyLine();
} /* end GenImportComment() */


static void GenImport(adt_List includes)
{
   adt_Element elm = 0;
   LongStrs_String str = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   WriteEmptyLine();
   Assign("IMPORT ", 8ul, &str);
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(includes),6)(includes, &elm);
   if (elm) {
      anonym = ((adt_NamedElement)elm)->name;
      LongStrs_Append(anonym->Adr, anonym->Len0, &str);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(includes),8)(includes, &elm);
   }
   while (elm) {
      LongStrs_Append(", ", 3ul, &str);
      anonym0 = ((adt_NamedElement)elm)->name;
      LongStrs_Append(anonym0->Adr, anonym0->Len0, &str);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(includes),8)(includes, &elm);
   }
   LongStrs_Append(";", 2ul, &str);
   WriteStrLn(str->Adr, str->Len0, &str, 0L, 0L);
   GenImportComment();
} /* end GenImport() */


static void GenComment(H2DObjs_Comment0 comment0)
{
   X2C_INT32 store_last_string_length;
   X2C_INT32 tmp;
   LongStrs_String str = 0;
   LongStrs_String anonym = 0;
   tmp = H2DFile_SizeOutputLine;
   store_last_string_length = last_string_length;
   H2DFile_SizeOutputLine = X2C_max_longint;
   anonym = comment0->name;
   Assign(anonym->Adr, anonym->Len0, &str);
   AddCommentMark(&str);
   if (comment0->line==-2L) WriteStrLn(str->Adr, str->Len0, &str, 0L, 0L);
   else if (comment0->line==-4L) {
      WriteStrLn(str->Adr, str->Len0, &str, comment_position, 0L);
   }
   else if (comment0->line==-3L) {
      WriteStrLn("", 1ul, &null, 0L, 0L);
      WriteStrLn(str->Adr, str->Len0, &str, 0L, 0L);
   }
   else if ((comment0->line==OutFile->obj_line && ObjectSection!=7301L)
                && ObjectSection!=7305L) {
      if (comment_was_just_generated_in_) {
         WriteStrLn(str->Adr, str->Len0, &str, last_string_length+3L,
                OutFile->tab);
      }
      else if (last_string_length>comment_position-1L) {
         WriteStr(str->Adr, str->Len0, &str, 3L, OutFile->tab);
      }
      else {
         WriteStr(str->Adr, str->Len0, &str,
                (comment_position-last_string_length)-1L, OutFile->tab);
      }
      comment_was_just_generated_in_ = 1;
   }
   else if (!comment_was_just_generated) {
      EmitSection(7100L);
      WriteEmptyLine();
      WriteStrLn(str->Adr, str->Len0, &str, comment_position, 0L);
      comment_was_just_generated = 1;
   }
   else {
      EmitSection(7100L);
      WriteStrLn(str->Adr, str->Len0, &str, 0L, 0L);
      comment_was_just_generated = 1;
   }
   last_string_length = store_last_string_length;
   H2DFile_SizeOutputLine = tmp;
   LongStrs_Deallocate(&str);
} /* end GenComment() */


static X2C_INT32 MaxLengthName(adt_List list, X2C_INT32 * deep)
{
   adt_Element elm = 0;
   X2C_INT32 maxLength;
   X2C_INT32 length;
   X2C_INT32 id;
   LongStrs_String anonym = 0;
   maxLength = 0L;
   *deep = 0L;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(list),6)(list, &elm);
   while (elm) {
      X2C_CALL(adt_Backup_0,X2C_GET_TD(list),2)(list, &id);
      if (X2C_GET_TD(elm)->base[3]!=&H2DObjs_CommentDesc_desc) {
         if (X2C_GET_TD(elm)->base[1]==&adt_NamedElementDesc_desc) {
            if (((adt_NamedElement)elm)->name) {
               length = (anonym = ((adt_NamedElement)elm)->name,
                LongStrs_Length(anonym->Adr, anonym->Len0));
               if (length>maxLength) maxLength = length;
            }
         }
      }
      ++*deep;
      X2C_CALL(adt_Restore_0,X2C_GET_TD(list),1)(list, id);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(list),8)(list, &elm);
   }
   return maxLength;
} /* end MaxLengthName() */


static void MakeTypeComment(H2DObjs_Comment0 comment0, adt_List buffer,
                OutString additional)
{
   adt_Element elm = 0;
   adt_List anonym = 0;
   X2C_CALL(adt_FindLast_0,X2C_GET_TD(buffer),5)(buffer, &elm);
   if (X2C_GET_TD(elm)->base[1]==&H2DGen_OutStringDesc_desc && ((OutString)
                elm)->line==comment0->line) {
      anonym = ((OutString)elm)->comment0;
      X2C_CALL(adt_Insert_0,X2C_GET_TD(anonym),14)(anonym,
                (adt_Element)comment0);
      if (additional) {
         X2C_CALL(adt_Insert_0,X2C_GET_TD(additional->comment0),
                14)(additional->comment0, (adt_Element)comment0);
      }
   }
   else {
      X2C_CALL(adt_Insert_0,X2C_GET_TD(buffer),14)(buffer,
                (adt_Element)comment0);
   }
} /* end MakeTypeComment() */


static void MakeBaseType(H2DObjs_Type type, adt_List buffer)
{
   OutString outStr = 0;
   H2DObjs_Type baseType = 0;
   adt_Element elm = 0;
   X2C_SEQ tmp[3];
   X2C_CALL(adt_FindLast_0,X2C_GET_TD(buffer),5)(buffer, &elm);
   outStr = (OutString)elm;
   baseType = FindCompatibleType(type);
   if (baseType==0) {
      Error(28L, (tmp[0].adr = "H2DGen.MakeBaseType", tmp[1].val = 0,
                tmp[2].val = 20u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      return;
   }
   MakeQualident((H2DObjs_Object)baseType, &outStr->str);
   LongStrs_Append(";", 2ul, &outStr->str);
} /* end MakeBaseType() */


static X2C_BOOLEAN ChangedOrderEnumerating(X2C_INT32 * id,
                H2DObjs_Type type)
{
   X2C_INT32 prevValue;
   adt_Element elm = 0;
   H2DObjs_ConstantValue result = 0;
   H2DObjs_Expression anonym = 0;
   X2C_SEQ tmp[3];
   prevValue = -1L;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(type->vars),6)(type->vars, &elm);
   while (elm) {
      X2C_CALL(adt_Backup_0,X2C_GET_TD(type->vars),2)(type->vars, id);
      if (X2C_GET_TD(elm)->base[3]==&H2DObjs_TypedObjectDesc_desc) {
         anonym = ((H2DObjs_TypedObject)elm)->expr;
         X2C_CALL(H2DObjs_ComputeExpression_,X2C_GET_TD(anonym),2)(anonym,
                &result, 0);
         if (result->type==6072L) {
            if (result->int0!=prevValue+1L) {
               H2DObjs_Deallocate((adt_Element)result);
               return 1;
            }
            H2DObjs_Deallocate((adt_Element)result);
            ++prevValue;
         }
         else {
            Error(28L, (tmp[0].adr = "H2DGen.ChangedOrderEnumerating",
                tmp[1].val = 0, tmp[2].val = 31u-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
            H2DObjs_Deallocate((adt_Element)result);
            return 1;
         }
      }
      X2C_CALL(adt_Restore_0,X2C_GET_TD(type->vars),1)(type->vars, *id);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(type->vars),8)(type->vars, &elm);
   }
   return 0;
} /* end ChangedOrderEnumerating() */


static X2C_BOOLEAN there_are_more_fields(H2DObjs_Type type, adt_Element e)
{
   X2C_INT32 id;
   X2C_CALL(adt_Backup_0,X2C_GET_TD(type->vars),2)(type->vars, &id);
   while (e && X2C_GET_TD(e)->base[3]==&H2DObjs_CommentDesc_desc) {
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(type->vars),8)(type->vars, &e);
   }
   X2C_CALL(adt_Restore_0,X2C_GET_TD(type->vars),1)(type->vars, id);
   return e!=0;
} /* end there_are_more_fields() */


static void MakeEnumConst(OutString * outStr, X2C_INT32 * prevValue,
                H2DObjs_TypedObject obj_cm)
{
   H2DObjs_ConstantValue result = 0;
   adt_NamedElement nelm = 0;
   LongStrs_String value = 0;
   X2C_SEQ tmp[3];
   X2C_CALL(H2DObjs_ComputeExpression_,X2C_GET_TD(obj_cm->expr),
                2)(obj_cm->expr, &result, 0);
   if (result->type==6072L) {
      if (result->int0!=*prevValue+1L) {
         adt_NewNamedElement(&nelm, "H2D: original integer value was ",
                33ul);
         value = X2C_CALL(H2DObjs_GetText_,X2C_GET_TD(result),1)(result, 1);
         LongStrs_Append(value->Adr, value->Len0, &nelm->name);
         X2C_CALL(adt_Insert_0,X2C_GET_TD((*outStr)->comment0),
                14)((*outStr)->comment0, (adt_Element)nelm);
         *prevValue = result->int0;
      }
      else ++*prevValue;
   }
   else {
      Error(28L, (tmp[0].adr = "H2DGen.MakeEnumConst", tmp[1].val = 0,
                tmp[2].val = 21u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
   }
   H2DObjs_Deallocate((adt_Element)result);
} /* end MakeEnumConst() */


static void MakeEnumAsSetEnumeratedType(X2C_INT32 tab, OutString * outStr,
                adt_List buffer, X2C_INT32 * id, H2DObjs_Type type)
{
   X2C_INT32 prevValue;
   X2C_BOOLEAN prev_was_comment;
   adt_Element elm = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   X2C_SEQ tmp[3];
   prevValue = -1L;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(type->vars),6)(type->vars, &elm);
   while (elm) {
      X2C_CALL(adt_Backup_0,X2C_GET_TD(type->vars),2)(type->vars, id);
      if (X2C_GET_TD(elm)->base[3]==&H2DObjs_CommentDesc_desc) {
         MakeTypeComment((H2DObjs_Comment0)elm, buffer, 0);
         prev_was_comment = 1;
      }
      else if (X2C_GET_TD(elm)->base[3]==&H2DObjs_TypedObjectDesc_desc) {
         prev_was_comment = 0;
         NewOutString(outStr);
         (*outStr)->line = ((H2DObjs_TypedObject)elm)->line;
         (*outStr)->leadtab = 4L;
         if (LongStrs_Length1(((H2DObjs_TypedObject)elm)->name)) {
            anonym = ((H2DObjs_TypedObject)elm)->name;
            Assign(anonym->Adr, anonym->Len0, &(*outStr)->str);
            SpaceStr(&BlankString,
                tab-(anonym0 = ((H2DObjs_TypedObject)elm)->name,
                LongStrs_Length(anonym0->Adr, anonym0->Len0)));
            LongStrs_Append(BlankString->Adr, BlankString->Len0,
                &(*outStr)->str);
            (*outStr)->tab = tab+(*outStr)->leadtab;
            MakeEnumConst(outStr, &prevValue, (H2DObjs_TypedObject)elm);
            X2C_CALL(adt_Insert_0,X2C_GET_TD(buffer),14)(buffer,
                (adt_Element)*outStr);
         }
         else {
            Error(28L, (tmp[0].adr = "H2DGen.MakeEnumType", tmp[1].val = 0,
                tmp[2].val = 20u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
            return;
         }
      }
      else {
         Error(28L, (tmp[0].adr = "H2DGen.MakeEnumType", tmp[1].val = 0,
                tmp[2].val = 20u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
         return;
      }
      X2C_CALL(adt_Restore_0,X2C_GET_TD(type->vars),1)(type->vars, *id);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(type->vars),8)(type->vars, &elm);
      if ((elm && !prev_was_comment) && there_are_more_fields(type, elm)) {
         LongStrs_Append(",", 2ul, &(*outStr)->str);
      }
   }
} /* end MakeEnumAsSetEnumeratedType() */

static void GenConstant(H2DObjs_TypedObject);


static void MakeEnumLikeConst(X2C_INT32 * id, H2DObjs_Type type)
{
   adt_Element elm = 0;
   X2C_SEQ tmp[3];
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(type->vars),6)(type->vars, &elm);
   while (elm) {
      X2C_CALL(adt_Backup_0,X2C_GET_TD(type->vars),2)(type->vars, id);
      if (X2C_GET_TD(elm)->base[3]==&H2DObjs_CommentDesc_desc) {
         GenComment((H2DObjs_Comment0)elm);
      }
      else if (X2C_GET_TD(elm)->base[3]==&H2DObjs_TypedObjectDesc_desc) {
         GenConstant((H2DObjs_TypedObject)elm);
      }
      else {
         Error(28L, (tmp[0].adr = "H2DGen.MakeEnumLikeConst", tmp[1].val = 0,
                 tmp[2].val = 25u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
         return;
      }
      X2C_CALL(adt_Restore_0,X2C_GET_TD(type->vars),1)(type->vars, *id);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(type->vars),8)(type->vars, &elm);
   }
} /* end MakeEnumLikeConst() */


static void MakeEnumType(H2DObjs_Type type, adt_List buffer)
{
   adt_Element typeName = 0;
   adt_Element elm1 = 0;
   adt_Element elm = 0;
   OutString outStr = 0;
   X2C_INT32 id;
   X2C_INT32 deep;
   X2C_INT32 tab;
   H2DObjs_Type intType = 0;
   H2DObjs_Comment0 comment0 = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   LongStrs_String anonym2 = 0;
   tab = MaxLengthName(type->vars, &deep);
   X2C_CALL(adt_FindLast_0,X2C_GET_TD(buffer),5)(buffer, &elm);
   outStr = (OutString)elm;
   X2C_CALL(adt_Pop_,X2C_GET_TD(NameOfGeneratedType),2)(NameOfGeneratedType,
                &typeName);
   if ((H2DCfg_EnumeratedType==0L || H2DCfg_EnumeratedType==2L && ChangedOrderEnumerating(&id,
                 type)) || (anonym = ((adt_NamedElement)typeName)->name,
                X2C_STRCMP(anonym->Adr,anonym->Len0,"Unnamed!!!",11u)==0)) {
      H2DObjs_NewComment(&comment0, -2L, "H2D: Enumeration: ", 19ul);
      anonym0 = ((adt_NamedElement)typeName)->name;
      LongStrs_Append(anonym0->Adr, anonym0->Len0, &comment0->name);
      GenComment(comment0);
      MakeEnumLikeConst(&id, type);
      X2C_CALL(adt_SetName_,X2C_GET_TD(comment0),
                1)((adt_NamedElement)comment0, "H2D: End of enumeration: ",
                26ul);
      anonym1 = ((adt_NamedElement)typeName)->name;
      LongStrs_Append(anonym1->Adr, anonym1->Len0, &comment0->name);
      if (anonym2 = ((adt_NamedElement)typeName)->name,
                X2C_STRCMP(anonym2->Adr,anonym2->Len0,"Unnamed!!!",11u)==0) {
         X2C_CALL(adt_Find_0,X2C_GET_TD(buffer),11)(buffer, elm, &elm1);
         X2C_CALL(adt_DeleteCurrent_,X2C_GET_TD(buffer),3)(buffer);
      }
      else {
         H2DObjs_NewType(&intType);
         intType->type = 1L;
         MakeBaseType(intType, buffer);
      }
      X2C_CALL(adt_Insert_0,X2C_GET_TD(buffer),14)(buffer,
                (adt_Element)comment0);
   }
   else {
      LongStrs_Append("(", 2ul, &outStr->str);
      MakeEnumAsSetEnumeratedType(tab, &outStr, buffer, &id, type);
      NewOutString(&outStr);
      Assign(");", 3ul, &outStr->str);
      outStr->leadtab = 2L;
      X2C_CALL(adt_Insert_0,X2C_GET_TD(buffer),14)(buffer,
                (adt_Element)outStr);
   }
   X2C_CALL(adt_Push_,X2C_GET_TD(NameOfGeneratedType),3)(NameOfGeneratedType,
                 typeName);
} /* end MakeEnumType() */


static void MakeArrayType(H2DObjs_Type type, adt_List buffer)
{
   OutString outStr = 0;
   H2DObjs_Type genType = 0;
   adt_Element elm = 0;
   X2C_CALL(adt_FindLast_0,X2C_GET_TD(buffer),5)(buffer, &elm);
   outStr = (OutString)elm;
   if (type->expr==0) {
      H2DObjs_NewType(&genType);
      genType->header = OutFile->header;
      genType->type = 1000L;
      genType->base = type->base;
   }
   else {
      LongStrs_Append("ARRAY [0..", 11ul, &outStr->str);
      NumberArrayElement(type->expr, &outStr->str);
      if (H2DMsg_WasError) return;
      LongStrs_Append("]", 2ul, &outStr->str);
      genType = type->base;
      while (genType->type==1002L) {
         LongStrs_Append(", [0..", 7ul, &outStr->str);
         NumberArrayElement(genType->expr, &outStr->str);
         if (H2DMsg_WasError) return;
         LongStrs_Append("]", 2ul, &outStr->str);
         genType = genType->base;
      }
      LongStrs_Append(" OF ", 5ul, &outStr->str);
   }
   genType = GetType(genType);
   if (H2DMsg_WasError) return;
   MakeQualident((H2DObjs_Object)genType, &outStr->str);
   LongStrs_Append(";", 2ul, &outStr->str);
   if (type->back_end!=7102L) type->back_end = IsTypeInCBackEnd(genType);
} /* end MakeArrayType() */


static X2C_INT32 CreateFieldName(adt_Tree names, LongStrs_String * str)
{
   X2C_INT32 number;
   adt_NamedElement nelm = 0;
   adt_Element find = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   number = 0L;
   adt_NewNamedElement(&nelm, "un", 3ul);
   X2C_CALL(adt_Find_,X2C_GET_TD(names),12)(names, (adt_Element)nelm, &find);
   while (find) {
      X2C_CALL(adt_SetName_,X2C_GET_TD(nelm),1)(nelm, "un", 3ul);
      ++number;
      IntToStr(number, &nelm->name);
      X2C_CALL(adt_Find_,X2C_GET_TD(names),12)(names, (adt_Element)nelm,
                &find);
   }
   anonym = nelm->name;
   LongStrs_Append(anonym->Adr, anonym->Len0, str);
   X2C_CALL(adt_Insert_,X2C_GET_TD(names),11)(names, (adt_Element)nelm);
   return anonym0 = nelm->name,LongStrs_Length(anonym0->Adr, anonym0->Len0);
} /* end CreateFieldName() */

static void MakeObjectType(H2DObjs_TypedObject, LongStrs_String *);


static void MakeCBitField(H2DObjs_TypedObject field, OutString outStr)
{
   adt_NamedElement nelm = 0;
   H2DObjs_ConstantValue result = 0;
   LongStrs_String anonym = 0;
   X2C_SEQ tmp[3];
   outStr->backend = 7102L;
   MakeObjectType(field, &outStr->str);
   LongStrs_Append(";", 2ul, &outStr->str);
   adt_NewNamedElement(&nelm, "H2D: bit field. ", 17ul);
   X2C_CALL(H2DObjs_ComputeExpression_,X2C_GET_TD(field->expr),
                2)(field->expr, &result, 0);
   if (result->type==6072L) {
      anonym = field->name;
      LongStrs_Append(anonym->Adr, anonym->Len0, &nelm->name);
      LongStrs_Append(":", 2ul, &nelm->name);
      IntToStr(result->int0, &nelm->name);
      X2C_CALL(adt_Insert_0,X2C_GET_TD(outStr->comment0),
                14)(outStr->comment0, (adt_Element)nelm);
   }
   else {
      Error(28L, (tmp[0].adr = "H2DGen.MakeCBitField", tmp[1].val = 0,
                tmp[2].val = 21u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
   }
   H2DObjs_Deallocate((adt_Element)result);
} /* end MakeCBitField() */


static void MakeBitField(adt_NamedElement * nBitFComment,
                OutString * nBitFOutStr, X2C_INT32 * numbeOfBit,
                H2DObjs_TypedObject field, OutString outStr)
{
   H2DObjs_ConstantValue result = 0;
   X2C_BOOLEAN writeComma;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   X2C_SEQ tmp[3];
   writeComma = 1;
   if (*numbeOfBit==0L) {
      NewOutString(nBitFOutStr);
      (*nBitFOutStr)->leadtab = 4L;
      (*nBitFOutStr)->line = outStr->line;
      (*nBitFOutStr)->tab = outStr->tab;
      anonym = outStr->str;
      Assign(anonym->Adr, anonym->Len0, &(*nBitFOutStr)->str);
      (*nBitFOutStr)->backend = 7101L;
      adt_NewNamedElement(nBitFComment, "H2D: bit field. ", 17ul);
      X2C_CALL(adt_Insert_0,X2C_GET_TD((*nBitFOutStr)->comment0),
                14)((*nBitFOutStr)->comment0, (adt_Element)*nBitFComment);
      writeComma = 0;
   }
   MakeCBitField(field, outStr);
   X2C_CALL(H2DObjs_ComputeExpression_,X2C_GET_TD(field->expr),
                2)(field->expr, &result, 0);
   if (result->type==6072L) {
      *numbeOfBit += result->int0;
      if (writeComma) LongStrs_Append(", ", 3ul, &(*nBitFComment)->name);
      anonym0 = field->name;
      LongStrs_Append(anonym0->Adr, anonym0->Len0, &(*nBitFComment)->name);
      LongStrs_Append(":", 2ul, &(*nBitFComment)->name);
      IntToStr(result->int0, &(*nBitFComment)->name);
   }
   else {
      Error(28L, (tmp[0].adr = "H2DGen.MakeStructType_MakeBitField",
                tmp[1].val = 0, tmp[2].val = 35u-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
   }
   H2DObjs_Deallocate((adt_Element)result);
} /* end MakeBitField() */


static void InsertNativeBitField(adt_NamedElement * nBitFComment,
                adt_List buffer, OutString * nBitFOutStr,
                X2C_INT32 * numbeOfBit)
{
   if (*numbeOfBit<=0L) return;
   LongStrs_Append("PACKEDSET OF [0..", 18ul, &(*nBitFOutStr)->str);
   IntToStr(*numbeOfBit-1L, &(*nBitFOutStr)->str);
   LongStrs_Append("];", 3ul, &(*nBitFOutStr)->str);
   X2C_CALL(adt_Insert_0,X2C_GET_TD(buffer),14)(buffer,
                (adt_Element)*nBitFOutStr);
   *nBitFOutStr = 0;
   *numbeOfBit = 0L;
   LongStrs_Append(".", 2ul, &(*nBitFComment)->name);
} /* end InsertNativeBitField() */


static void MakeStructType(H2DObjs_Type type, adt_List buffer)
{
   adt_Element elm = 0;
   OutString outStr = 0;
   OutString nBitFOutStr = 0;
   X2C_INT32 numbeOfBit;
   X2C_INT32 lengthName;
   X2C_INT32 id;
   X2C_INT32 deep;
   X2C_INT32 tab;
   adt_NamedElement nBitFComment = 0;
   adt_NamedElement nelm = 0;
   adt_Tree names = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   X2C_SEQ tmp[3];
   adt_NewTree(&names);
   ListToTree(type->vars, names);
   tab = MaxLengthName(type->vars, &deep);
   nBitFOutStr = 0;
   nBitFComment = 0;
   numbeOfBit = 0L;
   X2C_CALL(adt_FindLast_0,X2C_GET_TD(buffer),5)(buffer, &elm);
   outStr = (OutString)elm;
   outStr->line = type->line;
   LongStrs_Append("RECORD", 7ul, &outStr->str);
   if (type->tag_description_header==0) {
      MakeTypeComment(declaration_without_definition, buffer, nBitFOutStr);
   }
   else if (type->tag_description_header!=OutFile->header) {
      X2C_CALL(adt_SetName_,X2C_GET_TD(simple_comment),
                1)((adt_NamedElement)simple_comment, "It is defined in header\
 ", 25ul);
      anonym = type->tag_description_header->name;
      LongStrs_Append(anonym->Adr, anonym->Len0, &simple_comment->name);
      MakeTypeComment(simple_comment, buffer, nBitFOutStr);
      X2C_CALL(adt_Insert_0,X2C_GET_TD(TagDefinedInOtherHeader),
                14)(TagDefinedInOtherHeader, (adt_Element)type);
   }
   else {
      X2C_CALL(adt_FindFirst_0,X2C_GET_TD(type->vars),6)(type->vars, &elm);
      while (elm) {
         X2C_CALL(adt_Backup_0,X2C_GET_TD(type->vars),2)(type->vars, &id);
         if (X2C_GET_TD(elm)->base[3]==&H2DObjs_CommentDesc_desc) {
            MakeTypeComment((H2DObjs_Comment0)elm, buffer, nBitFOutStr);
         }
         else if (X2C_GET_TD(elm)->base[3]==&H2DObjs_TypedObjectDesc_desc) {
            NewOutString(&outStr);
            outStr->line = ((H2DObjs_TypedObject)elm)->line;
            outStr->leadtab = 4L;
            lengthName = LongStrs_Length1(((H2DObjs_TypedObject)elm)->name);
            if (lengthName==0L) {
               if (((H2DObjs_TypedObject)elm)->obj==2002L) {
                  lengthName = CreateFieldName(names, &outStr->str);
                  adt_NewNamedElement(&nelm, "H2D: unnamed field", 19ul);
                  X2C_CALL(adt_Insert_0,X2C_GET_TD(outStr->comment0),
                14)(outStr->comment0, (adt_Element)nelm);
               }
               else {
                  Error(28L, (tmp[0].adr = "H2DGen.MakeStructType",
                tmp[1].val = 0, tmp[2].val = 22u-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
                  return;
               }
            }
            else {
               anonym0 = ((H2DObjs_TypedObject)elm)->name;
               Assign(anonym0->Adr, anonym0->Len0, &outStr->str);
            }
            SpaceStr(&BlankString, tab-lengthName);
            LongStrs_Append(BlankString->Adr, BlankString->Len0,
                &outStr->str);
            LongStrs_Append(": ", 3ul, &outStr->str);
            outStr->tab = tab+2L+outStr->leadtab;
            switch (((H2DObjs_TypedObject)elm)->obj) {
            case 2000L:
               InsertNativeBitField(&nBitFComment, buffer, &nBitFOutStr,
                &numbeOfBit);
               BlendLists(((H2DObjs_TypedObject)elm)->modifier,
                &((H2DObjs_TypedObject)elm)->type->tobj_modifier);
               MakeObjectType((H2DObjs_TypedObject)elm, &outStr->str);
               LongStrs_Append(";", 2ul, &outStr->str);
               X2C_CALL(adt_Insert_0,X2C_GET_TD(buffer),14)(buffer,
                (adt_Element)outStr);
               break;
            case 2002L:
               MakeBitField(&nBitFComment, &nBitFOutStr, &numbeOfBit,
                (H2DObjs_TypedObject)elm, outStr);
               X2C_CALL(adt_Insert_0,X2C_GET_TD(buffer),14)(buffer,
                (adt_Element)outStr);
               break;
            default:;
               Error(28L, (tmp[0].adr = "H2DGen.MakeStructType",
                tmp[1].val = 0, tmp[2].val = 22u-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
               return;
            } /* end switch */
         }
         else {
            Error(28L, (tmp[0].adr = "H2DGen.MakeStructType", tmp[1].val = 0,
                 tmp[2].val = 22u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
            return;
         }
         if (H2DMsg_WasError) return;
         X2C_CALL(adt_Restore_0,X2C_GET_TD(type->vars),1)(type->vars, id);
         X2C_CALL(adt_FindNext_0,X2C_GET_TD(type->vars),8)(type->vars, &elm);
      }
      InsertNativeBitField(&nBitFComment, buffer, &nBitFOutStr, &numbeOfBit);
   }
   NewOutString(&outStr);
   Assign("END;", 5ul, &outStr->str);
   outStr->leadtab = 2L;
   X2C_CALL(adt_Insert_0,X2C_GET_TD(buffer),14)(buffer, (adt_Element)outStr);
   if (type->back_end!=7102L) {
      type->back_end = IsAnyTypeInCBackEnd(type->vars);
   }
   adt_Deallocate((adt_Element)names);
} /* end MakeStructType() */


static void MakeBitField0(OutString * nBitFOutStr, H2DObjs_TypedObject field,
                 OutString outStr)
{
   H2DObjs_ConstantValue result = 0;
   LongStrs_String anonym = 0;
   X2C_SEQ tmp[3];
   NewOutString(nBitFOutStr);
   (*nBitFOutStr)->leadtab = 6L;
   (*nBitFOutStr)->line = outStr->line;
   (*nBitFOutStr)->tab = outStr->tab;
   anonym = outStr->str;
   Assign(anonym->Adr, anonym->Len0, &(*nBitFOutStr)->str);
   (*nBitFOutStr)->backend = 7101L;
   MakeCBitField(field, outStr);
   BlendLists(outStr->comment0, &(*nBitFOutStr)->comment0);
   LongStrs_Append("PACKEDSET OF [0..", 18ul, &(*nBitFOutStr)->str);
   X2C_CALL(H2DObjs_ComputeExpression_,X2C_GET_TD(field->expr),
                2)(field->expr, &result, 0);
   if (result->type==6072L) {
      IntToStr(result->int0-1L, &(*nBitFOutStr)->str);
      LongStrs_Append("];", 3ul, &(*nBitFOutStr)->str);
   }
   else {
      Error(28L, (tmp[0].adr = "H2DGen.MakeUnionType_MakeBitField",
                tmp[1].val = 0, tmp[2].val = 34u-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
   }
   H2DObjs_Deallocate((adt_Element)result);
} /* end MakeBitField() */


static void MakeField0(X2C_INT32 tab, adt_Tree * names, X2C_INT32 * deep,
                X2C_INT32 * number, OutString * outStr,
                OutString * nBitFOutStr, adt_List buffer,
                adt_Element obj_cmp)
{
   adt_NamedElement nelm = 0;
   X2C_INT32 lengthName;
   LongStrs_String anonym = 0;
   X2C_SEQ tmp[3];
   if (X2C_GET_TD(obj_cmp)->base[3]==&H2DObjs_CommentDesc_desc) {
      MakeTypeComment((H2DObjs_Comment0)obj_cmp, buffer, *nBitFOutStr);
   }
   else if (X2C_GET_TD(obj_cmp)->base[3]==&H2DObjs_TypedObjectDesc_desc) {
      (*outStr)->leadtab = 6L;
      (*outStr)->line = ((H2DObjs_TypedObject)obj_cmp)->line;
      IntToStr(*number, &(*outStr)->str);
      SpaceStr(&BlankString, *deep-(X2C_INT32)WholeConv_LengthInt(*number));
      LongStrs_Append(BlankString->Adr, BlankString->Len0, &(*outStr)->str);
      LongStrs_Append(": ", 3ul, &(*outStr)->str);
      lengthName = LongStrs_Length1(((H2DObjs_TypedObject)obj_cmp)->name);
      if (lengthName==0L) {
         if (((H2DObjs_TypedObject)obj_cmp)->obj==2002L) {
            lengthName = CreateFieldName(*names, &(*outStr)->str);
            X2C_NEW(&adt_NamedElementDesc_desc,(X2C_ADDRESS*) &nelm,
                sizeof(struct adt_NamedElementDesc),0);
            X2C_CALL(adt_SetName_,X2C_GET_TD(nelm),1)(nelm, "H2D: unnamed fie\
ld", 19ul);
            X2C_CALL(adt_Insert_0,X2C_GET_TD((*outStr)->comment0),
                14)((*outStr)->comment0, (adt_Element)nelm);
         }
         else {
            Error(28L, (tmp[0].adr = "H2DGen.MakeField", tmp[1].val = 0,
                tmp[2].val = 17u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
            return;
         }
      }
      else {
         anonym = ((H2DObjs_TypedObject)obj_cmp)->name;
         LongStrs_Append(anonym->Adr, anonym->Len0, &(*outStr)->str);
      }
      SpaceStr(&BlankString, tab-lengthName);
      LongStrs_Append(BlankString->Adr, BlankString->Len0, &(*outStr)->str);
      LongStrs_Append(": ", 3ul, &(*outStr)->str);
      (*outStr)->tab = tab+8L+*deep+(*outStr)->leadtab;
      switch (((H2DObjs_TypedObject)obj_cmp)->obj) {
      case 2000L:
         BlendLists(((H2DObjs_TypedObject)obj_cmp)->modifier,
                &((H2DObjs_TypedObject)obj_cmp)->type->tobj_modifier);
         MakeObjectType((H2DObjs_TypedObject)obj_cmp, &(*outStr)->str);
         LongStrs_Append(";", 2ul, &(*outStr)->str);
         (*outStr)->tab = (*outStr)->tab+1L;
         X2C_CALL(adt_Insert_0,X2C_GET_TD(buffer),14)(buffer,
                (adt_Element)*outStr);
         break;
      case 2002L:
         (*outStr)->tab = (*outStr)->tab+1L;
         MakeBitField0(nBitFOutStr, (H2DObjs_TypedObject)obj_cmp, *outStr);
         X2C_CALL(adt_Insert_0,X2C_GET_TD(buffer),14)(buffer,
                (adt_Element)*outStr);
         X2C_CALL(adt_Insert_0,X2C_GET_TD(buffer),14)(buffer,
                (adt_Element)*nBitFOutStr);
         *nBitFOutStr = *outStr;
         break;
      default:;
         Error(28L, (tmp[0].adr = "H2DGen.MakeField", tmp[1].val = 0,
                tmp[2].val = 17u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
         return;
      } /* end switch */
      ++*number;
   }
} /* end MakeField() */


static void MakeUnionType(H2DObjs_Type type, adt_List buffer)
{
   adt_Element elm = 0;
   OutString nBitFOutStr = 0;
   OutString outStr = 0;
   X2C_INT32 id;
   X2C_INT32 number;
   X2C_INT32 deep;
   X2C_INT32 tab;
   adt_Tree names = 0;
   LongStrs_String anonym = 0;
   adt_NewTree(&names);
   ListToTree(type->vars, names);
   number = 0L;
   nBitFOutStr = 0;
   tab = MaxLengthName(type->vars, &deep);
   deep = (X2C_INT32)WholeConv_LengthInt(deep);
   X2C_CALL(adt_FindLast_0,X2C_GET_TD(buffer),5)(buffer, &elm);
   outStr = (OutString)elm;
   LongStrs_Append("RECORD", 7ul, &outStr->str);
   if (type->tag_description_header==0) {
      MakeTypeComment(declaration_without_definition, buffer, nBitFOutStr);
   }
   else if (type->tag_description_header!=OutFile->header) {
      X2C_CALL(adt_SetName_,X2C_GET_TD(simple_comment),
                1)((adt_NamedElement)simple_comment, "It is defined in header\
 ", 25ul);
      anonym = type->tag_description_header->name;
      LongStrs_Append(anonym->Adr, anonym->Len0, &simple_comment->name);
      MakeTypeComment(simple_comment, buffer, nBitFOutStr);
      X2C_CALL(adt_Insert_0,X2C_GET_TD(TagDefinedInOtherHeader),
                14)(TagDefinedInOtherHeader, (adt_Element)type);
   }
   else {
      NewOutString(&outStr);
      Assign("CASE : INTEGER OF", 18ul, &outStr->str);
      outStr->leadtab = 4L;
      X2C_CALL(adt_Insert_0,X2C_GET_TD(buffer),14)(buffer,
                (adt_Element)outStr);
      X2C_CALL(adt_FindFirst_0,X2C_GET_TD(type->vars),6)(type->vars, &elm);
      if (elm) {
         NewOutString(&outStr);
         Assign(" ", 2ul, &outStr->str);
         MakeField0(tab, &names, &deep, &number, &outStr, &nBitFOutStr,
                buffer, elm);
         X2C_CALL(adt_FindNext_0,X2C_GET_TD(type->vars),8)(type->vars, &elm);
         while (elm) {
            X2C_CALL(adt_Backup_0,X2C_GET_TD(type->vars),2)(type->vars, &id);
            NewOutString(&outStr);
            Assign("|", 2ul, &outStr->str);
            MakeField0(tab, &names, &deep, &number, &outStr, &nBitFOutStr,
                buffer, elm);
            X2C_CALL(adt_Restore_0,X2C_GET_TD(type->vars),1)(type->vars, id);
            X2C_CALL(adt_FindNext_0,X2C_GET_TD(type->vars),8)(type->vars,
                &elm);
         }
      }
   }
   NewOutString(&outStr);
   Assign("END;", 5ul, &outStr->str);
   outStr->leadtab = 4L;
   X2C_CALL(adt_Insert_0,X2C_GET_TD(buffer),14)(buffer, (adt_Element)outStr);
   NewOutString(&outStr);
   Assign("END;", 5ul, &outStr->str);
   outStr->leadtab = 2L;
   X2C_CALL(adt_Insert_0,X2C_GET_TD(buffer),14)(buffer, (adt_Element)outStr);
   if (type->back_end!=7102L) {
      type->back_end = IsAnyTypeInCBackEnd(type->vars);
   }
   adt_Deallocate((adt_Element)names);
} /* end MakeUnionType() */


static void MakeOneArgument(LongStrs_String * outStr,
                H2DObjs_TypedObject tobj)
{
   H2DObjs_Type genType = 0;
   LongStrs_String str = 0;
   LongStrs_String anonym = 0;
   if (tobj->obj==2003L) {
      LongStrs_Append("SEQ ", 5ul, outStr);
      LongStrs_Append("SYSTEM.BYTE", 12ul, outStr);
      return;
   }
   if (tobj->type->type==12L) return;
   if (tobj->type->type==1002L) tobj->type->expr = 0;
   BlendLists(tobj->modifier, &tobj->type->tobj_modifier);
   genType = GetType(tobj->type);
   if (H2DMsg_WasError) return;
   if (LongStrs_Length1(tobj->name)>0L) {
      anonym = tobj->name;
      Assign(anonym->Adr, anonym->Len0, &str);
      AddCommentMark(&str);
      LongStrs_Append(str->Adr, str->Len0, outStr);
      LongStrs_Append(" ", 2ul, outStr);
   }
   MakeQualident((H2DObjs_Object)genType, outStr);
   if (tobj->type->back_end!=7102L) {
      tobj->type->back_end = IsTypeInCBackEnd(genType);
   }
} /* end MakeOneArgument() */


static X2C_INT32 MakeProcTypeArguments(adt_List vars,
                LongStrs_String * outStr)
{
   adt_Element elm = 0;
   X2C_INT32 id;
   X2C_BOOLEAN comma;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   X2C_SEQ tmp[3];
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(vars),6)(vars, &elm);
   X2C_CALL(adt_Backup_0,X2C_GET_TD(vars),2)(vars, &id);
   if (elm==0) {
      X2C_CALL(adt_Restore_0,X2C_GET_TD(vars),1)(vars, id);
      return 7002L;
   }
   if (X2C_GET_TD(elm)->base[3]==&H2DObjs_TypedObjectDesc_desc) {
      MakeOneArgument(outStr, (H2DObjs_TypedObject)elm);
      if (H2DMsg_WasError) return 7002L;
      comma = 1;
   }
   else if (X2C_GET_TD(elm)->base[3]==&H2DObjs_CommentDesc_desc) {
      AddCommentMark(&((adt_NamedElement)elm)->name);
      anonym = ((adt_NamedElement)elm)->name;
      LongStrs_Append(anonym->Adr, anonym->Len0, outStr);
      LongStrs_Append(" ", 2ul, outStr);
      comma = 0;
   }
   else {
      Error(28L, (tmp[0].adr = "H2DGen.MakeFuncArguments", tmp[1].val = 0,
                tmp[2].val = 25u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      return 7002L;
   }
   X2C_CALL(adt_Restore_0,X2C_GET_TD(vars),1)(vars, id);
   X2C_CALL(adt_FindNext_0,X2C_GET_TD(vars),8)(vars, &elm);
   while (elm) {
      X2C_CALL(adt_Backup_0,X2C_GET_TD(vars),2)(vars, &id);
      if (comma) LongStrs_Append(", ", 3ul, outStr);
      if (X2C_GET_TD(elm)->base[3]==&H2DObjs_TypedObjectDesc_desc) {
         MakeOneArgument(outStr, (H2DObjs_TypedObject)elm);
         comma = 1;
      }
      else if (X2C_GET_TD(elm)->base[3]==&H2DObjs_CommentDesc_desc) {
         AddCommentMark(&((adt_NamedElement)elm)->name);
         anonym0 = ((adt_NamedElement)elm)->name;
         LongStrs_Append(anonym0->Adr, anonym0->Len0, outStr);
         LongStrs_Append(" ", 2ul, outStr);
         comma = 0;
      }
      if (H2DMsg_WasError) return 7002L;
      X2C_CALL(adt_Restore_0,X2C_GET_TD(vars),1)(vars, id);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(vars),8)(vars, &elm);
   }
   return IsAnyTypeInCBackEnd(vars);
} /* end MakeProcTypeArguments() */


static void MakeProcTypeReturnValue(H2DObjs_Type type,
                LongStrs_String * outStr)
{
   H2DObjs_Type genType = 0;
   if (type==0 || type->type==12L) return;
   genType = GetType(type);
   if (H2DMsg_WasError) return;
   LongStrs_Append(": ", 3ul, outStr);
   MakeQualident((H2DObjs_Object)genType, outStr);
   if (type->back_end!=7102L) type->back_end = IsTypeInCBackEnd(genType);
} /* end MakeProcTypeReturnValue() */


static void MakeProcedureType(H2DObjs_TypedObject tobj, adt_List buffer)
{
   OutString outStr = 0;
   X2C_INT32 cBackEnd;
   adt_Element elm = 0;
   LongStrs_String anonym = 0;
   X2C_CALL(adt_FindLast_0,X2C_GET_TD(buffer),5)(buffer, &elm);
   outStr = (OutString)elm;
   LongStrs_Append("PROCEDURE", 10ul, &outStr->str);
   MakeModifier(tobj->modifier, 7301L, &outStr->str);
   LongStrs_Append(" ( ", 4ul, &outStr->str);
   outStr->tab = (anonym = outStr->str,LongStrs_Length(anonym->Adr,
                anonym->Len0));
   cBackEnd = MakeProcTypeArguments(tobj->type->vars, &outStr->str);
   if (H2DMsg_WasError) return;
   LongStrs_Append(" )", 3ul, &outStr->str);
   BlendLists(tobj->type->modifier, &tobj->type->base->tobj_modifier);
   MakeProcTypeReturnValue(tobj->type->base, &outStr->str);
   if (H2DMsg_WasError) return;
   LongStrs_Append(";", 2ul, &outStr->str);
   if (tobj->type->back_end!=7102L) tobj->type->back_end = cBackEnd;
   if (tobj->type->back_end!=7102L) {
      tobj->type->back_end = IsTypeInCBackEnd(tobj->type);
   }
} /* end MakeProcedureType() */


static void MakePointerType(H2DObjs_Type type, adt_List buffer)
{
   OutString outStr = 0;
   H2DObjs_Type baseType = 0;
   H2DObjs_TypedObject func = 0;
   adt_Element elm = 0;
   adt_List modifier = 0;
   X2C_CALL(adt_FindLast_0,X2C_GET_TD(buffer),5)(buffer, &elm);
   outStr = (OutString)elm;
   if (IsFunction(&type->base, &type->modifier)) {
      H2DObjs_NewTypedObject(&func, 2000L);
      BlendLists(type->modifier, &func->modifier);
      func->type = type->base;
      MakeProcedureType(func, buffer);
      baseType = func->type;
      H2DObjs_Deallocate((adt_Element)func);
   }
   else {
      LongStrs_Append("POINTER", 8ul, &outStr->str);
      adt_NewList(&modifier);
      X2C_CALL(adt_Insert_0,X2C_GET_TD(modifier),14)(modifier,
                (adt_Element)type->ptr_modifier);
      MakeOnlyLanguageModifier(modifier, 7303L, &outStr->str);
      adt_Deallocate((adt_Element)modifier);
      LongStrs_Append(" TO ", 5ul, &outStr->str);
      if (LongStrs_Length1(type->base->name)==0L) {
         baseType = GetType(type->base);
      }
      else baseType = type->base;
      if (H2DMsg_WasError) return;
      MakeQualident((H2DObjs_Object)baseType, &outStr->str);
      LongStrs_Append(";", 2ul, &outStr->str);
   }
   if (H2DMsg_WasError) return;
   if (type->back_end!=7102L) type->back_end = IsTypeInCBackEnd(baseType);
} /* end MakePointerType() */


static void MakeSynonym(H2DObjs_Type type, adt_List * buffer)
{
   OutString outStr = 0;
   H2DObjs_Type genType = 0;
   adt_Element elm = 0;
   X2C_SEQ tmp[3];
   X2C_CALL(adt_FindLast_0,X2C_GET_TD(*buffer),5)(*buffer, &elm);
   outStr = (OutString)elm;
   if (type->generated || type->header!=OutFile->header && type->tag_description_header!=OutFile->header)
                 genType = type;
   else if (LongStrs_Length1(type->name)
                >0L && type->tag_description_header!=OutFile->header) {
      genType = GetType(type);
      if (H2DMsg_WasError) return;
   }
   else {
      switch (type->type) {
      case 0L:
      case 1L:
      case 2L:
      case 3L:
      case 4L:
      case 5L:
      case 6L:
      case 7L:
      case 8L:
      case 9L:
      case 10L:
      case 11L:
      case 12L:
         MakeBaseType(type, *buffer);
         return;
      case 1000L:
         MakePointerType(type, *buffer);
         return;
      case 1001L:
         MakeStructType(type, *buffer);
         return;
      case 1002L:
         MakeArrayType(type, *buffer);
         return;
      case 1005L:
         MakeUnionType(type, *buffer);
         return;
      case 1006L:
         MakeEnumType(type, *buffer);
         return;
      case 1003L:
         genType = type;
         break;
      default:;
         Error(28L, (tmp[0].adr = "H2DGen.MakeSynonym", tmp[1].val = 0,
                tmp[2].val = 19u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
         return;
      } /* end switch */
   }
   MakeQualident((H2DObjs_Object)genType, &outStr->str);
   LongStrs_Append(";", 2ul, &outStr->str);
   if (type->back_end!=7102L) type->back_end = IsTypeInCBackEnd(genType);
} /* end MakeSynonym() */


static void MakeTypeIdent(H2DObjs_Type * type, OutString * outStr)
{
   adt_Element foundSynonym = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   NewOutString(outStr);
   (*outStr)->leadtab = 2L;
   if ((*type)->type!=1003L) {
      H2DObjs_FindInNames(OutFile->header, (adt_NamedElement)*type,
                &foundSynonym);
      if (foundSynonym) {
         if (X2C_GET_TD(foundSynonym)
                ->base[3]==&H2DObjs_TypeDesc_desc && CompareType(*type,
                (H2DObjs_Type)foundSynonym)) (*type)->gen_type_def = 7000L;
         else (*type)->gen_type_def = 7001L;
      }
   }
   anonym = (*type)->name;
   Assign(anonym->Adr, anonym->Len0, &(*outStr)->str);
   LongStrs_Append(" = ", 4ul, &(*outStr)->str);
   (*outStr)->tab = (anonym0 = (*outStr)->str,LongStrs_Length(anonym0->Adr,
                anonym0->Len0));
} /* end MakeTypeIdent() */

static void GenType(H2DObjs_Type);


static void MaxStrSize(X2C_BOOLEAN * notOnlyComment, adt_List * buffer,
                X2C_INT32 * max0)
{
   adt_Element elm = 0;
   X2C_INT32 size;
   *max0 = 0L;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(*buffer),6)(*buffer, &elm);
   while (elm) {
      if (X2C_GET_TD(elm)->base[3]==&H2DObjs_CommentDesc_desc) {
      }
      else if (X2C_GET_TD(elm)->base[1]==&H2DGen_OutStringDesc_desc) {
         size = LongStrs_Length1(((OutString)elm)->str);
         *notOnlyComment = 1;
         if (size<(H2DFile_SizeOutputLine-((OutString)elm)->leadtab)
                -20L && size>*max0) *max0 = size;
      }
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(*buffer),8)(*buffer, &elm);
   }
} /* end MaxStrSize() */

static void RemoveOutStringsBuffer(adt_List *);


static void FlushBuffer0(X2C_INT32 * tmp, H2DObjs_Type * type,
                adt_List * buffer)
{
   adt_Element elm = 0;
   X2C_INT32 size;
   X2C_INT32 id;
   X2C_INT32 max0;
   X2C_BOOLEAN notOnlyComment;
   LongStrs_String anonym = 0;
   notOnlyComment = 0;
   MaxStrSize(&notOnlyComment, buffer, &max0);
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(*buffer),6)(*buffer, &elm);
   X2C_CALL(adt_Backup_0,X2C_GET_TD(*buffer),2)(*buffer, &id);
   if (elm && notOnlyComment) {
      GenHeadingObject(7303L, (*type)->gen_type_def, (*type)->back_end);
   }
   WriteEmptyLine();
   InsertEmptyLine = 0;
   X2C_CALL(adt_Restore_0,X2C_GET_TD(*buffer),1)(*buffer, id);
   while (elm) {
      X2C_CALL(adt_Backup_0,X2C_GET_TD(*buffer),2)(*buffer, &id);
      if (X2C_GET_TD(elm)->base[3]==&H2DObjs_CommentDesc_desc) {
         *tmp = comment_position;
         comment_position = 4L;
         GenComment((H2DObjs_Comment0)elm);
         if (((H2DObjs_Comment0)elm)->line!=-4L) {
            OutFile->obj_line = ((H2DObjs_Comment0)elm)->line;
         }
         comment_position = *tmp;
      }
      else if (X2C_GET_TD(elm)->base[1]==&H2DGen_OutStringDesc_desc) {
         EmitSection(((OutString)elm)->backend);
         size = LongStrs_Length1(((OutString)elm)->str);
         if (((OutString)elm)->str) {
            anonym = ((OutString)elm)->str;
            WriteStrLn(anonym->Adr, anonym->Len0, &((OutString)elm)->str,
                ((OutString)elm)->leadtab, ((OutString)elm)->tab);
         }
         OutFile->obj_line = (*type)->line;
         SetCommentTab(((OutString)elm)->str, ((OutString)elm)->leadtab,
                ((OutString)elm)->tab);
         CommentInFile((OutString)elm, max0, size+4L);
      }
      H2DFile_DivideChars = stdDivideChars;
      X2C_CALL(adt_Restore_0,X2C_GET_TD(*buffer),1)(*buffer, id);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(*buffer),8)(*buffer, &elm);
   }
   InsertEmptyLine = 1;
   RemoveOutStringsBuffer(buffer);
} /* end FlushBuffer() */


static X2C_BOOLEAN IsSynonymOnTag(H2DObjs_Type type)
{
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   X2C_SEQ tmp[3];
   if (type->name==0 || (anonym = type->name,LongStrs_Length(anonym->Adr,
                anonym->Len0))==0L) {
      Error(28L, (tmp[0].adr = "H2DGen.IsSynonyOnTag", tmp[1].val = 0,
                tmp[2].val = 21u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      return 1;
   }
   if (type->type==1003L && LongStrs_Length1(type->base->name)>0L) {
      GenType(type->base);
      if (anonym0 = type->name,(anonym1 = type->base->name,
                Strings_Equal(anonym0->Adr, anonym0->Len0, anonym1->Adr,
                anonym1->Len0))) return 1;
   }
   else if (UniqueTagName(type)==7601L) {
      ResolveCollisionOfName(type);
      return 0;
   }
   return 0;
} /* end IsSynonymOnTag() */


static X2C_BOOLEAN ExistCompatibleType(OutString * outStr,
                H2DObjs_Type type)
{
   H2DObjs_Type compatibleType = 0;
   if (type->translation_variant) {
      MakeQualident((H2DObjs_Object)type, &(*outStr)->str);
      LongStrs_Append(";", 2ul, &(*outStr)->str);
      return 1;
   }
   compatibleType = FindCompatibleType(type);
   if (compatibleType && type!=compatibleType) {
      if ((type->type!=1003L && compatibleType->type==1003L)
                && compatibleType->base==type) return 0;
      if (compatibleType->generated || OutFile->header!=compatibleType->header)
                 {
         MakeQualident((H2DObjs_Object)compatibleType, &(*outStr)->str);
         LongStrs_Append(";", 2ul, &(*outStr)->str);
         return 1;
      }
   }
   return 0;
} /* end ExistCompatibleType() */


static void GenType(H2DObjs_Type type)
{
   adt_List buffer = 0;
   OutString outStr = 0;
   X2C_INT32 tmp;
   adt_Element elm = 0;
   adt_List modifier = 0;
   X2C_SEQ tmp0[3];
   if (type->generated || type->header!=OutFile->header) return;
   type->generated = 1;
   if (IsSynonymOnTag(type)) return;
   MakeTypeIdent(&type, &outStr);
   if (H2DMsg_WasError) return;
   adt_NewList(&buffer);
   X2C_CALL(adt_Insert_0,X2C_GET_TD(buffer),14)(buffer, (adt_Element)outStr);
   adt_NewList(&modifier);
   ValueHandlerOn = 1;
   if (IsFunction(&type, &modifier)) {
      RemoveOutStringsBuffer(&buffer);
      adt_NewList(&buffer);
   }
   else if (!ExistCompatibleType(&outStr, type)) {
      X2C_CALL(adt_Push_,X2C_GET_TD(NameOfGeneratedType),
                3)(NameOfGeneratedType, (adt_Element)type);
      switch (type->type) {
      case 0L:
      case 1L:
      case 2L:
      case 3L:
      case 4L:
      case 5L:
      case 6L:
      case 7L:
      case 8L:
      case 9L:
      case 10L:
      case 11L:
      case 12L:
         MakeBaseType(type, buffer);
         break;
      case 1000L:
         MakePointerType(type, buffer);
         break;
      case 1001L:
         MakeStructType(type, buffer);
         break;
      case 1002L:
         MakeArrayType(type, buffer);
         break;
      case 1005L:
         MakeUnionType(type, buffer);
         break;
      case 1006L:
         MakeEnumType(type, buffer);
         break;
      case 1003L:
         MakeSynonym(type->base, &buffer);
         if (type->back_end!=7102L) {
            type->back_end = IsTypeInCBackEnd(type->base);
         }
         break;
      default:;
         Error(28L, (tmp0[0].adr = "GenType", tmp0[1].val = 0,
                tmp0[2].val = 8u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
         return;
      } /* end switch */
   }
   if (H2DMsg_WasError) return;
   FlushBuffer0(&tmp, &type, &buffer);
   adt_Deallocate((adt_Element)modifier);
   OutFile->obj_line = type->line;
   X2C_CALL(adt_Pop_,X2C_GET_TD(NameOfGeneratedType),2)(NameOfGeneratedType,
                &elm);
   ReplaceCompatibleType(type);
   if (HFile0 && type->created_by_back_end) HGenSynonym(type);
   ValueHandlerOn = 0;
} /* end GenType() */


static H2DObjs_Type GetType(H2DObjs_Type type)
{
   H2DObjs_Type genType = 0;
   GeneratedType node = 0;
   adt_Element e = 0;
   adt_List modifier = 0;
   if (type->generated || type->header!=OutFile->header) {
      X2C_CALL(adt_Clean_,X2C_GET_TD(type->tobj_modifier),
                15)(type->tobj_modifier);
      return type;
   }
   else if (LongStrs_Length1(type->name)>0L) {
      GenType(type);
      if (H2DMsg_WasError) return 0;
      if (!IsPointerToBaseType(type)) {
         NewGeneratedType(&node, type);
         X2C_CALL(adt_Insert_,X2C_GET_TD(GeneratedTypes),11)(GeneratedTypes,
                (adt_Element)node);
      }
      X2C_CALL(adt_Clean_,X2C_GET_TD(type->tobj_modifier),
                15)(type->tobj_modifier);
      return type;
   }
   else {
      modifier = type->tobj_modifier;
      genType = FindCompatibleType(type);
      if (genType==0) {
         genType = CreateTypeName(type, modifier);
         GenType(genType);
         if (H2DMsg_WasError) return 0;
         NewGeneratedType(&node, genType);
         X2C_CALL(adt_Find_,X2C_GET_TD(GeneratedTypes),12)(GeneratedTypes,
                (adt_Element)node, &e);
         if (e==0) {
            X2C_CALL(adt_Insert_,X2C_GET_TD(GeneratedTypes),
                11)(GeneratedTypes, (adt_Element)node);
         }
         else Deallocate((adt_Element)node);
      }
      else if (!genType->generated && (genType->header==OutFile->header || genType->tag_description_header==OutFile->header)
                ) GenType(genType);
      X2C_CALL(adt_Clean_,X2C_GET_TD(type->tobj_modifier),
                15)(type->tobj_modifier);
      return genType;
   }
   return 0;
} /* end GetType() */


static void MakeObjectType(H2DObjs_TypedObject tobj,
                LongStrs_String * outStr)
{
   H2DObjs_Type type = 0;
   H2DObjs_Type genType = 0;
   if (tobj->type_name) MakeQualident((H2DObjs_Object)tobj, outStr);
   else {
      type = tobj->type;
      genType = FindCompatibleType(type);
      if (genType==0) {
         if (type->type==1002L && type->expr) {
            LongStrs_Append("ARRAY [0..", 11ul, outStr);
            NumberArrayElement(type->expr, outStr);
            if (H2DMsg_WasError) return;
            LongStrs_Append("]", 2ul, outStr);
            genType = type->base;
            while (genType->type==1002L) {
               LongStrs_Append(", [0..", 7ul, outStr);
               NumberArrayElement(genType->expr, outStr);
               if (H2DMsg_WasError) return;
               LongStrs_Append("]", 2ul, outStr);
               genType = genType->base;
            }
            LongStrs_Append(" OF ", 5ul, outStr);
         }
         else genType = type;
      }
      else genType = type;
      genType = GetType(genType);
      if (H2DMsg_WasError) return;
      MakeQualident((H2DObjs_Object)genType, outStr);
      if (type->back_end!=7102L) type->back_end = IsTypeInCBackEnd(genType);
   }
} /* end MakeObjectType() */


static void GenVariable(H2DObjs_TypedObject tobj)
{
   LongStrs_String outStr = 0;
   X2C_INT32 tab;
   LongStrs_String anonym = 0;
   BlendLists(tobj->modifier, &tobj->type->tobj_modifier);
   anonym = tobj->name;
   Assign(anonym->Adr, anonym->Len0, &outStr);
   ExtractSynonymModifier(tobj);
   MakeModifier(tobj->modifier, 7304L, &outStr);
   LongStrs_Append(": ", 3ul, &outStr);
   tab = LongStrs_Length(outStr->Adr, outStr->Len0);
   BlendLists(tobj->modifier, &tobj->type->tobj_modifier);
   MakeObjectType(tobj, &outStr);
   if (H2DMsg_WasError) return;
   LongStrs_Append(";", 2ul, &outStr);
   if (tobj->mem_class==5023L) GenHeadingObject(7304L, 7002L, 7102L);
   else GenHeadingObject(7304L, 7002L, tobj->type->back_end);
   if (H2DMsg_WasError) return;
   WriteStrLn(outStr->Adr, outStr->Len0, &outStr, 2L, 2L+tab);
   OutFile->obj_line = tobj->line;
   SetCommentTab(outStr, 2L, 2L+tab);
   LongStrs_Deallocate(&outStr);
} /* end GenVariable() */


static X2C_BOOLEAN NoExistSuchNameArg(adt_NamedElement * nelm,
                adt_List vars)
{
   adt_Element foundArg = 0;
   X2C_INT32 id;
   X2C_CALL(adt_Backup_0,X2C_GET_TD(vars),2)(vars, &id);
   X2C_CALL(adt_Find_0,X2C_GET_TD(vars),11)(vars, (adt_Element)*nelm,
                &foundArg);
   X2C_CALL(adt_Restore_0,X2C_GET_TD(vars),1)(vars, id);
   return foundArg==0;
} /* end NoExistSuchNameArg() */


static void CreateNewArgName(adt_List vars, X2C_INT32 * numberArgument,
                adt_NamedElement * nelm, H2DObjs_TypedObject tobj)
{
   LongStrs_String anonym = 0;
   do {
      LongStrs_Assign("arg", 4ul, &(*nelm)->name);
      IntToStr(*numberArgument, &(*nelm)->name);
      ++*numberArgument;
   } while (!NoExistSuchNameArg(nelm, vars));
   anonym = (*nelm)->name;
   X2C_CALL(adt_SetName_,X2C_GET_TD(tobj),1)((adt_NamedElement)tobj,
                anonym->Adr, anonym->Len0);
} /* end CreateNewArgName() */


static void SetNameArguments(adt_List vars)
{
   adt_Element elm = 0;
   X2C_INT32 id;
   X2C_INT32 numberArgument;
   adt_NamedElement nelm = 0;
   LongStrs_String anonym = 0;
   X2C_SEQ tmp[3];
   numberArgument = 0L;
   adt_NewNamedElement(&nelm, "", 1ul);
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(vars),6)(vars, &elm);
   while (elm) {
      X2C_CALL(adt_Backup_0,X2C_GET_TD(vars),2)(vars, &id);
      if (X2C_GET_TD(elm)->base[3]==&H2DObjs_TypedObjectDesc_desc) {
         if (((H2DObjs_TypedObject)elm)
                ->name==0 || (anonym = ((H2DObjs_TypedObject)elm)->name,
                LongStrs_Length(anonym->Adr, anonym->Len0))==0L) {
            CreateNewArgName(vars, &numberArgument, &nelm,
                (H2DObjs_TypedObject)elm);
         }
      }
      else if (X2C_GET_TD(elm)->base[3]==&H2DObjs_CommentDesc_desc) {
      }
      else {
         Error(28L, (tmp[0].adr = "H2DGen.SetNameArguments", tmp[1].val = 0,
                tmp[2].val = 24u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
         return;
      }
      X2C_CALL(adt_Restore_0,X2C_GET_TD(vars),1)(vars, id);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(vars),8)(vars, &elm);
   }
   adt_Deallocate((adt_Element)nelm);
} /* end SetNameArguments() */


static void MakeOneArgument0(LongStrs_String * outStr,
                H2DObjs_TypedObject tobj)
{
   H2DObjs_Type genType = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   if (tobj->obj==2003L) {
      LongStrs_Append("SEQ ", 5ul, outStr);
      anonym = tobj->name;
      LongStrs_Append(anonym->Adr, anonym->Len0, outStr);
      LongStrs_Append(": SYSTEM.BYTE", 14ul, outStr);
      return;
   }
   if (tobj->type->type==12L) return;
   if (tobj->var) LongStrs_Append("VAR ", 5ul, outStr);
   anonym0 = tobj->name;
   LongStrs_Append(anonym0->Adr, anonym0->Len0, outStr);
   LongStrs_Append(": ", 3ul, outStr);
   if (tobj->type->type==1002L && tobj->type->expr==0) {
      LongStrs_Append("ARRAY OF ", 10ul, outStr);
      genType = tobj->type->base;
      BlendLists(tobj->type->modifier, &genType->tobj_modifier);
   }
   else {
      genType = tobj->type;
      BlendLists(tobj->modifier, &genType->tobj_modifier);
   }
   if (tobj->type_name) {
      MakeQualident((H2DObjs_Object)tobj, outStr);
      if (H2DMsg_WasError) return;
   }
   else {
      genType = GetType(genType);
      if (H2DMsg_WasError) return;
      MakeQualident((H2DObjs_Object)genType, outStr);
   }
   if (tobj->type->back_end!=7102L) {
      tobj->type->back_end = IsTypeInCBackEnd(genType);
   }
} /* end MakeOneArgument() */


static X2C_INT32 MakeFuncArguments(adt_List vars, LongStrs_String * outStr)
{
   adt_Element elm = 0;
   X2C_INT32 id;
   X2C_BOOLEAN point_comma;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   X2C_SEQ tmp[3];
   SetNameArguments(vars);
   if (H2DMsg_WasError) return 7002L;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(vars),6)(vars, &elm);
   X2C_CALL(adt_Backup_0,X2C_GET_TD(vars),2)(vars, &id);
   if (elm==0) {
      X2C_CALL(adt_Restore_0,X2C_GET_TD(vars),1)(vars, id);
      return 7002L;
   }
   if (X2C_GET_TD(elm)->base[3]==&H2DObjs_TypedObjectDesc_desc) {
      MakeOneArgument0(outStr, (H2DObjs_TypedObject)elm);
      if (H2DMsg_WasError) return 7002L;
      point_comma = 1;
   }
   else if (X2C_GET_TD(elm)->base[3]==&H2DObjs_CommentDesc_desc) {
      AddCommentMark(&((adt_NamedElement)elm)->name);
      anonym = ((adt_NamedElement)elm)->name;
      LongStrs_Append(anonym->Adr, anonym->Len0, outStr);
      LongStrs_Append(" ", 2ul, outStr);
      point_comma = 0;
   }
   else {
      Error(28L, (tmp[0].adr = "H2DGen.MakeFuncArguments", tmp[1].val = 0,
                tmp[2].val = 25u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      return 7002L;
   }
   X2C_CALL(adt_Restore_0,X2C_GET_TD(vars),1)(vars, id);
   X2C_CALL(adt_FindNext_0,X2C_GET_TD(vars),8)(vars, &elm);
   while (elm) {
      X2C_CALL(adt_Backup_0,X2C_GET_TD(vars),2)(vars, &id);
      if (point_comma) {
         LongStrs_Append("; ", 3ul, outStr);
      }
      if (X2C_GET_TD(elm)->base[3]==&H2DObjs_TypedObjectDesc_desc) {
         MakeOneArgument0(outStr, (H2DObjs_TypedObject)elm);
         point_comma = 1;
      }
      else if (X2C_GET_TD(elm)->base[3]==&H2DObjs_CommentDesc_desc) {
         AddCommentMark(&((adt_NamedElement)elm)->name);
         anonym0 = ((adt_NamedElement)elm)->name;
         LongStrs_Append(anonym0->Adr, anonym0->Len0, outStr);
         LongStrs_Append(" ", 2ul, outStr);
         point_comma = 0;
      }
      if (H2DMsg_WasError) return 7002L;
      X2C_CALL(adt_Restore_0,X2C_GET_TD(vars),1)(vars, id);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(vars),8)(vars, &elm);
   }
   return IsAnyTypeInCBackEnd(vars);
} /* end MakeFuncArguments() */


static void MakeFuncReturnValue(H2DObjs_TypedObject tobj,
                LongStrs_String * outStr)
{
   H2DObjs_Type type = 0;
   H2DObjs_Type genType = 0;
   if (tobj->type_name) {
      LongStrs_Append(": ", 3ul, outStr);
      MakeQualident((H2DObjs_Object)tobj, outStr);
   }
   else {
      type = tobj->type->base;
      if (type==0 || type->type==12L) return;
      genType = GetType(type);
      if (H2DMsg_WasError) return;
      LongStrs_Append(": ", 3ul, outStr);
      MakeQualident((H2DObjs_Object)genType, outStr);
      if (type->back_end!=7102L) type->back_end = IsTypeInCBackEnd(genType);
   }
} /* end MakeFuncReturnValue() */


static void GenFunction(H2DObjs_TypedObject tobj)
{
   LongStrs_String outStr = 0;
   X2C_INT32 cBackEnd;
   X2C_INT32 tab;
   LongStrs_String anonym = 0;
   WriteEmptyLine();
   Assign("PROCEDURE", 10ul, &outStr);
   ExtractSynonymModifier(tobj);
   MakeModifier(tobj->modifier, 7301L, &outStr);
   LongStrs_Append(" ", 2ul, &outStr);
   anonym = tobj->name;
   LongStrs_Append(anonym->Adr, anonym->Len0, &outStr);
   LongStrs_Append(" ( ", 4ul, &outStr);
   tab = LongStrs_Length(outStr->Adr, outStr->Len0)-1L;
   cBackEnd = MakeFuncArguments(tobj->type->vars, &outStr);
   if (H2DMsg_WasError) return;
   LongStrs_Append(" )", 3ul, &outStr);
   BlendLists(tobj->type->modifier, &tobj->type->base->tobj_modifier);
   MakeFuncReturnValue(tobj, &outStr);
   if (H2DMsg_WasError) return;
   LongStrs_Append(";", 2ul, &outStr);
   if (cBackEnd!=7102L) cBackEnd = IsTypeInCBackEnd(tobj->type);
   GenHeadingObject(7301L, 7002L, cBackEnd);
   H2DFile_DivideChars = divideCharsForProcedure;
   WriteStrLn(outStr->Adr, outStr->Len0, &outStr, 0L, tab);
   H2DFile_DivideChars = stdDivideChars;
   OutFile->obj_line = tobj->line;
   OutFile->tab = 0L;
} /* end GenFunction() */


static void QuotationStr(X2C_CHAR ch, const X2C_CHAR str[],
                X2C_CARD32 str_len, LongStrs_String * outStr)
{
   LongStrs_AppendChar(ch, outStr);
   LongStrs_Append(str, str_len, outStr);
   LongStrs_AppendChar(ch, outStr);
} /* end QuotationStr() */


static void SetQuote(X2C_CHAR str[], X2C_CARD32 str_len,
                X2C_CHAR codeOfQuote[5], X2C_CHAR * quote)
{
   *quote = '\'';
   strncpy(codeOfQuote,"42C",5u);
   if (LongStrs_FindPos(str, str_len, '\'')!=-1L && LongStrs_FindPos(str,
                str_len, '\"')==-1L) {
      *quote = '\"';
      strncpy(codeOfQuote,"47C",5u);
   }
} /* end SetQuote() */


static void MakeRepresentChars(LongStrs_String * outStr, X2C_INT32 size,
                X2C_INT32 * i, const X2C_CHAR str[], X2C_CARD32 str_len)
{
   LongStrs_String buffer = 0;
   X2C_INT32 beginPos;
   X2C_CHAR quote;
   X2C_CHAR codeOfQuote[5];
   beginPos = *i;
   SetQuote(str, str_len, codeOfQuote, &quote);
   while (*i<size && H2DCfg_IsRepresentativeChar((X2C_INT32)(X2C_INT16)
                (X2C_CARD8)str[*i])) {
      if (str[*i]==quote) {
         if (*i!=beginPos) {
            LongStrs_Extract(str, str_len, beginPos, *i-beginPos, &buffer);
            LongStrs_Append(" + ", 4ul, outStr);
            QuotationStr(quote, buffer->Adr, buffer->Len0, outStr);
         }
         if (*i) LongStrs_Append(" + ", 4ul, outStr);
         LongStrs_Append(codeOfQuote, 5ul, outStr);
         buffer = 0;
         beginPos = *i+1L;
      }
      ++*i;
   }
   if (*i!=beginPos) {
      if (beginPos==0L) {
         LongStrs_Extract(str, str_len, beginPos, *i-beginPos, &buffer);
         QuotationStr(quote, buffer->Adr, buffer->Len0, outStr);
      }
      else {
         LongStrs_Extract(str, str_len, beginPos, *i-beginPos, &buffer);
         LongStrs_Append(" + ", 4ul, outStr);
         QuotationStr(quote, buffer->Adr, buffer->Len0, outStr);
      }
   }
} /* end MakeRepresentChars() */


static void OctalCode(LongStrs_String * outStr, X2C_CHAR ch)
{
   X2C_INT32 pos;
   X2C_INT32 modulus;
   X2C_INT32 decCode;
   X2C_CHAR string1[2];
   decCode = (X2C_INT32)(X2C_INT16)(X2C_CARD8)ch;
   string1[1UL] = 0;
   LongStrs_Append("C", 2ul, outStr);
   pos = LongStrs_Length((*outStr)->Adr, (*outStr)->Len0)-1L;
   while (decCode) {
      modulus = decCode&7L;
      string1[0UL] = (X2C_CHAR)(modulus+48L);
      LongStrs_Insert(string1, 2ul, pos, outStr);
      decCode = X2C_DIV(decCode,8L);
   }
} /* end OctalCode() */


static void MakeNoRepresentChars(LongStrs_String * outStr, X2C_INT32 size,
                X2C_INT32 * i, const X2C_CHAR str[], X2C_CARD32 str_len)
{
   while (*i<size && !H2DCfg_IsRepresentativeChar((X2C_INT32)(X2C_INT16)
                (X2C_CARD8)str[*i])) {
      if (*i) LongStrs_Append(" + ", 4ul, outStr);
      OctalCode(outStr, str[*i]);
      ++*i;
   }
} /* end MakeNoRepresentChars() */


static void MakeStringConst(H2DObjs_ConstantValue result,
                LongStrs_String * outStr)
{
   X2C_INT32 i;
   X2C_INT32 size;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   size = (anonym = result->str,LongStrs_Length(anonym->Adr, anonym->Len0));
   i = 0L;
   if (size==0L) LongStrs_Append("\'\'", 3ul, outStr);
   else {
      while (i<size) {
         anonym0 = result->str;
         MakeRepresentChars(outStr, size, &i, anonym0->Adr, anonym0->Len0);
         anonym1 = result->str;
         MakeNoRepresentChars(outStr, size, &i, anonym1->Adr, anonym1->Len0);
      }
   }
} /* end MakeStringConst() */


static void MakeBitSet(X2C_CARD32 uint, LongStrs_String * outStr)
{
   X2C_INT32 bit;
   X2C_BOOLEAN was_comma;
   X2C_CHAR bitstr[5];
   bit = 0L;
   LongStrs_Append("{", 2ul, outStr);
   was_comma = 1;
   while (uint>0UL) {
      if ((uint&1UL)==1UL) {
         if (!was_comma) LongStrs_Append(", ", 3ul, outStr);
         WholeStr_IntToStr(bit, bitstr, 5ul);
         LongStrs_Append(bitstr, 5ul, outStr);
         was_comma = 0;
      }
      uint = uint/2UL;
      ++bit;
   }
   LongStrs_Append("}", 2ul, outStr);
} /* end MakeBitSet() */


static void GenUnknownConst(H2DObjs_TypedObject tobj,
                H2DObjs_ConstantValue result, LongStrs_String * outStr)
{
   LongStrs_String s = 0;
   switch (result->type) {
   case 6076L:
      s = X2C_CALL(H2DObjs_GetText_,X2C_GET_TD(result),1)(result, 1);
      LongStrs_Append(s->Adr, s->Len0, outStr);
      break;
   case 6072L:
      s = X2C_CALL(H2DObjs_GetText_,X2C_GET_TD(result),1)(result, 1);
      LongStrs_Append(s->Adr, s->Len0, outStr);
      break;
   case 6073L:
      s = X2C_CALL(H2DObjs_GetText_,X2C_GET_TD(result),1)(result, 1);
      LongStrs_Append(s->Adr, s->Len0, outStr);
      break;
   case 6031L:
      MakeStringConst(result, outStr);
      break;
   default:
      X2C_TRAP(X2C_CASE_TRAP);
   } /* end switch */
} /* end GenUnknownConst() */


static void GenBoolConst(H2DObjs_TypedObject tobj,
                H2DObjs_ConstantValue result, LongStrs_String * outStr)
{
   LongStrs_String anonym = 0;
   if (tobj->type_name->type!=9) {
      anonym = tobj->type_name->name;
      LongStrs_Append(anonym->Adr, anonym->Len0, outStr);
      LongStrs_Append("(", 2ul, outStr);
   }
   switch (result->type) {
   case 6072L:
      if (result->int0==0L) LongStrs_Append("FALSE", 6ul, outStr);
      else LongStrs_Append("TRUE", 5ul, outStr);
      break;
   case 6073L:
      if (result->uint==0UL) LongStrs_Append("FALSE", 6ul, outStr);
      else LongStrs_Append("TRUE", 5ul, outStr);
      break;
   default:;
      GenUnknownConst(tobj, result, outStr);
      break;
   } /* end switch */
   if (tobj->type_name->type!=9) LongStrs_Append(")", 2ul, outStr);
} /* end GenBoolConst() */


static void GenSetConst(H2DObjs_TypedObject tobj,
                H2DObjs_ConstantValue result, LongStrs_String * outStr)
{
   LongStrs_String anonym = 0;
   if (tobj->type_name->type!=8) {
      anonym = tobj->type_name->name;
      LongStrs_Append(anonym->Adr, anonym->Len0, outStr);
   }
   switch (result->type) {
   case 6072L:
      MakeBitSet((X2C_CARD32)result->int0, outStr);
      break;
   case 6073L:
      MakeBitSet(result->uint, outStr);
      break;
   default:;
      GenUnknownConst(tobj, result, outStr);
      break;
   } /* end switch */
} /* end GenSetConst() */


static void GenIntConst(H2DObjs_TypedObject tobj,
                H2DObjs_ConstantValue result, LongStrs_String * outStr)
{
   LongStrs_String anonym = 0;
   anonym = tobj->type_name->name;
   LongStrs_Append(anonym->Adr, anonym->Len0, outStr);
   LongStrs_Append("(", 2ul, outStr);
   GenUnknownConst(tobj, result, outStr);
   LongStrs_Append(")", 2ul, outStr);
} /* end GenIntConst() */


static void GenCardConst(H2DObjs_TypedObject tobj,
                H2DObjs_ConstantValue result, LongStrs_String * outStr)
{
   LongStrs_String anonym = 0;
   anonym = tobj->type_name->name;
   LongStrs_Append(anonym->Adr, anonym->Len0, outStr);
   LongStrs_Append("(", 2ul, outStr);
   GenUnknownConst(tobj, result, outStr);
   LongStrs_Append(")", 2ul, outStr);
} /* end GenCardConst() */


static void GenRealConst(H2DObjs_TypedObject tobj,
                H2DObjs_ConstantValue result, LongStrs_String * outStr)
{
   LongStrs_String anonym = 0;
   LongStrs_Append("VAL(", 5ul, outStr);
   anonym = tobj->type_name->name;
   LongStrs_Append(anonym->Adr, anonym->Len0, outStr);
   LongStrs_Append(", ", 3ul, outStr);
   GenUnknownConst(tobj, result, outStr);
   LongStrs_Append(")", 2ul, outStr);
} /* end GenRealConst() */


static void GenCharConst(H2DObjs_TypedObject tobj,
                H2DObjs_ConstantValue result, LongStrs_String * outStr)
{
   LongStrs_String anonym = 0;
   switch (result->type) {
   case 6072L:
   case 6073L:
      LongStrs_Append("CHR(", 5ul, outStr);
      GenUnknownConst(tobj, result, outStr);
      LongStrs_Append(")", 2ul, outStr);
      break;
   case 6031L:
      GenUnknownConst(tobj, result, outStr);
      break;
   default:;
      anonym = tobj->type_name->name;
      LongStrs_Append(anonym->Adr, anonym->Len0, outStr);
      LongStrs_Append("(", 2ul, outStr);
      GenUnknownConst(tobj, result, outStr);
      LongStrs_Append(")", 2ul, outStr);
      break;
   } /* end switch */
} /* end GenCharConst() */

#define H2DGen_buf_size 256


static void CheckBoolConst(H2DObjs_TypedObject tobj,
                H2DObjs_ConstantValue result)
{
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   X2C_SEQ tmp[6];
   if (result->type!=6072L && result->type!=6073L) {
      anonym0 = tobj->name;
      anonym = tobj->type_name->name;
      HError(68L, (H2DObjs_Object)tobj, (tmp[0].adr = anonym->Adr,
                tmp[1].val = 0, tmp[2].val = anonym->Len0*1u-1,
                tmp[3].adr = anonym0->Adr, tmp[4].val = 0,
                tmp[5].val = anonym0->Len0*1u-1, (X2C_LOC *)tmp),
                6ul*sizeof(X2C_SEQ));
   }
} /* end CheckBoolConst() */


static void CheckSetConst(H2DObjs_TypedObject tobj,
                H2DObjs_ConstantValue result)
{
   X2C_CHAR buf[256];
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   LongStrs_String anonym2 = 0;
   X2C_SEQ tmp[1];
   X2C_SEQ tmp0[6];
   switch (result->type) {
   case 6072L:
      Printf_sprintf(buf, 256ul, "%b", 3ul, (tmp[0].val = result->int0,
                (X2C_LOC *)tmp), sizeof(X2C_SEQ));
      break;
   case 6073L:
      Printf_sprintf(buf, 256ul, "%b", 3ul, (tmp[0].val = result->uint,
                (X2C_LOC *)tmp), sizeof(X2C_SEQ));
      break;
   default:;
      anonym0 = tobj->name;
      anonym = tobj->type_name->name;
      HError(68L, (H2DObjs_Object)tobj, (tmp0[0].adr = anonym->Adr,
                tmp0[1].val = 0, tmp0[2].val = anonym->Len0*1u-1,
                tmp0[3].adr = anonym0->Adr, tmp0[4].val = 0,
                tmp0[5].val = anonym0->Len0*1u-1, (X2C_LOC *)tmp0),
                6ul*sizeof(X2C_SEQ));
      return;
   } /* end switch */
   if (LongStrs_Length(buf, 256ul)>tobj->type_name->type_size*8L) {
      anonym2 = tobj->type_name->name;
      anonym1 = tobj->name;
      HError(69L, (H2DObjs_Object)tobj, (tmp0[0].adr = anonym1->Adr,
                tmp0[1].val = 0, tmp0[2].val = anonym1->Len0*1u-1,
                tmp0[3].adr = anonym2->Adr, tmp0[4].val = 0,
                tmp0[5].val = anonym2->Len0*1u-1, (X2C_LOC *)tmp0),
                6ul*sizeof(X2C_SEQ));
   }
} /* end CheckSetConst() */


static void CheckIntConst(H2DObjs_TypedObject tobj,
                H2DObjs_ConstantValue result)
{
   X2C_CHAR buf[256];
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   LongStrs_String anonym2 = 0;
   X2C_SEQ tmp[1];
   X2C_SEQ tmp0[6];
   switch (result->type) {
   case 6072L:
      if (result->int0<0L) {
         Printf_sprintf(buf, 256ul, "%b", 3ul, (tmp[0].val =  -result->int0,
                (X2C_LOC *)tmp), sizeof(X2C_SEQ));
      }
      else {
         Printf_sprintf(buf, 256ul, "%b", 3ul, (tmp[0].val = result->int0,
                (X2C_LOC *)tmp), sizeof(X2C_SEQ));
      }
      break;
   case 6073L:
      Printf_sprintf(buf, 256ul, "%b", 3ul, (tmp[0].val = result->uint,
                (X2C_LOC *)tmp), sizeof(X2C_SEQ));
      break;
   default:;
      anonym0 = tobj->name;
      anonym = tobj->type_name->name;
      HError(68L, (H2DObjs_Object)tobj, (tmp0[0].adr = anonym->Adr,
                tmp0[1].val = 0, tmp0[2].val = anonym->Len0*1u-1,
                tmp0[3].adr = anonym0->Adr, tmp0[4].val = 0,
                tmp0[5].val = anonym0->Len0*1u-1, (X2C_LOC *)tmp0),
                6ul*sizeof(X2C_SEQ));
      return;
   } /* end switch */
   if (LongStrs_Length(buf, 256ul)>tobj->type_name->type_size*8L-1L) {
      anonym2 = tobj->type_name->name;
      anonym1 = tobj->name;
      HError(69L, (H2DObjs_Object)tobj, (tmp0[0].adr = anonym1->Adr,
                tmp0[1].val = 0, tmp0[2].val = anonym1->Len0*1u-1,
                tmp0[3].adr = anonym2->Adr, tmp0[4].val = 0,
                tmp0[5].val = anonym2->Len0*1u-1, (X2C_LOC *)tmp0),
                6ul*sizeof(X2C_SEQ));
   }
} /* end CheckIntConst() */


static void CheckCardConst(H2DObjs_TypedObject tobj,
                H2DObjs_ConstantValue result)
{
   X2C_CHAR buf[256];
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   LongStrs_String anonym2 = 0;
   LongStrs_String anonym3 = 0;
   LongStrs_String anonym4 = 0;
   X2C_SEQ tmp[6];
   switch (result->type) {
   case 6072L:
      if (result->int0<0L) {
         anonym0 = tobj->name;
         anonym = tobj->type_name->name;
         HError(68L, (H2DObjs_Object)tobj, (tmp[0].adr = anonym->Adr,
                tmp[1].val = 0, tmp[2].val = anonym->Len0*1u-1,
                tmp[3].adr = anonym0->Adr, tmp[4].val = 0,
                tmp[5].val = anonym0->Len0*1u-1, (X2C_LOC *)tmp),
                6ul*sizeof(X2C_SEQ));
      }
      else {
         Printf_sprintf(buf, 256ul, "%b", 3ul, (tmp[0].val = result->int0,
                (X2C_LOC *)tmp), sizeof(X2C_SEQ));
      }
      break;
   case 6073L:
      Printf_sprintf(buf, 256ul, "%b", 3ul, (tmp[0].val = result->uint,
                (X2C_LOC *)tmp), sizeof(X2C_SEQ));
      break;
   default:;
      anonym2 = tobj->name;
      anonym1 = tobj->type_name->name;
      HError(68L, (H2DObjs_Object)tobj, (tmp[0].adr = anonym1->Adr,
                tmp[1].val = 0, tmp[2].val = anonym1->Len0*1u-1,
                tmp[3].adr = anonym2->Adr, tmp[4].val = 0,
                tmp[5].val = anonym2->Len0*1u-1, (X2C_LOC *)tmp),
                6ul*sizeof(X2C_SEQ));
      return;
   } /* end switch */
   if (LongStrs_Length(buf, 256ul)>tobj->type_name->type_size*8L) {
      anonym4 = tobj->type_name->name;
      anonym3 = tobj->name;
      HError(69L, (H2DObjs_Object)tobj, (tmp[0].adr = anonym3->Adr,
                tmp[1].val = 0, tmp[2].val = anonym3->Len0*1u-1,
                tmp[3].adr = anonym4->Adr, tmp[4].val = 0,
                tmp[5].val = anonym4->Len0*1u-1, (X2C_LOC *)tmp),
                6ul*sizeof(X2C_SEQ));
   }
} /* end CheckCardConst() */


static void CheckRealConst(H2DObjs_TypedObject tobj,
                H2DObjs_ConstantValue result)
{
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   LongStrs_String anonym2 = 0;
   LongStrs_String anonym3 = 0;
   LongStrs_String anonym4 = 0;
   X2C_SEQ tmp[6];
   switch (result->type) {
   case 6072L:
   case 6073L:
      break;
   case 6076L:
      if (tobj->type_name->type_size<=4L) {
         if (result->real>(X2C_LONGREAL)
                X2C_max_real || result->real<(X2C_LONGREAL)X2C_min_real) {
            anonym0 = tobj->type_name->name;
            anonym = tobj->name;
            HError(69L, (H2DObjs_Object)tobj, (tmp[0].adr = anonym->Adr,
                tmp[1].val = 0, tmp[2].val = anonym->Len0*1u-1,
                tmp[3].adr = anonym0->Adr, tmp[4].val = 0,
                tmp[5].val = anonym0->Len0*1u-1, (X2C_LOC *)tmp),
                6ul*sizeof(X2C_SEQ));
            return;
         }
      }
      else if (tobj->type_name->type_size<=8L) {
         if (result->real>X2C_max_longreal || result->real<X2C_min_longreal) {
            anonym2 = tobj->type_name->name;
            anonym1 = tobj->name;
            HError(69L, (H2DObjs_Object)tobj, (tmp[0].adr = anonym1->Adr,
                tmp[1].val = 0, tmp[2].val = anonym1->Len0*1u-1,
                tmp[3].adr = anonym2->Adr, tmp[4].val = 0,
                tmp[5].val = anonym2->Len0*1u-1, (X2C_LOC *)tmp),
                6ul*sizeof(X2C_SEQ));
            return;
         }
      }
      break;
   default:;
      anonym4 = tobj->name;
      anonym3 = tobj->type_name->name;
      HError(68L, (H2DObjs_Object)tobj, (tmp[0].adr = anonym3->Adr,
                tmp[1].val = 0, tmp[2].val = anonym3->Len0*1u-1,
                tmp[3].adr = anonym4->Adr, tmp[4].val = 0,
                tmp[5].val = anonym4->Len0*1u-1, (X2C_LOC *)tmp),
                6ul*sizeof(X2C_SEQ));
      break;
   } /* end switch */
} /* end CheckRealConst() */


static void CheckCharConst(H2DObjs_TypedObject tobj,
                H2DObjs_ConstantValue result)
{
   X2C_CHAR buf[256];
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   LongStrs_String anonym2 = 0;
   LongStrs_String anonym3 = 0;
   LongStrs_String anonym4 = 0;
   LongStrs_String anonym5 = 0;
   LongStrs_String anonym6 = 0;
   X2C_SEQ tmp[6];
   switch (result->type) {
   case 6072L:
      if (result->int0<0L) {
         anonym0 = tobj->type_name->name;
         anonym = tobj->name;
         HError(69L, (H2DObjs_Object)tobj, (tmp[0].adr = anonym->Adr,
                tmp[1].val = 0, tmp[2].val = anonym->Len0*1u-1,
                tmp[3].adr = anonym0->Adr, tmp[4].val = 0,
                tmp[5].val = anonym0->Len0*1u-1, (X2C_LOC *)tmp),
                6ul*sizeof(X2C_SEQ));
         return;
      }
      Printf_sprintf(buf, 256ul, "%b", 3ul, (tmp[0].val = result->int0,
                (X2C_LOC *)tmp), sizeof(X2C_SEQ));
      break;
   case 6073L:
      Printf_sprintf(buf, 256ul, "%b", 3ul, (tmp[0].val = result->uint,
                (X2C_LOC *)tmp), sizeof(X2C_SEQ));
      break;
   case 6031L:
      if (LongStrs_Length1(result->str)!=1L) {
         anonym2 = tobj->name;
         anonym1 = tobj->type_name->name;
         HError(68L, (H2DObjs_Object)tobj, (tmp[0].adr = anonym1->Adr,
                tmp[1].val = 0, tmp[2].val = anonym1->Len0*1u-1,
                tmp[3].adr = anonym2->Adr, tmp[4].val = 0,
                tmp[5].val = anonym2->Len0*1u-1, (X2C_LOC *)tmp),
                6ul*sizeof(X2C_SEQ));
         return;
      }
      return;
   default:;
      anonym4 = tobj->name;
      anonym3 = tobj->type_name->name;
      HError(68L, (H2DObjs_Object)tobj, (tmp[0].adr = anonym3->Adr,
                tmp[1].val = 0, tmp[2].val = anonym3->Len0*1u-1,
                tmp[3].adr = anonym4->Adr, tmp[4].val = 0,
                tmp[5].val = anonym4->Len0*1u-1, (X2C_LOC *)tmp),
                6ul*sizeof(X2C_SEQ));
      return;
   } /* end switch */
   if (LongStrs_Length(buf, 256ul)>tobj->type_name->type_size*8L) {
      anonym6 = tobj->type_name->name;
      anonym5 = tobj->name;
      HError(69L, (H2DObjs_Object)tobj, (tmp[0].adr = anonym5->Adr,
                tmp[1].val = 0, tmp[2].val = anonym5->Len0*1u-1,
                tmp[3].adr = anonym6->Adr, tmp[4].val = 0,
                tmp[5].val = anonym6->Len0*1u-1, (X2C_LOC *)tmp),
                6ul*sizeof(X2C_SEQ));
   }
} /* end CheckCharConst() */


static void ThinkAboutCharConst(H2DObjs_TypedObject tobj,
                H2DObjs_ConstantValue * result)
{
   LongStrs_String anonym = 0;
   if (X2C_GET_TD(tobj->expr)->base[2]==&H2DObjs_ValueDesc_desc && ((H2DObjs_Value)
                tobj->expr)->type==6030L) {
      H2DObjs_Deallocate((adt_Element)*result);
      H2DObjs_NewConstantValue(result);
      (*result)->type = 6031L;
      anonym = ((H2DObjs_Value)tobj->expr)->value;
      Assign(anonym->Adr, anonym->Len0, &(*result)->str);
   }
} /* end ThinkAboutCharConst() */


static void genModifiedConst(LongStrs_String * outStr,
                H2DObjs_ConstantValue * result, H2DObjs_TypedObject tobj)
{
   if (tobj->type_name->type_kind==7200L) {
      CheckBoolConst(tobj, *result);
      if (H2DMsg_WasError) return;
      GenBoolConst(tobj, *result, outStr);
   }
   else if (tobj->type_name->type_kind==7203L) {
      CheckSetConst(tobj, *result);
      if (H2DMsg_WasError) return;
      GenSetConst(tobj, *result, outStr);
   }
   else if (tobj->type_name->type_kind==7205L) {
      CheckCardConst(tobj, *result);
      if (H2DMsg_WasError) return;
      GenCardConst(tobj, *result, outStr);
   }
   else if (tobj->type_name->type_kind==7204L) {
      CheckIntConst(tobj, *result);
      if (H2DMsg_WasError) return;
      GenIntConst(tobj, *result, outStr);
   }
   else if (tobj->type_name->type_kind==7202L) {
      CheckRealConst(tobj, *result);
      if (H2DMsg_WasError) return;
      GenRealConst(tobj, *result, outStr);
   }
   else if (tobj->type_name->type_kind==7201L) {
      CheckCharConst(tobj, *result);
      if (H2DMsg_WasError) return;
      GenCharConst(tobj, *result, outStr);
   }
   else GenUnknownConst(tobj, *result, outStr);
} /* end genModifiedConst() */


static void genConstant(X2C_INT32 * tab, LongStrs_String * outStr,
                H2DObjs_TypedObject tobj, H2DObjs_ConstantValue * result,
                X2C_INT32 backEnd)
{
   LongStrs_String anonym = 0;
   ThinkAboutCharConst(tobj, result);
   GenHeadingObject(7302L, 7002L, backEnd);
   anonym = tobj->name;
   Assign(anonym->Adr, anonym->Len0, outStr);
   LongStrs_Append(" = ", 4ul, outStr);
   *tab = LongStrs_Length((*outStr)->Adr, (*outStr)->Len0);
   if (tobj->type_name) genModifiedConst(outStr, result, tobj);
   else GenUnknownConst(tobj, *result, outStr);
   LongStrs_Append(";", 2ul, outStr);
   WriteStrLn((*outStr)->Adr, (*outStr)->Len0, outStr, 2L, *tab+2L);
} /* end genConstant() */


static void genModifiedConst0(LongStrs_String * outStr,
                H2DObjs_ConstantValue * result, H2DObjs_TypedObject tobj)
{
   if (tobj->type_name->type_kind==7200L) {
      CheckBoolConst(tobj, *result);
      if (H2DMsg_WasError) return;
   }
   else if (tobj->type_name->type_kind==7203L) {
      CheckSetConst(tobj, *result);
      if (H2DMsg_WasError) return;
   }
   else if (tobj->type_name->type_kind==7204L) {
      CheckIntConst(tobj, *result);
      if (H2DMsg_WasError) return;
   }
   else if (tobj->type_name->type_kind==7205L) {
      CheckCardConst(tobj, *result);
      if (H2DMsg_WasError) return;
   }
   else if (tobj->type_name->type_kind==7202L) {
      CheckRealConst(tobj, *result);
      if (H2DMsg_WasError) return;
   }
   else if (tobj->type_name->type_kind==7201L) {
      CheckCharConst(tobj, *result);
      if (H2DMsg_WasError) return;
   }
   MakeQualident((H2DObjs_Object)tobj, outStr);
} /* end genModifiedConst() */


static void genReadOnlyVariable(H2DObjs_ConstantValue * result,
                X2C_INT32 * tab, LongStrs_String * outStr,
                H2DObjs_TypedObject tobj)
{
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   GenHeadingObject(7304L, 7002L, 7102L);
   anonym = tobj->name;
   Assign(anonym->Adr, anonym->Len0, outStr);
   LongStrs_Append(" - : ", 6ul, outStr);
   *tab = LongStrs_Length((*outStr)->Adr, (*outStr)->Len0);
   if (tobj->type_name) genModifiedConst0(outStr, result, tobj);
   else {
      switch ((*result)->type) {
      case 6072L:
         if (X2C_GET_TD(tobj->expr)
                ->base[2]==&H2DObjs_ValueDesc_desc && ((H2DObjs_Value)
                tobj->expr)->type==6030L) {
            LongStrs_Append("CHAR", 5ul, outStr);
         }
         else LongStrs_Append("INTEGER", 8ul, outStr);
         break;
      case 6076L:
         LongStrs_Append("REAL", 5ul, outStr);
         break;
      case 6073L:
         if (X2C_GET_TD(tobj->expr)
                ->base[2]==&H2DObjs_ValueDesc_desc && ((H2DObjs_Value)
                tobj->expr)->type==6030L) {
            LongStrs_Append("CHAR", 5ul, outStr);
         }
         else LongStrs_Append("CARDINAL", 9ul, outStr);
         break;
      case 6031L:
         LongStrs_Append("ARRAY [0..", 11ul, outStr);
         IntToStr((anonym0 = (*result)->str,LongStrs_Length(anonym0->Adr,
                anonym0->Len0)), outStr);
         LongStrs_Append("] OF CHAR", 10ul, outStr);
         break;
      default:
         X2C_TRAP(X2C_CASE_TRAP);
      } /* end switch */
   }
   LongStrs_Append(";", 2ul, outStr);
   WriteStrLn((*outStr)->Adr, (*outStr)->Len0, outStr, 2L, *tab+2L);
} /* end genReadOnlyVariable() */


static void GenConstant(H2DObjs_TypedObject tobj)
{
   LongStrs_String s = 0;
   LongStrs_String outStr = 0;
   H2DObjs_ConstantValue result = 0;
   X2C_INT32 tab;
   if (tobj->generated || tobj->header!=OutFile->header) return;
   tobj->generated = 1;
   X2C_CALL(H2DObjs_ComputeExpression_,X2C_GET_TD(tobj->expr),2)(tobj->expr,
                &result, 0);
   if (H2DMsg_WasError) return;
   if (H2DCfg_ConstantsToVariables) {
      genReadOnlyVariable(&result, &tab, &outStr, tobj);
      if (!H2DMsg_WasError) genConstant(&tab, &outStr, tobj, &result, 7101L);
   }
   else genConstant(&tab, &outStr, tobj, &result, 7100L);
   H2DObjs_Deallocate((adt_Element)result);
   if (H2DMsg_WasError) return;
   OutFile->obj_line = tobj->line;
   SetCommentTab(outStr, 2L, tab+2L);
   LongStrs_Deallocate(&outStr);
   LongStrs_Deallocate(&s);
} /* end GenConstant() */


static void GenConstantSynonym(H2DObjs_TypedObject tobj)
{
   LongStrs_String outStr = 0;
   X2C_INT32 tab;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   GenHeadingObject(7302L, 7002L, tobj->back_end);
   anonym = tobj->name;
   Assign(anonym->Adr, anonym->Len0, &outStr);
   LongStrs_Append(" = ", 4ul, &outStr);
   tab = LongStrs_Length(outStr->Adr, outStr->Len0);
   anonym0 = tobj->type->name;
   LongStrs_Append(anonym0->Adr, anonym0->Len0, &outStr);
   LongStrs_Append(";", 2ul, &outStr);
   WriteStrLn(outStr->Adr, outStr->Len0, &outStr, 2L, tab+2L);
   OutFile->obj_line = tobj->line;
   SetCommentTab(outStr, 2L, tab+2L);
} /* end GenConstantSynonym() */


static void MakeParametrs(LongStrs_String * outStr, adt_List params)
{
   adt_Element elm = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(params),6)(params, &elm);
   if (elm) {
      anonym = ((adt_NamedElement)elm)->name;
      LongStrs_Append(anonym->Adr, anonym->Len0, outStr);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(params),8)(params, &elm);
      while (elm) {
         LongStrs_Append(", ", 3ul, outStr);
         anonym0 = ((adt_NamedElement)elm)->name;
         LongStrs_Append(anonym0->Adr, anonym0->Len0, outStr);
         X2C_CALL(adt_FindNext_0,X2C_GET_TD(params),8)(params, &elm);
      }
      LongStrs_Append(": ", 3ul, outStr);
      LongStrs_Append("ARRAY OF SYSTEM.BYTE ", 22ul, outStr);
   }
} /* end MakeParametrs() */


static void MakeReturnedValue(void)
{
} /* end MakeReturnedValue() */


static X2C_INT32 MakeMacro(H2DObjs_Macro tobj, LongStrs_String * outStr,
                X2C_INT32 mode)
{
   X2C_INT32 tab;
   LongStrs_String anonym = 0;
   Assign("PROCEDURE ", 11ul, outStr);
   if (mode==7101L) LongStrs_Append(" / ", 4ul, outStr);
   else if (mode==7102L) {
      LongStrs_Append("[\"C\"]", 6ul, outStr);
      LongStrs_Append(" ", 2ul, outStr);
   }
   anonym = tobj->name;
   LongStrs_Append(anonym->Adr, anonym->Len0, outStr);
   LongStrs_Append(" ", 2ul, outStr);
   LongStrs_Append("( ", 3ul, outStr);
   tab = LongStrs_Length((*outStr)->Adr, (*outStr)->Len0);
   MakeParametrs(outStr, tobj->params);
   LongStrs_Append(")", 2ul, outStr);
   MakeReturnedValue();
   LongStrs_Append(";", 2ul, outStr);
   return tab;
} /* end MakeMacro() */


static void GenMacro(H2DObjs_Macro tobj)
{
   LongStrs_String comment_c = 0;
   LongStrs_String comment0 = 0;
   LongStrs_String outStr = 0;
   adt_Element foundMacro = 0;
   X2C_INT32 tab;
   GenHeadingObject(7305L, 7002L, 7102L);
   WriteEmptyLine();
   H2DObjs_FindInNames(OutFile->header, (adt_NamedElement)tobj, &foundMacro);
   Assign("(*", 3ul, &comment0);
   LongStrs_Append(" H2D: this procedure corresponds to a macro. ", 46ul,
                &comment0);
   if (foundMacro==0) {
      LongStrs_Append("*)", 3ul, &comment0);
      LongStrs_Assign(comment0->Adr, comment0->Len0, &comment_c);
      WriteStrLn(comment0->Adr, comment0->Len0, &comment0, 0L, 0L);
   }
   else {
      LongStrs_Assign(comment0->Adr, comment0->Len0, &comment_c);
      WriteStrLn(comment0->Adr, comment0->Len0, &comment0, 0L, 0L);
      WriteStrLn("   H2D: name already exists.", 29ul, &null, 0L, 0L);
   }
   tab = MakeMacro(tobj, &outStr, 7100L);
   H2DFile_DivideChars = divideCharsForProcedure;
   WriteStrLn(outStr->Adr, outStr->Len0, &outStr, 0L, tab);
   H2DFile_DivideChars = stdDivideChars;
   if (foundMacro) WriteStrLn("*)", 3ul, &null, 0L, 0L);
   if (H2DCfg_GenerateMacrosFile) {
      GenHeadingObject(7305L, 7002L, 7101L);
      WriteEmptyLine();
      if (foundMacro==0) {
         WriteStrLn(comment_c->Adr, comment_c->Len0, &comment_c, 0L, 0L);
      }
      else {
         WriteStrLn(comment_c->Adr, comment_c->Len0, &comment_c, 0L, 0L);
         WriteStrLn("   H2D: name already exists.", 29ul, &null, 0L, 0L);
      }
      tab = MakeMacro(tobj, &outStr, 7101L);
      H2DFile_DivideChars = divideCharsForProcedure;
      WriteStrLn(outStr->Adr, outStr->Len0, &outStr, 0L, tab);
      H2DFile_DivideChars = stdDivideChars;
      if (foundMacro) WriteStrLn("*)", 3ul, &null, 0L, 0L);
   }
   else LongStrs_Deallocate(&comment_c);
   OutFile->obj_line = tobj->line;
   OutFile->tab = 0L;
   LongStrs_Deallocate(&outStr);
} /* end GenMacro() */


static void GenTypedObject(H2DObjs_TypedObject tobj)
{
   H2DObjs_Comment0 comment0 = 0;
   LongStrs_String anonym = 0;
   X2C_SEQ tmp[3];
   switch (tobj->obj) {
   case 2000L:
      if (IsFunction(&tobj->type, &tobj->modifier)) GenFunction(tobj);
      else GenVariable(tobj);
      break;
   case 2001L:
      if (tobj->generated && tobj->header==OutFile->header) {
         H2DObjs_NewComment(&comment0, -3L, "Constant \'", 11ul);
         anonym = tobj->name;
         LongStrs_Append(anonym->Adr, anonym->Len0, &comment0->name);
         LongStrs_Append("\' was declared here in the source file", 39ul,
                &comment0->name);
         GenComment(comment0);
         LongStrs_Deallocate(&comment0->name);
      }
      else GenConstant(tobj);
      break;
   case 2005L:
      GenConstantSynonym(tobj);
      break;
   default:;
      Error(28L, (tmp[0].adr = "H2DGen.GenTypedObject", tmp[1].val = 0,
                tmp[2].val = 22u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      break;
   } /* end switch */
} /* end GenTypedObject() */


static void CheckName(adt_NamedElement ne)
{
   adt_Element e = 0;
   adt_NamedElement tmp_ne = 0;
   H2DObjs_Object object = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   LongStrs_String anonym2 = 0;
   LongStrs_String anonym3 = 0;
   LongStrs_String anonym4 = 0;
   LongStrs_String anonym5 = 0;
   LongStrs_String anonym6 = 0;
   LongStrs_String anonym7 = 0;
   X2C_SEQ tmp[3];
   X2C_CALL(adt_Find_,X2C_GET_TD(Modula2KeyWords),12)(Modula2KeyWords,
                (adt_Element)ne, &e);
   if (e) {
      adt_NewNamedElement(&tmp_ne, "", 1ul);
      if (X2C_GET_TD(ne)->base[3]==&H2DObjs_TypedObjectDesc_desc) {
         if (((H2DObjs_TypedObject)ne)->obj==2001L) {
            LongStrs_Assign("H2D_Const_", 11ul, &tmp_ne->name);
            anonym = ((H2DObjs_TypedObject)ne)->name;
            LongStrs_Append(anonym->Adr, anonym->Len0, &tmp_ne->name);
         }
         else {
            anonym0 = ((H2DObjs_TypedObject)ne)->name;
            HError(49L, (H2DObjs_Object)ne, (tmp[0].adr = anonym0->Adr,
                tmp[1].val = 0, tmp[2].val = anonym0->Len0*1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
         }
      }
      else if (X2C_GET_TD(ne)->base[3]==&H2DObjs_TypeDesc_desc) {
         LongStrs_Assign("H2D_Type_", 10ul, &tmp_ne->name);
         anonym1 = ((H2DObjs_Type)ne)->name;
         LongStrs_Append(anonym1->Adr, anonym1->Len0, &tmp_ne->name);
      }
      else if (X2C_GET_TD(ne)->base[3]==&H2DObjs_MacroDesc_desc) {
         LongStrs_Assign("H2D_Macro_", 11ul, &tmp_ne->name);
         anonym2 = ((H2DObjs_Macro)ne)->name;
         LongStrs_Append(anonym2->Adr, anonym2->Len0, &tmp_ne->name);
      }
      else {
         X2C_NEW(&H2DObjs_ObjectDesc_desc,(X2C_ADDRESS*) &object,
                sizeof(struct H2DObjs_ObjectDesc),0);
         object->header = OutFile->header;
         object->line = 0L;
         anonym3 = ne->name;
         HError(49L, object, (tmp[0].adr = anonym3->Adr, tmp[1].val = 0,
                tmp[2].val = anonym3->Len0*1u-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
      }
      if (LongStrs_Length1(tmp_ne->name)>0L) {
         if (RepairName(tmp_ne)) {
            anonym4 = tmp_ne->name;
            anonym7 = ne->name;
            HGenDefine(anonym4->Adr, anonym4->Len0, anonym7->Adr,
                anonym7->Len0);
            anonym5 = tmp_ne->name;
            LongStrs_Assign(anonym5->Adr, anonym5->Len0, &ne->name);
         }
         else {
            anonym6 = ne->name;
            HError(49L, (H2DObjs_Object)ne, (tmp[0].adr = anonym6->Adr,
                tmp[1].val = 0, tmp[2].val = anonym6->Len0*1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
         }
         adt_Deallocate((adt_Element)tmp_ne);
      }
   }
} /* end CheckName() */


static void GenObjects(adt_List objects)
{
   adt_Element elm = 0;
   H2DObjs_Comment0 comment0 = 0;
   X2C_INT32 id;
   LongStrs_String anonym = 0;
   X2C_SEQ tmp[3];
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(objects),6)(objects, &elm);
   while (elm) {
      X2C_CALL(adt_Backup_0,X2C_GET_TD(objects),2)(objects, &id);
      if (X2C_GET_TD(elm)->base[3]==&H2DObjs_TypedObjectDesc_desc) {
         CheckName((adt_NamedElement)elm);
         if (H2DMsg_WasError) return;
         GenTypedObject((H2DObjs_TypedObject)elm);
      }
      else if (X2C_GET_TD(elm)->base[3]==&H2DObjs_TypeDesc_desc) {
         CheckName((adt_NamedElement)elm);
         if (H2DMsg_WasError) return;
         if (((H2DObjs_Type)elm)->generated) {
            H2DObjs_NewComment(&comment0, -3L, "Type \'", 7ul);
            anonym = ((H2DObjs_Type)elm)->name;
            LongStrs_Append(anonym->Adr, anonym->Len0, &comment0->name);
            LongStrs_Append("\' was declared here in the source file", 39ul,
                &comment0->name);
            GenComment(comment0);
            LongStrs_Deallocate(&comment0->name);
         }
         else GenType((H2DObjs_Type)elm);
      }
      else if (X2C_GET_TD(elm)->base[3]==&H2DObjs_MacroDesc_desc) {
         CheckName((adt_NamedElement)elm);
         if (H2DMsg_WasError) return;
         GenMacro((H2DObjs_Macro)elm);
      }
      else if (X2C_GET_TD(elm)->base[3]==&H2DObjs_CommentDesc_desc) {
         GenComment((H2DObjs_Comment0)elm);
      }
      else {
         Error(28L, (tmp[0].adr = "H2DGen.GenObjects", tmp[1].val = 0,
                tmp[2].val = 18u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
         return;
      }
      if (H2DMsg_WasError) return;
      X2C_CALL(adt_Restore_0,X2C_GET_TD(objects),1)(objects, id);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(objects),8)(objects, &elm);
   }
} /* end GenObjects() */


static void GenModuleEnd(void)
{
   LongStrs_String str = 0;
   LongStrs_String anonym = 0;
   EmitSection(7100L);
   WriteEmptyLine();
   Assign("END ", 5ul, &str);
   anonym = OutFile->modname;
   LongStrs_Append(anonym->Adr, anonym->Len0, &str);
   LongStrs_AppendChar('.', &str);
   WriteStrLn(str->Adr, str->Len0, &str, 0L, 0L);
   WriteEmptyLine();
   LongStrs_Deallocate(&str);
} /* end GenModuleEnd() */


static void CopyTypeNameFromOtherFile(H2DObjs_Type elm, adt_Tree * to)
{
   adt_Element e = 0;
   GeneratedType node = 0;
   if ((elm->type==1003L || elm->tag_description_header==0)
                || elm->tag_description_header==elm->header) {
      if (elm->type!=1003L && UniqueTagName(elm)==7601L) {
         ResolveCollisionOfName(elm);
      }
      NewGeneratedType(&node, elm);
      X2C_CALL(adt_Find_,X2C_GET_TD(*to),12)(*to, (adt_Element)node, &e);
      if (e==0) {
         if (!IsPointerToBaseType(node->type)) {
            X2C_CALL(adt_Insert_,X2C_GET_TD(*to),11)(*to, (adt_Element)node);
         }
      }
      else Deallocate((adt_Element)node);
   }
} /* end CopyTypeNameFromOtherFile() */


static void CopyTypeNameFromCurrentFile(H2DObjs_Type elm, adt_Tree * to)
{
   adt_Element e = 0;
   GeneratedType node = 0;
   H2DObjs_Type synonym = 0;
   LongStrs_String anonym = 0;
   if (elm->type!=1003L && UniqueTagName(elm)==7601L) {
      ResolveCollisionOfName(elm);
   }
   NewGeneratedType(&node, elm);
   X2C_CALL(adt_Find_,X2C_GET_TD(*to),12)(*to, (adt_Element)node, &e);
   if (e==0) {
      if (!IsPointerToBaseType(node->type)) {
         X2C_CALL(adt_Insert_,X2C_GET_TD(*to),11)(*to, (adt_Element)node);
      }
   }
   else {
      if (X2C_GET_TD(e)->base[2]==&H2DGen_GeneratedTypeDesc_desc) {
         if (((GeneratedType)e)->type->header && (((GeneratedType)e)
                ->type->header!=OutFile->header || ((GeneratedType)e)
                ->type->line>elm->line)) {
            if (elm->type!=1003L) {
               H2DObjs_NewType(&synonym);
               anonym = elm->name;
               X2C_CALL(adt_SetName_,X2C_GET_TD(synonym),
                1)((adt_NamedElement)synonym, anonym->Adr, anonym->Len0);
               synonym->type = 1003L;
               synonym->base = elm;
               synonym->line = elm->line;
            }
            ((GeneratedType)e)->type = elm;
         }
      }
      Deallocate((adt_Element)node);
   }
} /* end CopyTypeNameFromCurrentFile() */


static void CopyTypeNameFromTree(adt_Tree from, adt_Tree * to)
{
   adt_Element elm = 0;
   if (from==0) return;
   if (*to==0) adt_NewTree(to);
   X2C_CALL(adt_FindFirst_,X2C_GET_TD(from),6)(from, &elm);
   while (elm) {
      if (X2C_GET_TD(elm)->base[3]==&H2DObjs_TypeDesc_desc) {
         if (((H2DObjs_Type)elm)->header==OutFile->header || ((H2DObjs_Type)
                elm)->tag_description_header && ((H2DObjs_Type)elm)
                ->tag_description_header==((H2DObjs_Type)elm)->header) {
            CopyTypeNameFromCurrentFile((H2DObjs_Type)elm, to);
         }
         else CopyTypeNameFromOtherFile((H2DObjs_Type)elm, to);
      }
      X2C_CALL(adt_FindNext_,X2C_GET_TD(from),8)(from, &elm);
   }
} /* end CopyTypeNameFromTree() */

static void ExtractNamedTypes(H2DObjs_Header);


static void ExtractNamedTypes(H2DObjs_Header header)
{
   adt_Element h = 0;
   adt_Element e = 0;
   if (header==0) return;
   CopyTypeNameFromTree(header->Names, &GeneratedTypes);
   CopyTypeNameFromTree(header->Tags, &GeneratedTypes);
   X2C_CALL(adt_Insert_0,X2C_GET_TD(ListForExtractNamedTypes),
                14)(ListForExtractNamedTypes, (adt_Element)header);
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(header->includes),6)(header->includes,
                 &e);
   while (e) {
      X2C_CALL(adt_Find_0,X2C_GET_TD(ListForExtractNamedTypes),
                11)(ListForExtractNamedTypes, e, &h);
      if (h==0) ExtractNamedTypes((H2DObjs_Header)e);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(header->includes),
                8)(header->includes, &e);
   }
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(ListForExtractNamedTypes),
                6)(ListForExtractNamedTypes, &h);
   if (h==(adt_Element)header) {
      X2C_CALL(adt_Clean_,X2C_GET_TD(ListForExtractNamedTypes),
                15)(ListForExtractNamedTypes);
   }
} /* end ExtractNamedTypes() */


static void GenNativeMacro(X2C_INT32 * tab, H2DObjs_Macro macro)
{
   LongStrs_String str = 0;
   LongStrs_String outStr_c = 0;
   LongStrs_String outStr = 0;
   X2C_CARD32 pos;
   X2C_BOOLEAN finded;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   OutFile = MacroDefFile;
   *tab = MakeMacro(macro, &outStr, 7102L);
   LongStrs_Assign(outStr->Adr, outStr->Len0, &outStr_c);
   WriteEmptyLine();
   WriteStrLn(outStr->Adr, outStr->Len0, &outStr, 0L, *tab);
   OutFile = MacroModFile;
   WriteEmptyLine();
   WriteStrLn(outStr_c->Adr, outStr_c->Len0, &outStr_c, 0L, *tab);
   WriteStrLn("(* ", 4ul, &null, 0L, 0L);
   anonym = macro->text;
   Assign(anonym->Adr, anonym->Len0, &outStr);
   H2DFile_DivideChars = nothingDivideChars;
   Strings_FindNext("\\", 2ul, outStr->Adr, outStr->Len0, 0UL, &finded,
                &pos);
   while (finded) {
      LongStrs_Extract(outStr->Adr, outStr->Len0, 0L, (X2C_INT32)(pos+1UL),
                &str);
      LongStrs_Delete(outStr->Adr, outStr->Len0, 0L, (X2C_INT32)(pos+1UL));
      WriteStrLn(str->Adr, str->Len0, &str, 0L, 0L);
      Strings_FindNext("\\", 2ul, outStr->Adr, outStr->Len0, 0UL, &finded,
                &pos);
   }
   WriteStrLn(outStr->Adr, outStr->Len0, &outStr, 0L, 0L);
   WriteStrLn("*)", 3ul, &null, 0L, 0L);
   H2DFile_DivideChars = stdDivideChars;
   WriteStrLn("BEGIN", 6ul, &null, 0L, 0L);
   Assign("END ", 5ul, &outStr);
   anonym0 = macro->name;
   LongStrs_Append(anonym0->Adr, anonym0->Len0, &outStr);
   LongStrs_Append(";", 2ul, &outStr);
   WriteStrLn(outStr->Adr, outStr->Len0, &outStr, 0L, 0L);
} /* end GenNativeMacro() */


static void GenMacroFiles(H2DObjs_Header header)
{
   adt_Element elm = 0;
   X2C_INT32 tab;
   X2C_INT32 id;
   NewFILE(&MacroDefFile, header, 7802L);
   OutFile = MacroDefFile;
   if (H2DMsg_WasError) return;
   OpenFile();
   if (H2DMsg_WasError) return;
   GenModuleTitle();
   if (H2DMsg_WasError) return;
   WriteEmptyLine();
   WriteStrLn("IMPORT SYSTEM;", 15ul, &null, 0L, 0L);
   NewFILE(&MacroModFile, header, 7803L);
   OutFile = MacroModFile;
   if (H2DMsg_WasError) return;
   OpenFile();
   if (H2DMsg_WasError) return;
   GenModuleTitle();
   if (H2DMsg_WasError) return;
   WriteEmptyLine();
   WriteStrLn("IMPORT SYSTEM;", 15ul, &null, 0L, 0L);
   X2C_CALL(adt_FindFirst_,X2C_GET_TD(header->Macros),6)(header->Macros,
                &elm);
   while (elm) {
      X2C_CALL(adt_Backup_,X2C_GET_TD(header->Macros),2)(header->Macros,
                &id);
      GenNativeMacro(&tab, (H2DObjs_Macro)elm);
      X2C_CALL(adt_Restore_,X2C_GET_TD(header->Macros),1)(header->Macros,
                id);
      X2C_CALL(adt_FindNext_,X2C_GET_TD(header->Macros),8)(header->Macros,
                &elm);
   }
   OutFile = MacroDefFile;
   GenModuleEnd();
   if (H2DMsg_WasError) return;
   CloseFile();
   OutFile = MacroModFile;
   GenModuleEnd();
   if (H2DMsg_WasError) return;
   CloseFile();
   OutFile = StdDefFile;
} /* end GenMacroFiles() */


static void InitImport(H2DObjs_Header header)
{
   adt_Element found = 0;
   adt_Element elm = 0;
   adt_NamedElement imp = 0;
   LongStrs_String modname = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   LongStrs_String anonym2 = 0;
   LongStrs_String anonym3 = 0;
   LongStrs_String anonym4 = 0;
   X2C_SEQ tmp[3];
   adt_NewList(&Import);
   anonym = header->name;
   GetModuleName(anonym->Adr, anonym->Len0, &modname, 7801L);
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(header->includes),6)(header->includes,
                 &elm);
   while (elm) {
      X2C_NEW(&adt_NamedElementDesc_desc,(X2C_ADDRESS*) &imp,
                sizeof(struct adt_NamedElementDesc),0);
      anonym0 = ((adt_NamedElement)elm)->name;
      GetModuleName(anonym0->Adr, anonym0->Len0, &imp->name, 7801L);
      if (H2DMsg_WasError) return;
      X2C_CALL(adt_Find_0,X2C_GET_TD(Import),11)(Import, (adt_Element)imp,
                &found);
      if ((anonym1 = imp->name,X2C_STRCMP(anonym1->Adr,anonym1->Len0,
                modname->Adr,modname->Len0)==0) || found) {
         anonym2 = imp->name;
         Error(66L, (tmp[0].adr = anonym2->Adr, tmp[1].val = 0,
                tmp[2].val = anonym2->Len0*1u-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
         return;
      }
      CheckName(imp);
      if (H2DMsg_WasError) return;
      X2C_CALL(adt_Insert_0,X2C_GET_TD(Import),14)(Import, (adt_Element)imp);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(header->includes),
                8)(header->includes, &elm);
   }
   anonym3 = ModuleSystem->name;
   adt_NewNamedElement(&imp, anonym3->Adr, anonym3->Len0);
   X2C_CALL(adt_Find_0,X2C_GET_TD(Import),11)(Import, (adt_Element)imp,
                &found);
   if (found==0) {
      X2C_CALL(adt_Insert_0,X2C_GET_TD(Import),14)(Import, (adt_Element)imp);
   }
   adt_NewList(&AdtImport);
   X2C_CALL(adt_FindFirst_,X2C_GET_TD(H2DObjs_M2Types),6)(H2DObjs_M2Types,
                &elm);
   while (elm) {
      X2C_NEW(&adt_NamedElementDesc_desc,(X2C_ADDRESS*) &imp,
                sizeof(struct adt_NamedElementDesc),0);
      anonym4 = ((H2DObjs_M2Type)elm)->name;
      ExtractModName(anonym4->Adr, anonym4->Len0, &imp->name);
      if (imp->name) {
         X2C_CALL(adt_Find_0,X2C_GET_TD(Import),11)(Import, (adt_Element)imp,
                 &found);
         if (found==0) {
            X2C_CALL(adt_Insert_0,X2C_GET_TD(Import),14)(Import,
                (adt_Element)imp);
            X2C_CALL(adt_Insert_0,X2C_GET_TD(AdtImport),14)(AdtImport,
                (adt_Element)imp);
         }
      }
      X2C_CALL(adt_FindNext_,X2C_GET_TD(H2DObjs_M2Types),8)(H2DObjs_M2Types,
                &elm);
   }
   LongStrs_Deallocate(&modname);
} /* end InitImport() */


static void InitWriteBuffer(void)
{
   adt_NewList(&WriteBuffer);
   WriteStrLn = (void ( *)(X2C_CHAR [], X2C_CARD32, LongStrs_String *,
                X2C_INT32, X2C_INT32))WriteStrLn2File;
   WriteStr = (void ( *)(X2C_CHAR [], X2C_CARD32, LongStrs_String *,
                X2C_INT32, X2C_INT32))WriteStr2File;
} /* end InitWriteBuffer() */


static void InitGenerater(H2DObjs_Header header)
{
   InitWriteBuffer();
   adt_NewStack(&NameOfGeneratedType);
   adt_NewList(&TagDefinedInOtherHeader);
   HFile0 = 0;
   InsertEmptyLine = 1;
   InitImport(header);
   NewFILE(&OutFile, header, 7801L);
   if (H2DMsg_WasError) return;
   StdDefFile = OutFile;
   OpenFile();
   if (H2DMsg_WasError) return;
   adt_NewTree(&GeneratedTypes);
   GenTypeDef = 1;
   BackEndSection = 7100L;
   OSectionNative = 7501L;
   OSectionCommon = 7501L;
   OSectionC_Code = 7501L;
   ObjectSection = 7501L;
   comment_was_just_generated = 0;
   comment_was_just_generated_in_ = 0;
   last_string_length = 0L;
   H2DFile_DivideChars = stdDivideChars;
   SetBaseTypes();
   ExtractNamedTypes(header);
} /* end InitGenerater() */


static void EraseTrace(void)
{
   adt_Element elm = 0;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(TagDefinedInOtherHeader),
                6)(TagDefinedInOtherHeader, &elm);
   while (elm) {
      ((H2DObjs_Type)elm)->generated = 0;
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(TagDefinedInOtherHeader),
                8)(TagDefinedInOtherHeader, &elm);
   }
   adt_Deallocate((adt_Element)TagDefinedInOtherHeader);
} /* end EraseTrace() */


static void StartGenerate(H2DObjs_Header header)
{
   InitGenerater(header);
   if (H2DMsg_WasError) return;
   GenModuleTitle();
   if (H2DMsg_WasError) return;
   GenImport(Import);
   if (H2DMsg_WasError) return;
   GenObjects(header->objects);
   if (H2DMsg_WasError) return;
   GenModuleEnd();
   if (H2DMsg_WasError) return;
   header->generated = 1;
   if ((!H2DMsg_WasError && H2DCfg_GenerateMacrosFile)
                && !X2C_CALL(adt_IsEmpty_0,X2C_GET_TD(header->Macros),
                3)(header->Macros)) GenMacroFiles(header);
   EraseTrace();
} /* end StartGenerate() */

static void RemoveFILE(FILE0 *);

static void RemoveNamedElementsList(adt_List *);

static void RemoveGeneratedTypeTree(adt_Tree *);


extern void H2DGen_Generate(H2DObjs_Header header)
{
   X2C_BOOLEAN done;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   StartGenerate(header);
   if (H2DMsg_WasError) {
      if (StdDefFile && StdDefFile->created) {
         OutFile = StdDefFile;
         CloseFile();
         anonym = StdDefFile->name;
         H2DFile_Delete(anonym->Adr, anonym->Len0, &done);
      }
      if (H2DCfg_GenerateMacrosFile) {
         if (MacroDefFile && MacroDefFile->created) {
            OutFile = MacroDefFile;
            CloseFile();
            anonym0 = MacroDefFile->name;
            H2DFile_Delete(anonym0->Adr, anonym0->Len0, &done);
         }
         if (MacroModFile && MacroModFile->created) {
            OutFile = MacroModFile;
            CloseFile();
            anonym1 = MacroModFile->name;
            H2DFile_Delete(anonym1->Adr, anonym1->Len0, &done);
         }
      }
   }
   CloseFile();
   CloseHFile();
   RemoveGeneratedTypeTree(&GeneratedTypes);
   RemoveBaseTypesStorage();
   RemoveNamedElementsList(&AdtImport);
   RemoveNamedElementsList(&Import);
   RemoveFILE(&OutFile);
   StdDefFile = 0;
   MacroDefFile = 0;
   MacroModFile = 0;
   adt_Deallocate((adt_Element)WriteBuffer);
} /* end Generate() */

static void ValueHandler(H2DObjs_TypedObject, LongStrs_String *);


static void ValueHandler(H2DObjs_TypedObject tobj, LongStrs_String * str)
{
   LongStrs_String anonym = 0;
   if ((OutFile && ValueHandlerOn) && tobj->obj==2001L) GenConstant(tobj);
   if (OutFile==0) {
      anonym = tobj->name;
      LongStrs_Assign(anonym->Adr, anonym->Len0, str);
   }
   else {
      LongStrs_Assign("", 1ul, str);
      MakeQualident((H2DObjs_Object)tobj, str);
   }
} /* end ValueHandler() */


static void RemoveGeneratedTypeTree(adt_Tree * tree)
{
   adt_Element e = 0;
   if (*tree) {
      X2C_CALL(adt_FindFirst_,X2C_GET_TD(*tree),6)(*tree, &e);
      while (e) {
         Deallocate(e);
         X2C_CALL(adt_FindNext_,X2C_GET_TD(*tree),8)(*tree, &e);
      }
      adt_Deallocate((adt_Element)*tree);
      *tree = 0;
   }
} /* end RemoveGeneratedTypeTree() */


static void RemoveNamedElementsList(adt_List * l)
{
   adt_Element e = 0;
   if (*l) {
      X2C_CALL(adt_FindFirst_0,X2C_GET_TD(*l),6)(*l, &e);
      while (e) {
         LongStrs_Deallocate(&((adt_NamedElement)e)->name);
         X2C_CALL(adt_FindNext_0,X2C_GET_TD(*l),8)(*l, &e);
      }
      adt_Deallocate((adt_Element)*l);
      *l = 0;
   }
} /* end RemoveNamedElementsList() */


static void RemoveFILE(FILE0 * f)
{
   adt_Element e = 0;
   if (*f) {
      LongStrs_Deallocate(&(*f)->path);
      LongStrs_Deallocate(&(*f)->name);
      LongStrs_Deallocate(&(*f)->modname);
      if ((*f)->creatednames) {
         X2C_CALL(adt_FindFirst_,X2C_GET_TD((*f)->creatednames),
                6)((*f)->creatednames, &e);
         while (e) {
            if (X2C_GET_TD(e)->base[3]==&H2DObjs_TypeDesc_desc) {
               H2DObjs_Deallocate((adt_Element)e);
            }
            else if (X2C_GET_TD(e)->base[1]==&adt_NamedElementDesc_desc) {
               adt_Deallocate((adt_Element)e);
            }
            X2C_CALL(adt_FindNext_,X2C_GET_TD((*f)->creatednames),
                8)((*f)->creatednames, &e);
         }
         adt_Deallocate((adt_Element)(*f)->creatednames);
      }
      *f = 0;
   }
} /* end RemoveFILE() */


static void RemoveOutStringsBuffer(adt_List * b)
{
   adt_Element e = 0;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(*b),6)(*b, &e);
   while (e) {
      if (X2C_GET_TD(e)->base[1]==&H2DGen_OutStringDesc_desc) {
         Deallocate((adt_Element)e);
      }
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(*b),8)(*b, &e);
   }
   adt_Deallocate((adt_Element)*b);
   *b = 0;
} /* end RemoveOutStringsBuffer() */


static void * H2DGen_offs[] = {
   &ModuleSystem,
   &OutFile,
   &HFile0,
   &StdDefFile,
   &MacroDefFile,
   &MacroModFile,
   &divideCharsForProcedure,
   &nothingDivideChars,
   &stdDivideChars,
   &emptyString,
   &GeneratedTypes,
   &NameOfGeneratedType,
   &declaration_without_definition,
   &simple_comment,
   &Modula2KeyWords,
   &Import,
   &AdtImport,
   &TagDefinedInOtherHeader,
   &ListForExtractNamedTypes,
   &WriteBuffer,
   &null,
   &BlankString,
   &GeneratedTypeStorage,
   &OutStringStorage,
   &PrintStringStorage,
   &BaseTypesStorage,
   X2C_OFS_END
};
static X2C_PROC H2DGen_cmds[] = { 0 };
static X2C_CHAR * H2DGen_cnms[] = { 0 };
struct X2C_MD_STR H2DGen_desc = {
  0, 0, "H2DGen",H2DGen_offs,H2DGen_cmds,H2DGen_cnms,
                &H2DGen_PrintStringDesc_desc
};

extern void H2DGen_BEGIN(void)
{
   static int H2DGen_init = 0;
   if (H2DGen_init) return;
   H2DGen_init = 1;
   H2DFile_BEGIN();
   H2DMsg_BEGIN();
   H2DCfg_BEGIN();
   LongStrs_BEGIN();
   H2DObjs_BEGIN();
   SysClock_BEGIN();
   WholeConv_BEGIN();
   Strings_BEGIN();
   WholeStr_BEGIN();
   adt_BEGIN();
   Printf_BEGIN();
   X2C_MODULE(&H2DGen_desc);
   null = 0;
   WriteStrLn = (void ( *)(X2C_CHAR [], X2C_CARD32, LongStrs_String *,
                X2C_INT32, X2C_INT32))WriteStrLn2File;
   WriteStr = (void ( *)(X2C_CHAR [], X2C_CARD32, LongStrs_String *,
                X2C_INT32, X2C_INT32))WriteStr2File;
   adt_NewList(&ListForExtractNamedTypes);
   H2DObjs_ValueHandler = ValueHandler;
   adt_NewList(&BaseTypesStorage);
   adt_NewList(&GeneratedTypeStorage);
   adt_NewList(&OutStringStorage);
   adt_NewList(&PrintStringStorage);
   BlankString = 0;
   LongStrs_Assign("", 1ul, &emptyString);
   HFile0 = 0;
   OutFile = 0;
   ValueHandlerOn = 0;
   if (H2DCfg_MaxStrLen>=0L) H2DFile_SizeOutputLine = H2DCfg_MaxStrLen;
   if (H2DCfg_CommentPosition<0L) comment_position = 0L;
   else comment_position = H2DCfg_CommentPosition;
   H2DObjs_NewHeader("SYSTEM", 7ul, &ModuleSystem);
   SetStdDivideChars();
   SetNothingdDivideChars();
   SetDivideCharsForProcedure();
   SetModula2KeyWords();
   H2DObjs_NewComment(&declaration_without_definition, -4L, "Declaration with\
out definition", 31ul);
   H2DObjs_NewComment(&simple_comment, -4L, "", 1ul);
}

