/* "@(#)H2DParse.c Nov  7 22:56:04 2022" */
/* Generated by XDS Oberon-2 to ANSI C v4.20 translator */

#define X2C_int32
#define X2C_index32
#ifndef H2DParse_H_
#include "H2DParse.h"
#endif
#define H2DParse_C_
#ifndef Printf_H_
#include "Printf.h"
#endif
#ifndef WholeStr_H_
#include "WholeStr.h"
#endif
#ifndef ConvTypes_H_
#include "ConvTypes.h"
#endif
#ifndef RegComp_H_
#include "RegComp.h"
#endif
#ifndef H2DMsg_H_
#include "H2DMsg.h"
#endif
#ifndef LongStrs_H_
#include "LongStrs.h"
#endif
#ifndef adt_H_
#include "adt.h"
#endif
#ifndef H2DFile_H_
#include "H2DFile.h"
#endif
#ifndef Strings_H_
#include "Strings.h"
#endif
#ifndef H2DCfg_H_
#include "H2DCfg.h"
#endif
#ifndef H2DObjs_H_
#include "H2DObjs.h"
#endif
#ifndef H2DScan_H_
#include "H2DScan.h"
#endif

extern struct X2C_MD_STR H2DParse_desc;
#define H2DParse_min_binary_operation_ 9

struct H2DParse_HeaderStackElementDes;
extern struct X2C_TD_STR H2DParse_HeaderStackElementDe0;

typedef struct H2DParse_HeaderStackElementDes * HeaderStackElement;


struct H2DParse_HeaderStackElementDes {
   X2C_INT32 _dummy_;
   H2DObjs_Header header;
   adt_List token_list0;
   H2DScan_Token current_token0;
   X2C_INT32 scan_token0;
   LongStrs_String scan_text0;
   X2C_BOOLEAN tag_was_parsed0;
   X2C_INT32 if_balance0;
   adt_Stack if_stack0;
   X2C_INT32 end_balance0;
   X2C_BOOLEAN limited_constant_expression_o0;
   X2C_INT32 include_balance0;
   X2C_BOOLEAN transparent_numeration;
   X2C_BOOLEAN C_extensions0;
};
static X2C_PROC H2DParse_HeaderStackElementDe2[] = {
   (X2C_PROC)adt_Compare
};
static void * H2DParse_HeaderStackElementDe1[] = {
   X2C_OFS(struct H2DParse_HeaderStackElementDes,header),
   X2C_OFS(struct H2DParse_HeaderStackElementDes,token_list0),
   X2C_OFS(struct H2DParse_HeaderStackElementDes,current_token0),
   X2C_OFS(struct H2DParse_HeaderStackElementDes,scan_text0),
   X2C_OFS(struct H2DParse_HeaderStackElementDes,if_stack0),
   X2C_OFS_END
};
struct X2C_TD_STR H2DParse_HeaderStackElementDe0 = {
   sizeof(struct H2DParse_HeaderStackElementDes), "HeaderStackElementDesc",
   &H2DParse_desc, 0, 1, 1,
   { &adt_ElementDesc_desc, &H2DParse_HeaderStackElementDe0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0 },
   H2DParse_HeaderStackElementDe2, H2DParse_HeaderStackElementDe1, 0, 0, 0,
                &H2DParse_HeaderStackElementDe0, 0x93678150lu
};

struct H2DParse_RegExprDesc;
extern struct X2C_TD_STR H2DParse_RegExprDesc_desc;

typedef struct H2DParse_RegExprDesc * RegExpr;


struct H2DParse_RegExprDesc {
   X2C_INT32 _dummy_;
   RegComp_Expr expr;
};
static X2C_PROC H2DParse_RegExprDesc_proc[] = {
   (X2C_PROC)adt_Compare
};
static void * H2DParse_RegExprDesc_offs[] = {
   X2C_OFS(struct H2DParse_RegExprDesc,expr),
   X2C_OFS_END
};
struct X2C_TD_STR H2DParse_RegExprDesc_desc = {
   sizeof(struct H2DParse_RegExprDesc), "RegExprDesc",
   &H2DParse_desc, &H2DParse_HeaderStackElementDe0, 1, 1,
   { &adt_ElementDesc_desc, &H2DParse_RegExprDesc_desc, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0 },
   H2DParse_RegExprDesc_proc, H2DParse_RegExprDesc_offs, 0, 0, 0,
                &H2DParse_RegExprDesc_desc, 0x93678150lu
};

struct H2DParse_PreTextDesc;
extern struct X2C_TD_STR H2DParse_PreTextDesc_desc;

typedef struct H2DParse_PreTextDesc * PreText;


struct H2DParse_PreTextDesc {
   X2C_INT32 _dummy_;
   adt_List patterns;
   adt_List exceptions;
   adt_List pretokens;
   adt_List posttokens;
};
static X2C_PROC H2DParse_PreTextDesc_proc[] = {
   (X2C_PROC)adt_Compare
};
static void * H2DParse_PreTextDesc_offs[] = {
   X2C_OFS(struct H2DParse_PreTextDesc,patterns),
   X2C_OFS(struct H2DParse_PreTextDesc,exceptions),
   X2C_OFS(struct H2DParse_PreTextDesc,pretokens),
   X2C_OFS(struct H2DParse_PreTextDesc,posttokens),
   X2C_OFS_END
};
struct X2C_TD_STR H2DParse_PreTextDesc_desc = {
   sizeof(struct H2DParse_PreTextDesc), "PreTextDesc",
   &H2DParse_desc, &H2DParse_RegExprDesc_desc, 1, 1,
   { &adt_ElementDesc_desc, &H2DParse_PreTextDesc_desc, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0 },
   H2DParse_PreTextDesc_proc, H2DParse_PreTextDesc_offs, 0, 0, 0,
                &H2DParse_PreTextDesc_desc, 0x93678150lu
};

struct H2DParse_DesignatorDesc;
extern struct X2C_TD_STR H2DParse_DesignatorDesc_desc;

typedef struct H2DParse_DesignatorDesc * Designator;


struct H2DParse_DesignatorDesc {
   X2C_INT32 _dummy_;
   LongStrs_String name;
   X2C_INT32 designator;
   adt_List list;
   X2C_INT32 num;
   X2C_BOOLEAN var;
   X2C_BOOLEAN array;
   LongStrs_String type_name;
   X2C_INT32 line0;
   X2C_INT32 pos0;
   LongStrs_String file_name0;
};
static X2C_PROC H2DParse_DesignatorDesc_proc[] = {
   (X2C_PROC)adt_Compare0,
   (X2C_PROC)adt_SetName
};
static void * H2DParse_DesignatorDesc_offs[] = {
   X2C_OFS(struct H2DParse_DesignatorDesc,name),
   X2C_OFS(struct H2DParse_DesignatorDesc,list),
   X2C_OFS(struct H2DParse_DesignatorDesc,type_name),
   X2C_OFS(struct H2DParse_DesignatorDesc,file_name0),
   X2C_OFS_END
};
struct X2C_TD_STR H2DParse_DesignatorDesc_desc = {
   sizeof(struct H2DParse_DesignatorDesc), "DesignatorDesc",
   &H2DParse_desc, &H2DParse_PreTextDesc_desc, 2, 2,
   { &adt_ElementDesc_desc, &adt_NamedElementDesc_desc,
                &H2DParse_DesignatorDesc_desc, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0 },
   H2DParse_DesignatorDesc_proc, H2DParse_DesignatorDesc_offs, 0, 0, 0,
                &H2DParse_DesignatorDesc_desc, 0x93678150lu
};

static X2C_BOOLEAN is_it_preheader;

static adt_List prepretext_list;

static adt_Stack headers_stack;

static adt_List token_list;

static adt_List empty_token_list;

static H2DScan_Token current_token;

static X2C_INT32 scan_token;

static LongStrs_String scan_text;

static X2C_INT32 if_balance;

static adt_Stack if_stack;

static X2C_INT32 end_balance;

static H2DObjs_Comment0 declaration_without_definition;

static X2C_BOOLEAN tag_was_parsed;

static X2C_BOOLEAN limited_constant_expression_on;

static X2C_INT32 binary_operations_priority[10][4];

static X2C_BOOLEAN was_sizeof;

static X2C_INT32 header_balance;

static X2C_INT32 include_balance;

static X2C_INT32 line;

static X2C_INT32 pos;

static LongStrs_String file_name;

static X2C_BOOLEAN redefined_macro;

static adt_List current_list_for_comments;

static adt_Tree merge_headers_tree;

static adt_Tree project_merge_headers_tree;

static adt_List pretext_list;

static adt_Stack comments_lists_stack;

static adt_Stack merged_headers_stack;

static X2C_BOOLEAN C_extensions;

static X2C_BOOLEAN config_on;

static X2C_BOOLEAN project_on;

static H2DObjs_Header config_project;

static LongStrs_String emptyString;

static H2DScan_Token emptyToken;

static adt_Tree FileNameTree;

static H2DObjs_Header HeadHeader;


static void SetFileName(LongStrs_String * str, LongStrs_String name)
{
   adt_Element e = 0;
   adt_NamedElement ne = 0;
   if (name==0) LongStrs_Assign("JOPPA", 6ul, &name);
   adt_NewNamedElement(&ne, name->Adr, name->Len0);
   X2C_CALL(adt_Find_,X2C_GET_TD(FileNameTree),12)(FileNameTree,
                (adt_Element)ne, &e);
   if (e==0) {
      X2C_CALL(adt_Insert_,X2C_GET_TD(FileNameTree),11)(FileNameTree,
                (adt_Element)ne);
   }
   else {
      adt_Deallocate((adt_Element)ne);
      ne = (adt_NamedElement)e;
   }
   *str = ne->name;
   if (X2C_STRCMP(name->Adr,name->Len0,"JOPPA",6u)==0) {
      LongStrs_Deallocate(&name);
   }
} /* end SetFileName() */


static void Error(X2C_INT32 number, X2C_LOC x[], X2C_CARD32 x_len)
{
   X2C_CALL(H2DMsg_Error_,X2C_GET_TD(H2DObjs_CurrentHeader->stat),
                3)(H2DObjs_CurrentHeader->stat, number, file_name->Adr,
                file_name->Len0, line, pos+1L, x, x_len);
   H2DScan_Close();
} /* end Error() */


static X2C_BOOLEAN Open(const X2C_CHAR name[], X2C_CARD32 name_len,
                X2C_BOOLEAN gen_error)
{
   X2C_SEQ tmp[3];
   if (H2DScan_Open(name, name_len)) return 1;
   if (gen_error) {
      Error(6L, (tmp[0].adr = name, tmp[1].val = 0, tmp[2].val = name_len-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
   }
   return 0;
} /* end Open() */


static void get_token(H2DScan_Token * t)
{
   adt_Element e = 0;
   if (*t==0) {
      X2C_CALL(adt_FindFirst_0,X2C_GET_TD(empty_token_list),
                6)(empty_token_list, &e);
      if (e) {
         *t = (H2DScan_Token)e;
         X2C_CALL(adt_DeleteCurrent_,X2C_GET_TD(empty_token_list),
                3)(empty_token_list);
      }
   }
   H2DScan_NewToken(t);
} /* end get_token() */


static void DesignatorPresentError(Designator d)
{
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   X2C_SEQ tmp[3];
   line = d->line0;
   pos = d->pos0;
   anonym = d->file_name0;
   LongStrs_Assign(anonym->Adr, anonym->Len0, &file_name);
   anonym0 = d->name;
   Error(56L, (tmp[0].adr = anonym0->Adr, tmp[1].val = 0,
                tmp[2].val = anonym0->Len0*1u-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
} /* end DesignatorPresentError() */


static void DesignatorError(Designator d, X2C_INT32 errcode)
{
   LongStrs_String anonym = 0;
   X2C_SEQ tmp[3];
   line = d->line0;
   pos = d->pos0;
   anonym = d->file_name0;
   LongStrs_Assign(anonym->Adr, anonym->Len0, &file_name);
   Error(errcode, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
} /* end DesignatorError() */


static void SkipSynonym(H2DObjs_Type * type)
{
   while ((*type)->base && (*type)->base->type==1003L) *type = (*type)->base;
} /* end SkipSynonym() */


static void GetObject(Designator d, H2DObjs_Type * type,
                H2DObjs_TypedObject * tobj, X2C_BOOLEAN err_flag)
{
   adt_Element e2 = 0;
   adt_Element e1 = 0;
   X2C_INT32 i;
   X2C_CALL(adt_Find_0,X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                11)(H2DObjs_CurrentHeader->objects, (adt_Element)d, &e1);
   *tobj = 0;
   *type = 0;
   if (e1==0) {
      if (err_flag) DesignatorPresentError(d);
      return;
   }
   if (X2C_GET_TD(e1)->base[3]==&H2DObjs_TypedObjectDesc_desc) {
      *tobj = (H2DObjs_TypedObject)e1;
      if ((*tobj)->type) {
         *type = (*tobj)->type;
         SkipSynonym(type);
         if ((*tobj)->type->type==1004L) *type = (*tobj)->type;
         else *type = 0;
      }
   }
   else if (X2C_GET_TD(e1)->base[3]==&H2DObjs_TypeDesc_desc) {
      *type = (H2DObjs_Type)e1;
   }
   if (*type || *tobj) {
      X2C_CALL(adt_FindFirst_0,X2C_GET_TD(d->list),6)(d->list, &e1);
      if (*tobj && (*tobj)->type==0) {
         if ((*tobj)->obj!=2001L || e1) DesignatorError((Designator)e1, 52L);
         return;
      }
      while (e1) {
         switch (((Designator)e1)->designator) {
         case 6024L:
            if (*tobj && (*tobj)->type->type==1000L) {
               *type = (*tobj)->type;
               *tobj = 0;
            }
            else if (*type) {
               SkipSynonym(type);
               if ((*type)->base && (*type)->base->type==1000L) {
                  *type = (*type)->base;
               }
               else {
                  DesignatorError((Designator)e1, 52L);
                  return;
               }
            }
            else {
               DesignatorError((Designator)e1, 52L);
               return;
            }
            if ((*type)->base && (*type)->base->type==1004L) {
               *type = (*type)->base;
            }
            break;
         case 6044L:
            if ((*tobj && (*tobj)->type->type==1001L)
                && LongStrs_Length1((*tobj)->type->name)==0L) {
               *type = (*tobj)->type;
            }
            else if (*type) {
               SkipSynonym(type);
               if ((*type)->base && (*type)->base->type==1001L) {
                  *type = (*type)->base;
               }
               else if ((*type)->type!=1001L || LongStrs_Length1((*type)
                ->name)<=0L) {
                  DesignatorError((Designator)e1, 52L);
                  return;
               }
            }
            else {
               DesignatorError((Designator)e1, 52L);
               return;
            }
            X2C_CALL(adt_FindNext_0,X2C_GET_TD(d->list),8)(d->list, &e1);
            X2C_CALL(adt_Find_0,X2C_GET_TD((*type)->vars),11)((*type)->vars,
                e1, &e2);
            while (e2 && X2C_GET_TD(e2)
                ->base[3]!=&H2DObjs_TypedObjectDesc_desc) {
               X2C_CALL(adt_FindAgain_,X2C_GET_TD((*type)->vars),
                10)((*type)->vars, &e2);
            }
            if (e2) {
               *tobj = (H2DObjs_TypedObject)e2;
               *type = 0;
            }
            else {
               DesignatorError((Designator)e1, 52L);
               return;
            }
            break;
         case 6006L:
            if (*type && (*type)->type==1004L) {
               X2C_CALL(adt_FindFirst_0,X2C_GET_TD((*type)->vars),
                6)((*type)->vars, &e2);
               i = 0L;
               for (;;) {
                  if (e2==0) {
                     DesignatorError((Designator)e1, 52L);
                     return;
                  }
                  if (X2C_GET_TD(e2)->base[3]==&H2DObjs_TypedObjectDesc_desc)
                 {
                     if (i==((Designator)e1)->num) break;
                     ++i;
                  }
                  X2C_CALL(adt_FindNext_0,X2C_GET_TD((*type)->vars),
                8)((*type)->vars, &e2);
               }
               *tobj = (H2DObjs_TypedObject)e2;
               *type = 0;
            }
            else {
               DesignatorError((Designator)e1, 52L);
               return;
            }
            break;
         case 6045L:
            if (*tobj && (*tobj)->type->type==1002L) {
               *type = (*tobj)->type;
               *tobj = 0;
            }
            else if (*type) {
               SkipSynonym(type);
               if ((*type)->base->type==1002L) *type = (*type)->base;
               else {
                  DesignatorError((Designator)e1, 52L);
                  return;
               }
            }
            else {
               DesignatorError((Designator)e1, 52L);
               return;
            }
            break;
         default:
            X2C_TRAP(X2C_CASE_TRAP);
         } /* end switch */
         X2C_CALL(adt_FindNext_0,X2C_GET_TD(d->list),8)(d->list, &e1);
      }
   }
   else {
      DesignatorError(d, 52L);
      return;
   }
} /* end GetObject() */


static void CheckParameters(void)
{
   H2DObjs_TypedObject tobj = 0;
   H2DObjs_Type type = 0;
   adt_Element e = 0;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(H2DObjs_CurrentHeader->Parameters),
                6)(H2DObjs_CurrentHeader->Parameters, &e);
   while (e) {
      GetObject((Designator)e, &type, &tobj, 1);
      if (H2DMsg_WasError) return;
      if (tobj->type->type==1000L) {
         tobj->var = ((Designator)e)->var;
         if (((Designator)e)->var && !((Designator)e)->array) {
            tobj->type = tobj->type->base;
         }
         if (((Designator)e)->array) tobj->type->type = 1002L;
      }
      else {
         DesignatorError((Designator)e, 52L);
         return;
      }
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(H2DObjs_CurrentHeader->Parameters),
                8)(H2DObjs_CurrentHeader->Parameters, &e);
   }
} /* end CheckParameters() */


static X2C_BOOLEAN IsBaseType(H2DObjs_Type type, X2C_INT32 * type_number)
{
   while (type->type==1003L) type = type->base;
   *type_number = type->type-0L;
   return X2C_IN(type->type,32,0x1FFFUL);
} /* end IsBaseType() */


static void CheckModifiedType(H2DObjs_M2Type m2Type, adt_NamedElement * ne,
                Designator d)
{
   X2C_INT32 i;
   adt_Element e = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   LongStrs_String anonym2 = 0;
   LongStrs_String anonym3 = 0;
   LongStrs_String anonym4 = 0;
   LongStrs_String anonym5 = 0;
   LongStrs_String anonym6 = 0;
   LongStrs_String anonym7 = 0;
   LongStrs_String anonym8 = 0;
   LongStrs_String anonym9 = 0;
   LongStrs_String anonym10 = 0;
   LongStrs_String anonym11 = 0;
   LongStrs_String anonym12 = 0;
   if (anonym = d->name,X2C_STRCMP(anonym->Adr,anonym->Len0,"ctype_signed_cha\
r",18u)==0) i = 0L;
   else if (anonym0 = d->name,X2C_STRCMP(anonym0->Adr,anonym0->Len0,"ctype_si\
gned_int",17u)==0) i = 1L;
   else if (anonym1 = d->name,X2C_STRCMP(anonym1->Adr,anonym1->Len0,"ctype_si\
gned_short_int",23u)==0) i = 2L;
   else if (anonym2 = d->name,X2C_STRCMP(anonym2->Adr,anonym2->Len0,"ctype_si\
gned_long_int",22u)==0) i = 3L;
   else if (anonym3 = d->name,X2C_STRCMP(anonym3->Adr,anonym3->Len0,"ctype_un\
signed_char",20u)==0) i = 4L;
   else if (anonym4 = d->name,X2C_STRCMP(anonym4->Adr,anonym4->Len0,"ctype_un\
signed_int",19u)==0) i = 5L;
   else if (anonym5 = d->name,X2C_STRCMP(anonym5->Adr,anonym5->Len0,"ctype_un\
signed_short_int",25u)==0) i = 6L;
   else if (anonym6 = d->name,X2C_STRCMP(anonym6->Adr,anonym6->Len0,"ctype_un\
signed_long_int",24u)==0) i = 7L;
   else if (anonym7 = d->name,X2C_STRCMP(anonym7->Adr,anonym7->Len0,"ctype_fl\
oat",12u)==0) i = 8L;
   else if (anonym8 = d->name,X2C_STRCMP(anonym8->Adr,anonym8->Len0,"ctype_do\
uble",13u)==0) i = 9L;
   else if (anonym9 = d->name,X2C_STRCMP(anonym9->Adr,anonym9->Len0,"ctype_lo\
ng_float",17u)==0) i = 10L;
   else if (anonym10 = d->name,X2C_STRCMP(anonym10->Adr,anonym10->Len0,"ctype\
_long_double",18u)==0) i = 11L;
   else {
      anonym11 = d->name;
      adt_NewNamedElement(ne, anonym11->Adr, anonym11->Len0);
      X2C_CALL(adt_Find_,X2C_GET_TD(H2DObjs_CurrentHeader->Names),
                12)(H2DObjs_CurrentHeader->Names, (adt_Element)*ne, &e);
      if (((e && X2C_GET_TD(e)->base[3]==&H2DObjs_TypeDesc_desc)
                && IsBaseType((H2DObjs_Type)e,
                &i)) && H2DCfg_IsValidVariant(i, m2Type->type_size)) {
         ((H2DObjs_Type)e)->translation_variant = m2Type;
      }
      else DesignatorError(d, 52L);
      return;
   }
   anonym12 = d->type_name;
   H2DCfg_SetBaseType(i+0L, anonym12->Adr, anonym12->Len0, -1L);
} /* end CheckModifiedType() */


static void CheckModifiedObjects(void)
{
   H2DObjs_TypedObject tobj = 0;
   H2DObjs_Type type = 0;
   adt_Element e = 0;
   adt_NamedElement ne = 0;
   Designator d = 0;
   X2C_INT32 i;
   H2DObjs_M2Type m2Type = 0;
   LongStrs_String anonym = 0;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(H2DObjs_CurrentHeader->ModifiedObjects),
                6)(H2DObjs_CurrentHeader->ModifiedObjects, &e);
   while (e) {
      d = (Designator)e;
      anonym = d->type_name;
      adt_NewNamedElement(&ne, anonym->Adr, anonym->Len0);
      X2C_CALL(adt_Find_,X2C_GET_TD(H2DObjs_M2Types),12)(H2DObjs_M2Types,
                (adt_Element)ne, &e);
      if (e) m2Type = (H2DObjs_M2Type)e;
      else {
         DesignatorError(d, 52L);
         return;
      }
      GetObject(d, &type, &tobj, 0);
      if (H2DMsg_WasError) return;
      if (tobj) {
         if (tobj->obj==2000L) {
            type = tobj->type;
            SkipSynonym(&type);
            if (type->type==1004L) type = tobj->type->base;
            else type = tobj->type;
            if (!(IsBaseType(type, &i) && H2DCfg_IsValidVariant(i,
                m2Type->type_size))) {
               DesignatorError(d, 52L);
               return;
            }
         }
         tobj->type_name = m2Type;
      }
      else if (X2C_CALL(adt_IsEmpty_1,X2C_GET_TD(d->list),4)(d->list)) {
         CheckModifiedType(m2Type, &ne, d);
      }
      else {
         DesignatorError(d, 52L);
         return;
      }
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(H2DObjs_CurrentHeader->ModifiedObjects),
                8)(H2DObjs_CurrentHeader->ModifiedObjects, &e);
   }
} /* end CheckModifiedObjects() */


static void NewDesignator(Designator * designator, const X2C_CHAR name[],
                X2C_CARD32 name_len, X2C_INT32 des)
{
   X2C_NEW(&H2DParse_DesignatorDesc_desc,(X2C_ADDRESS*)designator,
                sizeof(struct H2DParse_DesignatorDesc),0);
   X2C_CALL(adt_SetName_,X2C_GET_TD(*designator),
                1)((adt_NamedElement)*designator, name, name_len);
   adt_NewList(&(*designator)->list);
   (*designator)->designator = des;
   (*designator)->line0 = line;
   (*designator)->pos0 = pos;
   (*designator)->var = 0;
   (*designator)->array = 0;
   LongStrs_Assign(file_name->Adr, file_name->Len0,
                &(*designator)->file_name0);
} /* end NewDesignator() */


static void PushCommentsList(adt_List l)
{
   X2C_CALL(adt_Push_,X2C_GET_TD(comments_lists_stack),
                3)(comments_lists_stack,
                (adt_Element)current_list_for_comments);
   current_list_for_comments = l;
} /* end PushCommentsList() */


static void PopCommentsList(void)
{
   adt_Element e = 0;
   X2C_CALL(adt_Pop_,X2C_GET_TD(comments_lists_stack),
                2)(comments_lists_stack, &e);
   if (e) current_list_for_comments = (adt_List)e;
   else current_list_for_comments = 0;
} /* end PopCommentsList() */


static X2C_BOOLEAN check_params(adt_Element * e2, adt_Element * e1,
                adt_Element r1, adt_Element r2)
{
   adt_Element p2 = 0;
   adt_Element p1 = 0;
   adt_List anonym = 0;
   adt_List anonym0 = 0;
   LongStrs_String anonym1 = 0;
   LongStrs_String anonym2 = 0;
   LongStrs_String anonym3 = 0;
   LongStrs_String anonym4 = 0;
   adt_List anonym5 = 0;
   adt_List anonym6 = 0;
   if (X2C_GET_TD(r1)->base[2]==&H2DObjs_ReplacementDesc_desc) {
      if (X2C_GET_TD(r2)->base[2]==&H2DObjs_ReplacementDesc_desc) {
         anonym = ((H2DObjs_Replacement)r1)->params;
         X2C_CALL(adt_FindFirst_0,X2C_GET_TD(anonym),6)(anonym, &p1);
         anonym0 = ((H2DObjs_Replacement)r2)->params;
         X2C_CALL(adt_FindFirst_0,X2C_GET_TD(anonym0),6)(anonym0, &p2);
         while (p1 && p2) {
            if ((anonym1 = ((adt_NamedElement)p1)->name,
                (anonym2 = ((H2DScan_Token)*e1)->text,
                X2C_STRCMP(anonym1->Adr,anonym1->Len0,anonym2->Adr,
                anonym2->Len0)==0)) && (anonym3 = ((adt_NamedElement)p2)
                ->name,(anonym4 = ((H2DScan_Token)*e2)->text,
                X2C_STRCMP(anonym3->Adr,anonym3->Len0,anonym4->Adr,
                anonym4->Len0)==0))) return 1;
            anonym5 = ((H2DObjs_Replacement)r1)->params;
            X2C_CALL(adt_FindNext_0,X2C_GET_TD(anonym5),8)(anonym5, &p1);
            anonym6 = ((H2DObjs_Replacement)r2)->params;
            X2C_CALL(adt_FindNext_0,X2C_GET_TD(anonym6),8)(anonym6, &p2);
         }
         return 0;
      }
   }
   X2C_TRAP(X2C_RETURN_TRAP);
   return 0;
} /* end check_params() */


static X2C_BOOLEAN EquReplacements(adt_Element r1, adt_Element r2)
{
   adt_Element e2 = 0;
   adt_Element e1 = 0;
   adt_List anonym = 0;
   adt_List anonym0 = 0;
   adt_List anonym1 = 0;
   adt_List anonym2 = 0;
   LongStrs_String anonym3 = 0;
   LongStrs_String anonym4 = 0;
   adt_List anonym5 = 0;
   adt_List anonym6 = 0;
   adt_List anonym7 = 0;
   adt_List anonym8 = 0;
   adt_List anonym9 = 0;
   adt_List anonym10 = 0;
   LongStrs_String anonym11 = 0;
   LongStrs_String anonym12 = 0;
   adt_List anonym13 = 0;
   adt_List anonym14 = 0;
   if (X2C_GET_TD(r1)->base[2]==&H2DObjs_ReplacementDesc_desc) {
      if (X2C_GET_TD(r2)->base[2]==&H2DObjs_ReplacementDesc_desc) {
         if ((anonym = ((H2DObjs_Replacement)r1)->params,
                X2C_CALL(adt_IsEmpty_1,X2C_GET_TD(anonym),
                4)(anonym)) && (anonym0 = ((H2DObjs_Replacement)r2)->params,
                X2C_CALL(adt_IsEmpty_1,X2C_GET_TD(anonym0),4)(anonym0))) {
            anonym1 = ((H2DObjs_Replacement)r1)->tokens;
            X2C_CALL(adt_FindFirst_0,X2C_GET_TD(anonym1),6)(anonym1, &e1);
            anonym2 = ((H2DObjs_Replacement)r2)->tokens;
            X2C_CALL(adt_FindFirst_0,X2C_GET_TD(anonym2),6)(anonym2, &e2);
            while (e1 && e2) {
               if (((H2DScan_Token)e1)->token==((H2DScan_Token)e2)
                ->token && (anonym3 = ((H2DScan_Token)e1)->text,
                (anonym4 = ((H2DScan_Token)e2)->text,X2C_STRCMP(anonym3->Adr,
                anonym3->Len0,anonym4->Adr,anonym4->Len0)==0))) {
                  anonym5 = ((H2DObjs_Replacement)r1)->tokens;
                  X2C_CALL(adt_FindNext_0,X2C_GET_TD(anonym5),8)(anonym5,
                &e1);
                  anonym6 = ((H2DObjs_Replacement)r2)->tokens;
                  X2C_CALL(adt_FindNext_0,X2C_GET_TD(anonym6),8)(anonym6,
                &e2);
               }
               else return 0;
            }
            return e1==e2;
         }
         else if (!(anonym7 = ((H2DObjs_Replacement)r1)->params,
                X2C_CALL(adt_IsEmpty_1,X2C_GET_TD(anonym7),
                4)(anonym7)) && !(anonym8 = ((H2DObjs_Replacement)r2)
                ->params,X2C_CALL(adt_IsEmpty_1,X2C_GET_TD(anonym8),
                4)(anonym8))) {
            anonym9 = ((H2DObjs_Replacement)r1)->pattern;
            X2C_CALL(adt_FindFirst_0,X2C_GET_TD(anonym9),6)(anonym9, &e1);
            anonym10 = ((H2DObjs_Replacement)r2)->pattern;
            X2C_CALL(adt_FindFirst_0,X2C_GET_TD(anonym10),6)(anonym10, &e2);
            while (e1 && e2) {
               if (((H2DScan_Token)e1)->token==((H2DScan_Token)e2)
                ->token && (anonym11 = ((H2DScan_Token)e1)->text,
                (anonym12 = ((H2DScan_Token)e2)->text,
                X2C_STRCMP(anonym11->Adr,anonym11->Len0,anonym12->Adr,
                anonym12->Len0)==0)) || (((H2DScan_Token)e1)
                ->token==6001L && ((H2DScan_Token)e2)->token==6001L)
                && check_params(&e2, &e1, (adt_Element)r1, (adt_Element)r2)) {
                  anonym13 = ((H2DObjs_Replacement)r1)->tokens;
                  X2C_CALL(adt_FindNext_0,X2C_GET_TD(anonym13),8)(anonym13,
                &e1);
                  anonym14 = ((H2DObjs_Replacement)r2)->tokens;
                  X2C_CALL(adt_FindNext_0,X2C_GET_TD(anonym14),8)(anonym14,
                &e2);
               }
               else return 0;
            }
            return e1==e2;
         }
         else return 0;
      }
   }
   X2C_TRAP(X2C_RETURN_TRAP);
   return 0;
} /* end EquReplacements() */


static X2C_BOOLEAN EquTypedObjects(adt_Element tobj1, adt_Element tobj2)
{
   H2DObjs_ConstantValue res2 = 0;
   H2DObjs_ConstantValue res1 = 0;
   X2C_BOOLEAN equ;
   H2DObjs_Expression anonym = 0;
   H2DObjs_Expression anonym0 = 0;
   LongStrs_String anonym1 = 0;
   LongStrs_String anonym2 = 0;
   equ = 0;
   if (X2C_GET_TD(tobj1)->base[3]==&H2DObjs_TypedObjectDesc_desc) {
      if (X2C_GET_TD(tobj2)->base[3]==&H2DObjs_TypedObjectDesc_desc) {
         anonym = ((H2DObjs_TypedObject)tobj1)->expr;
         X2C_CALL(H2DObjs_ComputeExpression_,X2C_GET_TD(anonym),2)(anonym,
                &res1, 0);
         anonym0 = ((H2DObjs_TypedObject)tobj2)->expr;
         X2C_CALL(H2DObjs_ComputeExpression_,X2C_GET_TD(anonym0),2)(anonym0,
                &res2, 0);
         if (res1->type==res2->type) {
            switch (res1->type) {
            case 6072L:
               equ = res1->int0==res2->int0;
               break;
            case 6073L:
               equ = res1->uint==res2->uint;
               break;
            case 6076L:
               equ = res1->real==res2->real;
               break;
            case 6031L:
               equ = (anonym1 = res1->str,(anonym2 = res2->str,
                X2C_STRCMP(anonym1->Adr,anonym1->Len0,anonym2->Adr,
                anonym2->Len0)==0));
               break;
            default:
               X2C_TRAP(X2C_CASE_TRAP);
            } /* end switch */
         }
         H2DObjs_Deallocate((adt_Element)res1);
         H2DObjs_Deallocate((adt_Element)res2);
      }
   }
   return equ;
} /* end EquTypedObjects() */


static void InsertToNames(adt_NamedElement what,
                X2C_BOOLEAN check_extern_objects_identity)
{
   adt_Element e = 0;
   LongStrs_String str2 = 0;
   LongStrs_String str1 = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   LongStrs_String anonym2 = 0;
   X2C_SEQ tmp[7];
   if (redefined_macro) {
      X2C_CALL(adt_Insert_,X2C_GET_TD(H2DObjs_CurrentHeader->Names),
                11)(H2DObjs_CurrentHeader->Names, (adt_Element)what);
   }
   else {
      X2C_CALL(adt_Find_,X2C_GET_TD(H2DObjs_CurrentHeader->Names),
                12)(H2DObjs_CurrentHeader->Names, (adt_Element)what, &e);
      if (e==0) H2DObjs_FindInNames(HeadHeader, what, &e);
      if (e==0) {
         X2C_CALL(adt_Insert_,X2C_GET_TD(H2DObjs_CurrentHeader->Names),
                11)(H2DObjs_CurrentHeader->Names, (adt_Element)what);
      }
      else if ((check_extern_objects_identity && X2C_GET_TD(what)
                ->base[3]==&H2DObjs_TypedObjectDesc_desc) && X2C_GET_TD(e)
                ->base[3]==&H2DObjs_TypedObjectDesc_desc) {
         H2DObjs_TranslateTypeToString(((H2DObjs_TypedObject)what)->type,
                &str1);
         H2DObjs_TranslateTypeToString(((H2DObjs_TypedObject)e)->type,
                &str2);
         if ((X2C_STRCMP(str1->Adr,str1->Len0,str2->Adr,
                str2->Len0)==0 && ((H2DObjs_TypedObject)what)
                ->mem_class==5014L) && ((H2DObjs_TypedObject)e)
                ->mem_class==5014L) {
            X2C_CALL(adt_Insert_,X2C_GET_TD(H2DObjs_CurrentHeader->Names),
                11)(H2DObjs_CurrentHeader->Names, (adt_Element)what);
         }
         else {
            anonym0 = ((H2DObjs_Object)e)->file;
            anonym = what->name;
            Error(19L, (tmp[0].adr = anonym->Adr, tmp[1].val = 0,
                tmp[2].val = anonym->Len0*1u-1, tmp[3].adr = anonym0->Adr,
                tmp[4].val = 0, tmp[5].val = anonym0->Len0*1u-1,
                tmp[6].val = ((H2DObjs_Object)e)->line, (X2C_LOC *)tmp),
                7ul*sizeof(X2C_SEQ));
            return;
         }
      }
      else {
         anonym2 = ((H2DObjs_Object)e)->file;
         anonym1 = what->name;
         Error(19L, (tmp[0].adr = anonym1->Adr, tmp[1].val = 0,
                tmp[2].val = anonym1->Len0*1u-1, tmp[3].adr = anonym2->Adr,
                tmp[4].val = 0, tmp[5].val = anonym2->Len0*1u-1,
                tmp[6].val = ((H2DObjs_Object)e)->line, (X2C_LOC *)tmp),
                7ul*sizeof(X2C_SEQ));
         return;
      }
   }
} /* end InsertToNames() */


static void InsertToTags(adt_NamedElement what)
{
   adt_Element e = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   X2C_SEQ tmp[7];
   X2C_CALL(adt_Find_,X2C_GET_TD(H2DObjs_CurrentHeader->Tags),
                12)(H2DObjs_CurrentHeader->Tags, (adt_Element)what, &e);
   if (e==0) H2DObjs_FindInTags(HeadHeader, what, &e);
   if (e==0) {
      X2C_CALL(adt_Insert_,X2C_GET_TD(H2DObjs_CurrentHeader->Tags),
                11)(H2DObjs_CurrentHeader->Tags, (adt_Element)what);
   }
   else {
      anonym0 = ((H2DObjs_Object)e)->file;
      anonym = what->name;
      Error(19L, (tmp[0].adr = anonym->Adr, tmp[1].val = 0,
                tmp[2].val = anonym->Len0*1u-1, tmp[3].adr = anonym0->Adr,
                tmp[4].val = 0, tmp[5].val = anonym0->Len0*1u-1,
                tmp[6].val = ((H2DObjs_Object)e)->line, (X2C_LOC *)tmp),
                7ul*sizeof(X2C_SEQ));
      return;
   }
} /* end InsertToTags() */


static void InsertToDefined(adt_NamedElement what)
{
   adt_Element e = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   X2C_SEQ tmp[7];
   X2C_CALL(adt_Find_,X2C_GET_TD(H2DObjs_CurrentHeader->defined),
                12)(H2DObjs_CurrentHeader->defined, (adt_Element)what, &e);
   if (e==0) H2DObjs_FindInDefined(HeadHeader, what, &e);
   X2C_CALL(adt_Insert_,X2C_GET_TD(H2DObjs_CurrentHeader->defined),
                11)(H2DObjs_CurrentHeader->defined, (adt_Element)what);
   if (e==0) {
      redefined_macro = 0;
      return;
   }
   if (!((X2C_GET_TD(what)->base[2]==&H2DObjs_ReplacementDesc_desc && X2C_GET_TD(e)
                ->base[2]==&H2DObjs_ReplacementDesc_desc)
                && EquReplacements(e,
                (adt_Element)what) || (X2C_GET_TD(what)
                ->base[3]==&H2DObjs_TypedObjectDesc_desc && X2C_GET_TD(e)
                ->base[3]==&H2DObjs_TypedObjectDesc_desc)
                && EquTypedObjects(e, (adt_Element)what))) {
      anonym0 = ((H2DObjs_Object)e)->file;
      anonym = what->name;
      Error(19L, (tmp[0].adr = anonym->Adr, tmp[1].val = 0,
                tmp[2].val = anonym->Len0*1u-1, tmp[3].adr = anonym0->Adr,
                tmp[4].val = 0, tmp[5].val = anonym0->Len0*1u-1,
                tmp[6].val = ((H2DObjs_Object)e)->line, (X2C_LOC *)tmp),
                7ul*sizeof(X2C_SEQ));
   }
   redefined_macro = 1;
} /* end InsertToDefined() */


static void InsertToList(adt_List to, adt_NamedElement what)
{
   adt_Element e = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   X2C_SEQ tmp[7];
   X2C_CALL(adt_Find_0,X2C_GET_TD(to),11)(to, (adt_Element)what, &e);
   if (e==0 || LongStrs_Length1(what->name)==0L) {
      X2C_CALL(adt_Insert_0,X2C_GET_TD(to),14)(to, (adt_Element)what);
   }
   else {
      anonym0 = ((H2DObjs_Object)e)->file;
      anonym = what->name;
      Error(19L, (tmp[0].adr = anonym->Adr, tmp[1].val = 0,
                tmp[2].val = anonym->Len0*1u-1, tmp[3].adr = anonym0->Adr,
                tmp[4].val = 0, tmp[5].val = anonym0->Len0*1u-1,
                tmp[6].val = ((H2DObjs_Object)e)->line, (X2C_LOC *)tmp),
                7ul*sizeof(X2C_SEQ));
      return;
   }
} /* end InsertToList() */


static X2C_BOOLEAN IsType(H2DObjs_Type type, X2C_INT32 mode)
{
   while (type) {
      if (type->type==mode) return 1;
      if (type->type==1003L) type = type->base;
      else type = 0;
   }
   return 0;
} /* end IsType() */


static void ins_comments(adt_Element * e)
{
   adt_Element e2 = 0;
   adt_Element e1 = 0;
   adt_List anonym = 0;
   adt_List anonym0 = 0;
   anonym = ((H2DObjs_TypedObject)*e)->modifier;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(anonym),6)(anonym, &e1);
   while (e1) {
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                8)(H2DObjs_CurrentHeader->objects, &e2);
      X2C_CALL(adt_InsertAfterCurrent_,
                X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                13)(H2DObjs_CurrentHeader->objects, e1);
      anonym0 = ((H2DObjs_TypedObject)*e)->modifier;
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(anonym0),8)(anonym0, &e1);
   }
} /* end ins_comments() */


static void skip_comment_in_same_line(X2C_INT32 line0)
{
   adt_Element e1 = 0;
   do {
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                8)(H2DObjs_CurrentHeader->objects, &e1);
   } while (!((e1==0 || X2C_GET_TD(e1)->base[3]!=&H2DObjs_CommentDesc_desc) || ((H2DObjs_Object)e1)->line!=line0));
   if (e1==0) {
      X2C_CALL(adt_FindLast_0,X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                5)(H2DObjs_CurrentHeader->objects, &e1);
   }
   else {
      X2C_CALL(adt_FindPrev_0,X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                7)(H2DObjs_CurrentHeader->objects, &e1);
   }
} /* end skip_comment_in_same_line() */


static void InsertSynonyms(void)
{
   adt_Element found = 0;
   adt_Element e = 0;
   X2C_INT32 line0;
   H2DObjs_Type t_syn = 0;
   LongStrs_String anonym = 0;
   X2C_CALL(adt_FindFirst_,X2C_GET_TD(H2DObjs_CurrentHeader->Synonyms),
                6)(H2DObjs_CurrentHeader->Synonyms, &e);
   while (e) {
      X2C_CALL(adt_Find_0,X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                11)(H2DObjs_CurrentHeader->objects,
                (adt_Element)((H2DObjs_TypedObject)e)->type, &found);
      while (found && X2C_GET_TD(found)->base[3]==&H2DObjs_CommentDesc_desc) {
         X2C_CALL(adt_FindAgain_,X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                10)(H2DObjs_CurrentHeader->objects, &found);
      }
      ((H2DObjs_TypedObject)e)->back_end = 7002L;
      if (found) {
         line0 = ((H2DObjs_Object)found)->line;
         if (X2C_GET_TD(found)->base[3]==&H2DObjs_TypedObjectDesc_desc) {
            if (((H2DObjs_TypedObject)found)
                ->obj==2001L || IsType(((H2DObjs_TypedObject)found)->type,
                1004L)) {
               skip_comment_in_same_line(line0);
               X2C_CALL(adt_InsertAfterCurrent_,
                X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                13)(H2DObjs_CurrentHeader->objects, e);
               ins_comments(&e);
            }
         }
         else if (X2C_GET_TD(found)->base[3]==&H2DObjs_TypeDesc_desc) {
            if (((H2DObjs_Type)found)->type!=1003L || !IsType(((H2DObjs_Type)
                found)->base, 1004L)) {
               H2DObjs_NewType(&t_syn);
               t_syn->type = 1003L;
               anonym = ((adt_NamedElement)e)->name;
               X2C_CALL(adt_SetName_,X2C_GET_TD(t_syn),
                1)((adt_NamedElement)t_syn, anonym->Adr, anonym->Len0);
               t_syn->line = ((H2DObjs_Object)e)->line;
               SetFileName(&t_syn->file, ((H2DObjs_Object)e)->file);
               t_syn->base = (H2DObjs_Type)found;
               skip_comment_in_same_line(line0);
               InsertToNames((adt_NamedElement)t_syn, 0);
               if (H2DMsg_WasError) return;
               X2C_CALL(adt_InsertAfterCurrent_,
                X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                13)(H2DObjs_CurrentHeader->objects, (adt_Element)t_syn);
               ins_comments(&e);
            }
         }
         else if (X2C_GET_TD(found)->base[3]==&H2DObjs_MacroDesc_desc) {
            ((H2DObjs_TypedObject)e)->back_end = 7102L;
            X2C_CALL(adt_InsertAfterCurrent_,
                X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                13)(H2DObjs_CurrentHeader->objects, e);
            ins_comments(&e);
         }
      }
      else {
         H2DObjs_FindInNames(H2DObjs_CurrentHeader,
                (adt_NamedElement)((H2DObjs_TypedObject)e)->type, &found);
         if ((found && X2C_GET_TD(found)
                ->base[3]==&H2DObjs_TypedObjectDesc_desc)
                && ((H2DObjs_TypedObject)found)->obj==2004L) {
            line0 = ((H2DObjs_Object)found)->line;
            if (LongStrs_Length1(((H2DObjs_TypedObject)found)->type->name)
                >0L) {
               X2C_CALL(adt_Find_0,
                X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                11)(H2DObjs_CurrentHeader->objects,
                (adt_Element)((H2DObjs_TypedObject)found)->type, &found);
               while (found && X2C_GET_TD(found)
                ->base[3]==&H2DObjs_CommentDesc_desc) {
                  X2C_CALL(adt_FindAgain_,
                X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                10)(H2DObjs_CurrentHeader->objects, &found);
               }
            }
            else {
               X2C_CALL(adt_FindLast_0,
                X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                5)(H2DObjs_CurrentHeader->objects, &found);
            }
            skip_comment_in_same_line(line0);
            X2C_CALL(adt_InsertAfterCurrent_,
                X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                13)(H2DObjs_CurrentHeader->objects, e);
            ins_comments(&e);
         }
      }
      X2C_CALL(adt_FindNext_,X2C_GET_TD(H2DObjs_CurrentHeader->Synonyms),
                8)(H2DObjs_CurrentHeader->Synonyms, &e);
   }
} /* end InsertSynonyms() */


static void merge_trees(adt_Tree to, adt_Tree from)
{
   adt_Element e = 0;
   X2C_CALL(adt_FindFirst_,X2C_GET_TD(from),6)(from, &e);
   while (e) {
      X2C_CALL(adt_Insert_,X2C_GET_TD(to),11)(to, e);
      X2C_CALL(adt_FindNext_,X2C_GET_TD(from),8)(from, &e);
   }
} /* end merge_trees() */


static void merge_lists(adt_List to, adt_List from, X2C_BOOLEAN unique)
{
   adt_Element e1 = 0;
   adt_Element e = 0;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(from),6)(from, &e);
   while (e) {
      e1 = 0;
      if (unique) X2C_CALL(adt_Find_0,X2C_GET_TD(to),11)(to, e, &e1);
      if (e1==0) X2C_CALL(adt_Insert_0,X2C_GET_TD(to),14)(to, e);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(from),8)(from, &e);
   }
} /* end merge_lists() */


static void merge_include_lists(adt_List to, adt_List from)
{
   adt_Element e1 = 0;
   adt_Element e = 0;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(from),6)(from, &e);
   while (e) {
      X2C_CALL(adt_Find_0,X2C_GET_TD(to),11)(to, e, &e1);
      if (e1==0) X2C_CALL(adt_Insert_0,X2C_GET_TD(to),14)(to, e);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(from),8)(from, &e);
   }
} /* end merge_include_lists() */


static void merge_headers(H2DObjs_Header to, H2DObjs_Header from,
                X2C_BOOLEAN insert_to_includes,
                X2C_BOOLEAN merge_trees_flag)
{
   adt_Element e = 0;
   if (merge_trees_flag) {
      merge_trees(to->Replacements, from->Replacements);
      merge_trees(to->Tags, from->Tags);
      merge_trees(to->Names, from->Names);
      merge_trees(to->defined, from->defined);
   }
   X2C_CALL(adt_Find_0,X2C_GET_TD(to->includes),11)(to->includes,
                (adt_Element)from, &e);
   if (insert_to_includes && e==0) {
      X2C_CALL(adt_Insert_0,X2C_GET_TD(to->includes),14)(to->includes,
                (adt_Element)from);
   }
   merge_include_lists(to->includes, from->includes);
} /* end merge_headers() */


static void CopyToken(H2DScan_Token * tok, H2DScan_Token pattr)
{
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   *tok = 0;
   get_token(tok);
   (*tok)->token = pattr->token;
   anonym = pattr->text;
   LongStrs_Assign(anonym->Adr, anonym->Len0, &(*tok)->text);
   anonym0 = pattr->original_text;
   LongStrs_Assign(anonym0->Adr, anonym0->Len0, &(*tok)->original_text);
   (*tok)->parsed = 0;
   (*tok)->boundary = 0;
   (*tok)->line0 = pattr->line0;
   (*tok)->pos0 = pattr->pos0;
   anonym1 = pattr->file;
   LongStrs_Assign(anonym1->Adr, anonym1->Len0, &(*tok)->file);
   (*tok)->pretoken = 0;
} /* end CopyToken() */


static void PutPreText(const X2C_CHAR name[], X2C_CARD32 name_len)
{
   adt_Element e1 = 0;
   adt_Element e = 0;
   PreText pretext = 0;
   H2DScan_Token t = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   adt_NewList(&token_list);
   t = 0;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(pretext_list),6)(pretext_list, &e);
   while (e) {
      pretext = (PreText)e;
      X2C_CALL(adt_FindFirst_0,X2C_GET_TD(pretext->patterns),
                6)(pretext->patterns, &e1);
      while (e1) {
         if (RegComp_Match(((RegExpr)e1)->expr, name, name_len, 0L)) {
            X2C_CALL(adt_FindFirst_0,X2C_GET_TD(pretext->exceptions),
                6)(pretext->exceptions, &e1);
            while (e1) {
               if (RegComp_Match(((RegExpr)e1)->expr, name, name_len, 0L)) {
                  pretext = 0;
                  e1 = 0;
               }
               else {
                  X2C_CALL(adt_FindNext_0,X2C_GET_TD(pretext->exceptions),
                8)(pretext->exceptions, &e1);
               }
            }
            if (pretext) {
               X2C_CALL(adt_FindFirst_0,X2C_GET_TD(pretext->pretokens),
                6)(pretext->pretokens, &e);
               while (e) {
                  if (X2C_GET_TD(e)->base[1]==&H2DScan_TokenDesc_desc) {
                     CopyToken(&t, (H2DScan_Token)e);
                  }
                  else if (X2C_GET_TD(e)->base[3]==&H2DObjs_CommentDesc_desc)
                 {
                     X2C_NEW(&H2DScan_TokenDesc_desc,(X2C_ADDRESS*) &t,
                sizeof(struct H2DScan_TokenDesc),0);
                     anonym = ((H2DObjs_Comment0)e)->header->name;
                     LongStrs_Assign(anonym->Adr, anonym->Len0, &t->file);
                     anonym0 = ((H2DObjs_Comment0)e)->name;
                     LongStrs_Assign(anonym0->Adr, anonym0->Len0, &t->text);
                     t->line0 = ((H2DObjs_Comment0)e)->line;
                     t->token = 6065L;
                     t->parsed = 0;
                  }
                  t->pretoken = 1;
                  X2C_CALL(adt_Insert_0,X2C_GET_TD(token_list),
                14)(token_list, (adt_Element)t);
                  X2C_CALL(adt_FindNext_0,X2C_GET_TD(pretext->pretokens),
                8)(pretext->pretokens, &e);
               }
            }
            e1 = 0;
         }
         else {
            X2C_CALL(adt_FindNext_0,X2C_GET_TD(pretext->patterns),
                8)(pretext->patterns, &e1);
         }
      }
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(pretext_list),8)(pretext_list, &e);
   }
   X2C_CALL(adt_Reset_,X2C_GET_TD(token_list),9)(token_list);
} /* end PutPreText() */


static adt_Element PutPostText(const X2C_CHAR name[], X2C_CARD32 name_len)
{
   adt_Element e1 = 0;
   adt_Element e = 0;
   adt_Element ft = 0;
   PreText pretext = 0;
   H2DScan_Token t = 0;
   X2C_BOOLEAN first_token;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   first_token = 1;
   ft = 0;
   t = 0;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(pretext_list),6)(pretext_list, &e);
   while (e) {
      pretext = (PreText)e;
      X2C_CALL(adt_FindFirst_0,X2C_GET_TD(pretext->patterns),
                6)(pretext->patterns, &e1);
      while (e1) {
         if (RegComp_Match(((RegExpr)e1)->expr, name, name_len, 0L)) {
            X2C_CALL(adt_FindFirst_0,X2C_GET_TD(pretext->exceptions),
                6)(pretext->exceptions, &e1);
            while (e1) {
               if (RegComp_Match(((RegExpr)e1)->expr, name, name_len, 0L)) {
                  pretext = 0;
                  e1 = 0;
               }
               else {
                  X2C_CALL(adt_FindNext_0,X2C_GET_TD(pretext->exceptions),
                8)(pretext->exceptions, &e1);
               }
            }
            if (pretext) {
               X2C_CALL(adt_FindFirst_0,X2C_GET_TD(pretext->posttokens),
                6)(pretext->posttokens, &e);
               while (e) {
                  if (X2C_GET_TD(e)->base[1]==&H2DScan_TokenDesc_desc) {
                     CopyToken(&t, (H2DScan_Token)e);
                  }
                  else if (X2C_GET_TD(e)->base[3]==&H2DObjs_CommentDesc_desc)
                 {
                     X2C_NEW(&H2DScan_TokenDesc_desc,(X2C_ADDRESS*) &t,
                sizeof(struct H2DScan_TokenDesc),0);
                     anonym = ((H2DObjs_Comment0)e)->header->name;
                     LongStrs_Assign(anonym->Adr, anonym->Len0, &t->file);
                     anonym0 = ((H2DObjs_Comment0)e)->name;
                     LongStrs_Assign(anonym0->Adr, anonym0->Len0, &t->text);
                     t->line0 = ((H2DObjs_Comment0)e)->line;
                     t->token = 6065L;
                     t->parsed = 0;
                  }
                  t->pretoken = 1;
                  X2C_CALL(adt_Insert_0,X2C_GET_TD(token_list),
                14)(token_list, (adt_Element)t);
                  if (first_token) {
                     first_token = 0;
                     X2C_CALL(adt_FindLast_0,X2C_GET_TD(token_list),
                5)(token_list, &ft);
                  }
                  X2C_CALL(adt_FindNext_0,X2C_GET_TD(pretext->posttokens),
                8)(pretext->posttokens, &e);
               }
            }
            e1 = 0;
         }
         else {
            X2C_CALL(adt_FindNext_0,X2C_GET_TD(pretext->patterns),
                8)(pretext->patterns, &e1);
         }
      }
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(pretext_list),8)(pretext_list, &e);
   }
   return ft;
} /* end PutPostText() */


static void next_token(void)
{
   adt_Element e = 0;
   H2DScan_Token t = 0;
   H2DObjs_Comment0 comment0 = 0;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   LongStrs_String anonym2 = 0;
   LongStrs_String anonym3 = 0;
   LongStrs_String anonym4 = 0;
   LongStrs_String anonym5 = 0;
   for (;;) {
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(token_list),8)(token_list, &e);
      if (e==0 || !((H2DScan_Token)e)->parsed && ((H2DScan_Token)e)
                ->token!=6065L) break;
      if (!((H2DScan_Token)e)->parsed) {
         anonym = ((H2DScan_Token)e)->text;
         H2DObjs_NewComment(&comment0, ((H2DScan_Token)e)->line0,
                anonym->Adr, anonym->Len0);
         X2C_CALL(adt_Insert_0,X2C_GET_TD(current_list_for_comments),
                14)(current_list_for_comments, (adt_Element)comment0);
         ((H2DScan_Token)e)->parsed = 1;
      }
   }
   if (e==0) {
      X2C_CALL(adt_FindFirst_0,X2C_GET_TD(token_list),6)(token_list, &e);
      while ((e && ((H2DScan_Token)e)->parsed) && !((H2DScan_Token)e)
                ->boundary) {
         X2C_CALL(adt_Insert_0,X2C_GET_TD(empty_token_list),
                14)(empty_token_list, e);
         X2C_CALL(adt_DeleteCurrent_,X2C_GET_TD(token_list),3)(token_list);
         X2C_CALL(adt_FindFirst_0,X2C_GET_TD(token_list),6)(token_list, &e);
      }
      H2DScan_GetToken();
      if (H2DMsg_WasError) return;
      get_token(&t);
      while (H2DScan_token0==6065L) {
         anonym0 = t->text;
         H2DObjs_NewComment(&comment0, t->line0, anonym0->Adr,
                anonym0->Len0);
         X2C_CALL(adt_Insert_0,X2C_GET_TD(current_list_for_comments),
                14)(current_list_for_comments, (adt_Element)comment0);
         H2DScan_GetToken();
         if (H2DMsg_WasError) return;
         get_token(&t);
      }
      e = 0;
      if (t->token==6064L && !project_on) {
         e = (anonym1 = H2DObjs_CurrentHeader->name,PutPostText(anonym1->Adr,
                 anonym1->Len0));
         for (;;) {
            if (e==0 || !((H2DScan_Token)e)->parsed && ((H2DScan_Token)e)
                ->token!=6065L) break;
            if (!((H2DScan_Token)e)->parsed) {
               anonym2 = ((H2DScan_Token)e)->text;
               H2DObjs_NewComment(&comment0, ((H2DScan_Token)e)->line0,
                anonym2->Adr, anonym2->Len0);
               X2C_CALL(adt_Insert_0,X2C_GET_TD(current_list_for_comments),
                14)(current_list_for_comments, (adt_Element)comment0);
               ((H2DScan_Token)e)->parsed = 1;
            }
            X2C_CALL(adt_FindNext_0,X2C_GET_TD(token_list),8)(token_list,
                &e);
         }
      }
      X2C_CALL(adt_Insert_0,X2C_GET_TD(token_list),14)(token_list,
                (adt_Element)t);
      if (e==0) {
         X2C_CALL(adt_FindLast_0,X2C_GET_TD(token_list),5)(token_list, &e);
      }
   }
   current_token = (H2DScan_Token)e;
   scan_token = current_token->token;
   anonym3 = current_token->text;
   LongStrs_Assign(anonym3->Adr, anonym3->Len0, &scan_text);
   line = current_token->line0;
   pos = current_token->pos0;
   H2DObjs_line = current_token->line0;
   H2DObjs_pos = current_token->pos0;
   anonym4 = current_token->file;
   LongStrs_Assign(anonym4->Adr, anonym4->Len0, &file_name);
   anonym5 = current_token->file;
   LongStrs_Assign(anonym5->Adr, anonym5->Len0, &H2DObjs_file_name);
} /* end next_token() */


static void prev_token(void)
{
   adt_Element e = 0;
   LongStrs_String anonym = 0;
   do {
      X2C_CALL(adt_FindPrev_0,X2C_GET_TD(token_list),7)(token_list, &e);
   } while (!((e==0 || ((H2DScan_Token)e)->boundary) || !((H2DScan_Token)e)->parsed));
   if (e==0 || ((H2DScan_Token)e)->boundary) current_token = emptyToken;
   else {
      current_token = (H2DScan_Token)e;
      line = current_token->line0;
      pos = current_token->pos0;
      H2DObjs_line = current_token->line0;
      H2DObjs_pos = current_token->pos0;
   }
   scan_token = current_token->token;
   anonym = current_token->text;
   LongStrs_Assign(anonym->Adr, anonym->Len0, &scan_text);
} /* end prev_token() */

static void GetToken(X2C_BOOLEAN);


static void get_headers(RegExpr * expr, PreText * pretext)
{
   X2C_INT32 reg_comp_res;
   X2C_SEQ tmp[3];
   X2C_NEW(&H2DParse_PreTextDesc_desc,(X2C_ADDRESS*)pretext,
                sizeof(struct H2DParse_PreTextDesc),0);
   adt_NewList(&(*pretext)->patterns);
   adt_NewList(&(*pretext)->exceptions);
   adt_NewList(&(*pretext)->pretokens);
   adt_NewList(&(*pretext)->posttokens);
   if (scan_token==6069L || scan_token==6068L) {
      X2C_NEW(&H2DParse_RegExprDesc_desc,(X2C_ADDRESS*)expr,
                sizeof(struct H2DParse_RegExprDesc),0);
      RegComp_Compile(scan_text->Adr, scan_text->Len0, &(*expr)->expr,
                &reg_comp_res);
      if (reg_comp_res<=0L) {
         Error(60L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
         return;
      }
      X2C_CALL(adt_Insert_0,X2C_GET_TD((*pretext)->patterns),
                14)((*pretext)->patterns, (adt_Element)*expr);
      GetToken(1);
      if (H2DMsg_WasError) return;
   }
} /* end get_headers() */


static void Header(void)
{
   X2C_BOOLEAN was_footer;
   H2DScan_Token t = 0;
   PreText pretext = 0;
   RegExpr expr = 0;
   X2C_SEQ tmp[3];
   GetToken(1);
   if (H2DMsg_WasError) return;
   get_headers(&expr, &pretext);
   if (H2DMsg_WasError) return;
   PushCommentsList(pretext->pretokens);
   if (scan_token==6063L) {
      current_token->parsed = 1;
      next_token();
      if (H2DMsg_WasError) return;
   }
   else {
      Error(20L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      return;
   }
   while ((scan_token!=6064L && scan_token!=6082L) && scan_token!=6085L) {
      CopyToken(&t, current_token);
      X2C_CALL(adt_Insert_0,X2C_GET_TD(pretext->pretokens),
                14)(pretext->pretokens, (adt_Element)t);
      current_token->parsed = 1;
      next_token();
      if (H2DMsg_WasError) return;
   }
   if (scan_token==6064L) {
      Error(5L, (tmp[0].adr = "#end", tmp[1].val = 0, tmp[2].val = 5u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      return;
   }
   PopCommentsList();
   was_footer = scan_token==6085L;
   GetToken(1);
   if (H2DMsg_WasError) return;
   if (scan_token!=6063L) {
      Error(20L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      return;
   }
   if (was_footer) {
      PushCommentsList(pretext->posttokens);
      current_token->parsed = 1;
      next_token();
      if (H2DMsg_WasError) return;
      while (scan_token!=6064L && scan_token!=6082L) {
         CopyToken(&t, current_token);
         X2C_CALL(adt_Insert_0,X2C_GET_TD(pretext->posttokens),
                14)(pretext->posttokens, (adt_Element)t);
         current_token->parsed = 1;
         next_token();
         if (H2DMsg_WasError) return;
      }
      if (scan_token==6064L) {
         Error(5L, (tmp[0].adr = "#end", tmp[1].val = 0, tmp[2].val = 5u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
         return;
      }
      PopCommentsList();
      GetToken(1);
      if (H2DMsg_WasError) return;
      if (scan_token!=6063L) {
         Error(20L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
         return;
      }
   }
   X2C_CALL(adt_Insert_0,X2C_GET_TD(pretext_list),14)(pretext_list,
                (adt_Element)pretext);
} /* end Header() */


static void ParseDesignator(Designator * designator)
{
   Designator des = 0;
   X2C_CARD8 result;
   X2C_SEQ tmp[3];
   if (scan_token==6001L) {
      NewDesignator(designator, scan_text->Adr, scan_text->Len0, 6001L);
      GetToken(1);
      if (H2DMsg_WasError) return;
      for (;;) {
         switch (scan_token) {
         case 6024L:
            NewDesignator(&des, "", 1ul, 6024L);
            X2C_CALL(adt_Insert_0,X2C_GET_TD((*designator)->list),
                14)((*designator)->list, (adt_Element)des);
            break;
         case 6006L:
            NewDesignator(&des, "", 1ul, 6006L);
            GetToken(1);
            if (H2DMsg_WasError) return;
            if (scan_token==6072L) {
               WholeStr_StrToInt(scan_text->Adr, scan_text->Len0, &des->num,
                &result);
               GetToken(1);
               if (H2DMsg_WasError) return;
               if (scan_token!=6007L) {
                  Error(5L, (tmp[0].adr = "\')\'", tmp[1].val = 0,
                tmp[2].val = 4u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                  return;
               }
            }
            else {
               Error(51L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
            }
            X2C_CALL(adt_Insert_0,X2C_GET_TD((*designator)->list),
                14)((*designator)->list, (adt_Element)des);
            break;
         case 6045L:
            NewDesignator(&des, "", 1ul, 6045L);
            GetToken(1);
            if (H2DMsg_WasError) return;
            if (scan_token!=6046L) {
               Error(5L, (tmp[0].adr = "\']\'", tmp[1].val = 0,
                tmp[2].val = 4u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            X2C_CALL(adt_Insert_0,X2C_GET_TD((*designator)->list),
                14)((*designator)->list, (adt_Element)des);
            break;
         case 6044L:
            NewDesignator(&des, "", 1ul, 6044L);
            GetToken(1);
            if (H2DMsg_WasError) return;
            if (scan_token==6001L) {
               X2C_CALL(adt_Insert_0,X2C_GET_TD((*designator)->list),
                14)((*designator)->list, (adt_Element)des);
               NewDesignator(&des, scan_text->Adr, scan_text->Len0, 6001L);
            }
            else {
               Error(27L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            X2C_CALL(adt_Insert_0,X2C_GET_TD((*designator)->list),
                14)((*designator)->list, (adt_Element)des);
            break;
         default:;
            goto loop_exit;
         } /* end switch */
         GetToken(1);
         if (H2DMsg_WasError) return;
      }
      loop_exit:;
   }
   else {
      Error(27L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
   }
} /* end ParseDesignator() */


static void Variant(void)
{
   Designator designator = 0;
   X2C_BOOLEAN type;
   X2C_BOOLEAN comments;
   adt_Element e = 0;
   LongStrs_String str = 0;
   X2C_SEQ tmp[3];
   C_extensions = 0;
   GetToken(1);
   if (H2DMsg_WasError) return;
   comments = H2DScan_comments;
   H2DScan_comments = 0;
   type = 0;
   ParseDesignator(&designator);
   if (H2DMsg_WasError) return;
   if (scan_token==6000L) {
      GetToken(1);
      if (H2DMsg_WasError) return;
      if (scan_token==6001L && X2C_STRCMP(scan_text->Adr,scan_text->Len0,"VAR\
",4u)==0) {
         GetToken(1);
         if (H2DMsg_WasError) return;
         designator->var = 1;
      }
      if (scan_token==6001L && X2C_STRCMP(scan_text->Adr,scan_text->Len0,"ARR\
AY",6u)==0) {
         GetToken(1);
         if (H2DMsg_WasError) return;
         designator->array = 1;
      }
      if (scan_token==6001L) {
         type = 1;
         LongStrs_Assign(scan_text->Adr, scan_text->Len0,
                &designator->type_name);
         GetToken(1);
         if (H2DMsg_WasError) return;
         if (scan_token==6044L) {
            LongStrs_Append(".", 2ul, &designator->type_name);
            GetToken(1);
            if (H2DMsg_WasError) return;
            if (scan_token!=6001L && (scan_token<5000L || scan_token>5040L)) {
               Error(27L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            LongStrs_Append(scan_text->Adr, scan_text->Len0,
                &designator->type_name);
            GetToken(1);
            if (H2DMsg_WasError) return;
         }
      }
      if ((designator->var || designator->array) && !type) {
         X2C_CALL(adt_FindLast_0,X2C_GET_TD(designator->list),
                5)(designator->list, &e);
         if (((Designator)e)->designator!=6006L) {
            DesignatorError((Designator)e, 52L);
            return;
         }
         X2C_CALL(adt_Insert_0,X2C_GET_TD(H2DObjs_CurrentHeader->Parameters),
                14)(H2DObjs_CurrentHeader->Parameters,
                (adt_Element)designator);
      }
      else if (type && !(designator->var || designator->array)) {
         X2C_CALL(adt_Insert_0,X2C_GET_TD(H2DObjs_CurrentHeader->ModifiedObjects),
                14)(H2DObjs_CurrentHeader->ModifiedObjects,
                (adt_Element)designator);
      }
      else if ((!designator->var && !designator->array) && !type) {
         Error(53L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
         return;
      }
      else {
         Error(59L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
         return;
      }
   }
   else {
      Error(5L, (tmp[0].adr = "\':\'", tmp[1].val = 0, tmp[2].val = 4u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      return;
   }
   if (scan_token!=6063L) {
      Error(20L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      return;
   }
   H2DScan_GetPrevLogicalString(&str);
   H2DMsg_WriteDirFile(str->Adr, str->Len0);
   H2DScan_comments = comments;
   C_extensions = 1;
} /* end Variant() */


static void MakeMergedHeaderComment(const X2C_CHAR name[],
                X2C_CARD32 name_len)
{
   H2DObjs_Comment0 comment0 = 0;
   LongStrs_String str3 = 0;
   LongStrs_String str2 = 0;
   LongStrs_String str1 = 0;
   X2C_INT32 i;
   X2C_INT32 tmp;
   if (H2DCfg_HeadInserting) {
      str1 = 0;
      str2 = 0;
      str3 = 0;
      tmp = LongStrs_Length(name, name_len)+39L;
      i = 0L;
      if (i<=tmp) for (;; i++) {
         LongStrs_Append("-", 2ul, &str1);
         if (i==tmp) break;
      } /* end for */
      tmp = LongStrs_Length(name, name_len)+39L;
      i = 0L;
      if (i<=tmp) for (;; i++) {
         LongStrs_Append(" ", 2ul, &str2);
         if (i==tmp) break;
      } /* end for */
      for (i = 0L; i<=19L; i++) {
         LongStrs_Append(" ", 2ul, &str3);
      } /* end for */
      LongStrs_Append(name, name_len, &str3);
      for (i = 0L; i<=19L; i++) {
         LongStrs_Append(" ", 2ul, &str3);
      } /* end for */
      H2DObjs_NewComment(&comment0, -10L, str1->Adr, str1->Len0);
      X2C_CALL(adt_Insert_0,X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                14)(H2DObjs_CurrentHeader->objects, (adt_Element)comment0);
      H2DObjs_NewComment(&comment0, -10L, str3->Adr, str3->Len0);
      X2C_CALL(adt_Insert_0,X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                14)(H2DObjs_CurrentHeader->objects, (adt_Element)comment0);
      H2DObjs_NewComment(&comment0, -10L, str1->Adr, str1->Len0);
      X2C_CALL(adt_Insert_0,X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                14)(H2DObjs_CurrentHeader->objects, (adt_Element)comment0);
   }
} /* end MakeMergedHeaderComment() */


static void NewMergedHeader(const X2C_CHAR name[], X2C_CARD32 name_len)
{
   adt_NamedElement ne = 0;
   adt_NewNamedElement(&ne, name, name_len);
   X2C_CALL(adt_Insert_0,X2C_GET_TD(H2DObjs_CurrentHeader->mergedheaders),
                14)(H2DObjs_CurrentHeader->mergedheaders, (adt_Element)ne);
   MakeMergedHeaderComment(name, name_len);
   X2C_CALL(adt_Push_,X2C_GET_TD(merged_headers_stack),
                3)(merged_headers_stack, (adt_Element)ne);
} /* end NewMergedHeader() */

static void Undef(void);

static void Define(void);

static void RemoveExpression(H2DObjs_Expression *);

static void ConstExpr(H2DObjs_Expression *);


static void GetToken(X2C_BOOLEAN parsed)
{
   HeaderStackElement hse = 0;
   H2DObjs_Expression expr = 0;
   H2DObjs_ConstantValue result = 0;
   X2C_INT32 local_if_balance;
   adt_Element e = 0;
   adt_NamedElement ne = 0;
   X2C_BOOLEAN ifdef_ifndef;
   H2DObjs_NameSynonym namesyn = 0;
   H2DScan_Token t = 0;
   LongStrs_String str = 0;
   X2C_CHAR str1[20];
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   LongStrs_String anonym2 = 0;
   X2C_SEQ tmp[3];
   for (;;) {
      if ((((((((((((((((current_token->token==6050L || current_token->token==6051L)
                 || current_token->token==6052L)
                || current_token->token==6053L)
                || current_token->token==6054L)
                || current_token->token==6055L)
                || current_token->token==6056L)
                || current_token->token==6057L)
                || current_token->token==6058L)
                || current_token->token==6059L)
                || current_token->token==6060L)
                || current_token->token==6061L)
                || current_token->token==6080L)
                || current_token->token==6088L)
                || current_token->token==6086L)
                || current_token->token==6087L)
                || current_token->token==6063L) current_token->parsed = 1;
      else current_token->parsed = current_token->parsed || parsed;
      next_token();
      if (H2DMsg_WasError) return;
      switch (scan_token) {
      case 6064L:
         if ((!config_on && !project_on) && H2DCfg_IncludingTree) {
            H2DMsg_WriteLogFile("", 1ul, 0);
         }
         if (include_balance>0L) {
            --include_balance;
            X2C_CALL(adt_Pop_,X2C_GET_TD(headers_stack),2)(headers_stack,
                &e);
            token_list = (adt_List)e;
            GetToken(1);
            if (H2DMsg_WasError) return;
            if (scan_token==6063L) {
               X2C_CALL(adt_Pop_,X2C_GET_TD(merged_headers_stack),
                2)(merged_headers_stack, &e);
               X2C_CALL(adt_Pop_,X2C_GET_TD(merged_headers_stack),
                2)(merged_headers_stack, &e);
               if (e) {
                  anonym = ((adt_NamedElement)e)->name;
                  MakeMergedHeaderComment(anonym->Adr, anonym->Len0);
                  X2C_CALL(adt_Push_,X2C_GET_TD(merged_headers_stack),
                3)(merged_headers_stack, e);
               }
            }
            else {
               Error(20L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
         }
         else if (if_balance>0L) {
            X2C_CALL(adt_Pop_,X2C_GET_TD(if_stack),2)(if_stack, &e);
            t = (H2DScan_Token)e;
            str = 0;
            LongStrs_Assign("#", 2ul, &str);
            anonym0 = t->text;
            LongStrs_Append(anonym0->Adr, anonym0->Len0, &str);
            LongStrs_Append(" [", 3ul, &str);
            anonym1 = t->file;
            LongStrs_Append(anonym1->Adr, anonym1->Len0, &str);
            LongStrs_Append(" ", 2ul, &str);
            WholeStr_IntToStr(t->line0, str1, 20ul);
            LongStrs_Append(str1, 20ul, &str);
            LongStrs_Append(":", 2ul, &str);
            WholeStr_IntToStr(t->pos0+1L, str1, 20ul);
            LongStrs_Append(str1, 20ul, &str);
            LongStrs_Append("]", 2ul, &str);
            Error(65L, (tmp[0].adr = str->Adr, tmp[1].val = 0,
                tmp[2].val = str->Len0*1u-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
            LongStrs_Deallocate(&str);
            return;
         }
         else goto loop_exit;
         break;
      case 6051L:
         ++if_balance;
         CopyToken(&t, current_token);
         X2C_CALL(adt_Push_,X2C_GET_TD(if_stack),3)(if_stack,
                (adt_Element)t);
         GetToken(1);
         if (H2DMsg_WasError) return;
         limited_constant_expression_on = 1;
         for (;;) {
            ConstExpr(&expr);
            if (H2DMsg_WasError) return;
            if (scan_token==6063L) {
               if (expr) {
                  X2C_CALL(H2DObjs_ComputeExpression_,X2C_GET_TD(expr),
                2)(expr, &result, limited_constant_expression_on);
                  RemoveExpression(&expr);
               }
               else {
                  Error(21L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                  return;
               }
               if (H2DMsg_WasError) return;
               if (result->int0==0L) {
                  H2DObjs_Deallocate((adt_Element)result);
                  H2DScan_skipping_mode = 1;
                  local_if_balance = 0L;
                  current_token->parsed = 1;
                  next_token();
                  if (H2DMsg_WasError) return;
                  for (;;) {
                     if (((scan_token==6053L || scan_token==6054L)
                || scan_token==6052L) && local_if_balance==0L) break;
                     if ((scan_token==6051L || scan_token==6055L)
                || scan_token==6056L) ++local_if_balance;
                     else if (scan_token==6052L) --local_if_balance;
                     current_token->parsed = 1;
                     next_token();
                     if (H2DMsg_WasError) return;
                  }
                  H2DScan_skipping_mode = 0;
                  if (scan_token==6054L) {
                     GetToken(1);
                     if (H2DMsg_WasError) return;
                     if (scan_token==6063L) break;
                     else {
                        Error(20L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                        return;
                     }
                  }
                  if (scan_token==6052L) {
                     GetToken(1);
                     if (H2DMsg_WasError) return;
                     if (scan_token==6063L) {
                        --if_balance;
                        X2C_CALL(adt_Pop_,X2C_GET_TD(if_stack),2)(if_stack,
                &e);
                        X2C_CALL(adt_Insert_0,X2C_GET_TD(empty_token_list),
                14)(empty_token_list, e);
                        break;
                     }
                     else {
                        Error(20L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                        return;
                     }
                  }
                  GetToken(1);
                  if (H2DMsg_WasError) {
                     return;
                  }
               }
               else {
                  H2DObjs_Deallocate((adt_Element)result);
                  break;
               }
            }
            else {
               Error(20L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
         }
         limited_constant_expression_on = 0;
         break;
      case 6052L:
         if (if_balance<=0L) {
            Error(2L, (tmp[0].adr = "#endif", tmp[1].val = 0,
                tmp[2].val = 7u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
            return;
         }
         --if_balance;
         X2C_CALL(adt_Pop_,X2C_GET_TD(if_stack),2)(if_stack, &e);
         X2C_CALL(adt_Insert_0,X2C_GET_TD(empty_token_list),
                14)(empty_token_list, e);
         GetToken(1);
         if (H2DMsg_WasError) return;
         if (scan_token!=6063L) {
            Error(20L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
            return;
         }
         break;
      case 6053L:
      case 6054L:
         local_if_balance = 0L;
         H2DScan_skipping_mode = 1;
         for (;;) {
            if (scan_token==6052L && local_if_balance==0L) break;
            if ((scan_token==6051L || scan_token==6055L)
                || scan_token==6056L) ++local_if_balance;
            else if (scan_token==6052L) --local_if_balance;
            current_token->parsed = 1;
            next_token();
            if (H2DMsg_WasError) return;
         }
         GetToken(1);
         if (H2DMsg_WasError) return;
         if (scan_token==6063L) {
            H2DScan_skipping_mode = 0;
            --if_balance;
            X2C_CALL(adt_Pop_,X2C_GET_TD(if_stack),2)(if_stack, &e);
            X2C_CALL(adt_Insert_0,X2C_GET_TD(empty_token_list),
                14)(empty_token_list, e);
         }
         else {
            Error(20L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
            return;
         }
         break;
      case 6055L:
      case 6056L:
         ++if_balance;
         CopyToken(&t, current_token);
         X2C_CALL(adt_Push_,X2C_GET_TD(if_stack),3)(if_stack,
                (adt_Element)t);
         ifdef_ifndef = scan_token==6055L;
         GetToken(1);
         if (H2DMsg_WasError) return;
         if (scan_token==6001L) {
            adt_NewNamedElement(&ne, scan_text->Adr, scan_text->Len0);
            H2DObjs_FindInDefined(H2DObjs_CurrentHeader, ne, &e);
            adt_Deallocate((adt_Element)ne);
            GetToken(1);
            if (H2DMsg_WasError) return;
            if (e==0 && !ifdef_ifndef || e && ifdef_ifndef) {
               if (scan_token!=6063L) {
                  Error(20L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                  return;
               }
            }
            else {
               limited_constant_expression_on = 1;
               for (;;) {
                  if (scan_token==6063L) {
                     current_token->parsed = 1;
                     H2DScan_skipping_mode = 1;
                     next_token();
                     if (H2DMsg_WasError) return;
                     local_if_balance = 0L;
                     for (;;) {
                        if (((scan_token==6053L || scan_token==6054L)
                || scan_token==6052L) && local_if_balance==0L) break;
                        if ((scan_token==6051L || scan_token==6055L)
                || scan_token==6056L) ++local_if_balance;
                        else if (scan_token==6052L) --local_if_balance;
                        current_token->parsed = 1;
                        next_token();
                        if (H2DMsg_WasError) return;
                     }
                     H2DScan_skipping_mode = 0;
                     if (scan_token==6054L) {
                        GetToken(1);
                        if (H2DMsg_WasError) return;
                        if (scan_token==6063L) break;
                        else {
                           Error(20L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                           return;
                        }
                     }
                     if (scan_token==6052L) {
                        GetToken(1);
                        if (H2DMsg_WasError) return;
                        if (scan_token==6063L) {
                           --if_balance;
                           X2C_CALL(adt_Pop_,X2C_GET_TD(if_stack),
                2)(if_stack, &e);
                           X2C_CALL(adt_Insert_0,
                X2C_GET_TD(empty_token_list),14)(empty_token_list, e);
                           break;
                        }
                        else {
                           Error(20L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                           return;
                        }
                     }
                     GetToken(1);
                     if (H2DMsg_WasError) return;
                     ConstExpr(&expr);
                     if (H2DMsg_WasError) return;
                     X2C_CALL(H2DObjs_ComputeExpression_,X2C_GET_TD(expr),
                2)(expr, &result, limited_constant_expression_on);
                     if (H2DMsg_WasError) return;
                     if (result->int0) {
                        H2DObjs_Deallocate((adt_Element)result);
                        if (scan_token==6063L) break;
                        else {
                           Error(20L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                           return;
                        }
                     }
                     H2DObjs_Deallocate((adt_Element)result);
                  }
                  else {
                     Error(20L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                     return;
                  }
               }
               limited_constant_expression_on = 0;
            }
         }
         else {
            Error(26L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
            return;
         }
         break;
      case 6060L:
         if (!config_on) {
            GetToken(1);
            if (H2DMsg_WasError) return;
            adt_NewNamedElement(&ne, scan_text->Adr, scan_text->Len0);
            X2C_CALL(adt_Find_,X2C_GET_TD(merge_headers_tree),
                12)(merge_headers_tree, (adt_Element)ne, &e);
            if (!project_on && H2DCfg_IncludingTree) {
               H2DMsg_WriteLogFile(scan_text->Adr, scan_text->Len0,
                H2DCfg_HeadersMerging || e);
            }
            if ((H2DCfg_HeadersMerging || e) || project_on) {
               X2C_CALL(adt_Find_0,
                X2C_GET_TD(H2DObjs_CurrentHeader->mergedheaders),
                11)(H2DObjs_CurrentHeader->mergedheaders, (adt_Element)ne,
                &e);
               adt_Deallocate((adt_Element)ne);
               if (e==0) {
                  ++include_balance;
                  H2DScan_transparent_numeration = 1;
                  if (Open(scan_text->Adr, scan_text->Len0, 1)) {
                     NewMergedHeader(scan_text->Adr, scan_text->Len0);
                     X2C_CALL(adt_Push_,X2C_GET_TD(headers_stack),
                3)(headers_stack, (adt_Element)token_list);
                     if (!project_on) {
                        PutPreText(scan_text->Adr, scan_text->Len0);
                     }
                     GetToken(1);
                     if (H2DMsg_WasError) return;
                     goto loop_exit;
                  }
                  else return;
               }
               GetToken(1);
               if (H2DMsg_WasError) return;
               if (scan_token!=6063L) {
                  Error(20L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                  return;
               }
               if (H2DCfg_IncludingTree) H2DMsg_WriteLogFile("", 1ul, 0);
            }
            else {
               X2C_CALL(adt_Find_0,
                X2C_GET_TD(H2DObjs_CurrentHeader->includes),
                11)(H2DObjs_CurrentHeader->includes, (adt_Element)ne, &e);
               adt_Deallocate((adt_Element)ne);
               if (e==0) {
                  X2C_NEW(&H2DParse_HeaderStackElementDe0,
                (X2C_ADDRESS*) &hse,
                sizeof(struct H2DParse_HeaderStackElementDes),0);
                  hse->header = H2DObjs_CurrentHeader;
                  hse->token_list0 = token_list;
                  hse->current_token0 = current_token;
                  hse->scan_token0 = scan_token;
                  LongStrs_Assign(scan_text->Adr, scan_text->Len0,
                &hse->scan_text0);
                  hse->tag_was_parsed0 = tag_was_parsed;
                  hse->if_balance0 = if_balance;
                  hse->if_stack0 = if_stack;
                  hse->end_balance0 = end_balance;
                  hse->include_balance0 = include_balance;
                  hse->transparent_numeration = H2DScan_transparent_numeration;
                  hse->C_extensions0 = C_extensions;
                  hse->limited_constant_expression_o0 = limited_constant_expression_on;
                  X2C_CALL(adt_Push_,X2C_GET_TD(headers_stack),
                3)(headers_stack, (adt_Element)hse);
                  H2DScan_transparent_numeration = 0;
                  H2DParse_Parse(scan_text->Adr, scan_text->Len0,
                scan_token==6068L);
                  if (H2DMsg_WasError) return;
                  X2C_CALL(adt_Pop_,X2C_GET_TD(headers_stack),
                2)(headers_stack, &e);
                  hse = (HeaderStackElement)e;
                  merge_headers(hse->header, H2DObjs_CurrentHeader, 1, 0);
                  H2DObjs_CurrentHeader = hse->header;
                  token_list = hse->token_list0;
                  current_token = hse->current_token0;
                  scan_token = hse->scan_token0;
                  anonym2 = hse->scan_text0;
                  LongStrs_Assign(anonym2->Adr, anonym2->Len0, &scan_text);
                  tag_was_parsed = hse->tag_was_parsed0;
                  if_balance = hse->if_balance0;
                  if_stack = hse->if_stack0;
                  end_balance = hse->end_balance0;
                  include_balance = hse->include_balance0;
                  H2DScan_transparent_numeration = hse->transparent_numeration;
                  C_extensions = hse->C_extensions0;
                  limited_constant_expression_on = hse->limited_constant_expression_o0;
                  GetToken(1);
                  if (H2DMsg_WasError) return;
                  if (scan_token!=6063L) {
                     Error(20L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                     return;
                  }
               }
               else {
                  GetToken(1);
                  if (H2DMsg_WasError) return;
                  if (scan_token!=6063L) {
                     Error(20L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                     return;
                  }
                  if (H2DCfg_IncludingTree) H2DMsg_WriteLogFile("", 1ul, 0);
               }
            }
         }
         break;
      case 6080L:
         if ((C_extensions && !config_on) && !project_on) {
            GetToken(1);
            if (H2DMsg_WasError) return;
            adt_NewNamedElement(&ne, scan_text->Adr, scan_text->Len0);
            X2C_CALL(adt_Insert_,X2C_GET_TD(merge_headers_tree),
                11)(merge_headers_tree, (adt_Element)ne);
            GetToken(1);
            if (H2DMsg_WasError) return;
            if (scan_token!=6063L) {
               Error(20L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            H2DScan_GetPrevLogicalString(&str);
            H2DMsg_WriteDirFile(str->Adr, str->Len0);
         }
         else goto loop_exit;
         break;
      case 6088L:
         if (project_on) {
            Header();
            if (H2DMsg_WasError) return;
         }
         else goto loop_exit;
         break;
      case 6087L:
         if ((C_extensions && !config_on) && !project_on) {
            Variant();
            if (H2DMsg_WasError) return;
         }
         else goto loop_exit;
         break;
      case 6086L:
         if (project_on) {
            GetToken(1);
            if (H2DMsg_WasError) return;
            X2C_NEW(&H2DObjs_NameSynonymDesc_desc,(X2C_ADDRESS*) &namesyn,
                sizeof(struct H2DObjs_NameSynonymDesc),0);
            X2C_CALL(adt_SetName_,X2C_GET_TD(namesyn),
                1)((adt_NamedElement)namesyn, scan_text->Adr,
                scan_text->Len0);
            GetToken(1);
            if (H2DMsg_WasError) return;
            if (scan_token==6001L) {
               namesyn->newname = 0;
               LongStrs_Assign(scan_text->Adr, scan_text->Len0,
                &namesyn->newname);
               X2C_CALL(adt_Insert_,X2C_GET_TD(H2DObjs_ModuleNames),
                11)(H2DObjs_ModuleNames, (adt_Element)namesyn);
            }
            else {
               Error(27L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            GetToken(1);
            if (H2DMsg_WasError) return;
            if (scan_token!=6063L) {
               Error(20L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
         }
         else goto loop_exit;
         break;
      case 6061L:
      case 6058L:
      case 6059L:
         do {
            current_token->parsed = 1;
            next_token();
            if (H2DMsg_WasError) return;
         } while (scan_token!=6063L);
         break;
      case 6050L:
         Define();
         break;
      case 6057L:
         Undef();
         break;
      default:;
         goto loop_exit;
      } /* end switch */
   }
   loop_exit:;
} /* end GetToken() */


static void open_boundary(void)
{
   adt_Element e = 0;
   X2C_SEQ tmp[3];
   do {
      X2C_CALL(adt_FindPrev_0,X2C_GET_TD(token_list),7)(token_list, &e);
   } while (!(e==0 || ((H2DScan_Token)e)->boundary));
   if (e) {
      ((H2DScan_Token)e)->boundary = 0;
      current_token = (H2DScan_Token)e;
   }
   else {
      Error(28L, (tmp[0].adr = "H2DParse.open_boundary", tmp[1].val = 0,
                tmp[2].val = 23u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      return;
   }
} /* end open_boundary() */


static void CheckFullDefinition(H2DObjs_TypedObject tobj)
{
   LongStrs_String anonym = 0;
   X2C_SEQ tmp[3];
   if (((tobj->type->type==1001L || tobj->type->type==1005L)
                && tobj->type->not_described) && tobj->mem_class!=5014L) {
      anonym = tobj->name;
      Error(29L, (tmp[0].adr = anonym->Adr, tmp[1].val = 0,
                tmp[2].val = anonym->Len0*1u-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
      return;
   }
} /* end CheckFullDefinition() */


static void CheckIntExpr(H2DObjs_Expression expr, X2C_INT32 boundary)
{
   H2DObjs_ConstantValue res = 0;
   X2C_SEQ tmp[3];
   X2C_CALL(H2DObjs_ComputeExpression_,X2C_GET_TD(expr),2)(expr, &res, 0);
   if (H2DMsg_WasError) return;
   if (res->type!=6072L && res->type!=6073L) {
      line = expr->line;
      pos = expr->pos;
      Error(30L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      return;
   }
   if (boundary==1L) {
      if (res->type!=6073L && res->int0<=0L) {
         line = expr->line;
         pos = expr->pos;
         Error(31L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      }
   }
   else if (boundary==0L) {
      if (res->type!=6073L && res->int0<0L) {
         line = expr->line;
         pos = expr->pos;
         Error(32L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      }
   }
   H2DObjs_Deallocate((adt_Element)res);
} /* end CheckIntExpr() */

static void Declarations(X2C_BOOLEAN, adt_List);


static void Type(H2DObjs_Type * type, X2C_INT32 * modifier,
                X2C_BOOLEAN * type_is_present,
                X2C_BOOLEAN * tag_was_parsed0)
{
   X2C_BOOLEAN short0;
   X2C_BOOLEAN long0;
   X2C_BOOLEAN signed0;
   X2C_BOOLEAN unsigned0;
   adt_Element e = 0;
   adt_NamedElement ne = 0;
   H2DObjs_TypedObject tobj = 0;
   X2C_INT32 last_enum_value;
   H2DObjs_Value val = 0;
   X2C_CHAR str[20];
   H2DObjs_ConstantValue res = 0;
   X2C_INT32 local_type;
   X2C_BOOLEAN second_definition;
   X2C_BOOLEAN inserting;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   LongStrs_String anonym2 = 0;
   LongStrs_String anonym3 = 0;
   LongStrs_String anonym4 = 0;
   LongStrs_String anonym5 = 0;
   X2C_SEQ tmp[3];
   X2C_SEQ tmp0[7];
   *tag_was_parsed0 = 0;
   if (scan_token==5009L) {
      *modifier = 5009L;
      GetToken(1);
      if (H2DMsg_WasError) return;
   }
   else if (scan_token==5032L) {
      *modifier = 5032L;
      GetToken(1);
      if (H2DMsg_WasError) return;
   }
   else *modifier = 3009L;
   signed0 = 0;
   unsigned0 = 0;
   long0 = 0;
   short0 = 0;
   H2DObjs_NewType(type);
   *type_is_present = 1;
   if (scan_token==5031L) {
      signed0 = 1;
      GetToken(1);
      if (H2DMsg_WasError) return;
   }
   else if (scan_token==5028L) {
      unsigned0 = 1;
      GetToken(1);
      if (H2DMsg_WasError) return;
   }
   if (scan_token==5021L) {
      long0 = 1;
      GetToken(1);
      if (H2DMsg_WasError) return;
   }
   else if (scan_token==5019L) {
      short0 = 1;
      GetToken(1);
      if (H2DMsg_WasError) return;
   }
   switch (scan_token) {
   case 5000L:
      if (unsigned0) {
         if (long0) (*type)->type = 7L;
         else if (short0) (*type)->type = 6L;
         else (*type)->type = 5L;
      }
      else if (long0) (*type)->type = 3L;
      else if (short0) (*type)->type = 2L;
      else (*type)->type = 1L;
      break;
   case 5007L:
      if (unsigned0) (*type)->type = 4L;
      else (*type)->type = 0L;
      break;
   case 5011L:
      if ((signed0 || unsigned0) || short0) {
         Error(33L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
         return;
      }
      if (long0) (*type)->type = 10L;
      else (*type)->type = 8L;
      break;
   case 5001L:
      if ((signed0 || unsigned0) || short0) {
         Error(33L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
         return;
      }
      if (long0) (*type)->type = 11L;
      else (*type)->type = 9L;
      break;
   case 5029L:
      if (((signed0 || unsigned0) || short0) || long0) {
         Error(33L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
         return;
      }
      (*type)->type = 12L;
      break;
   case 5018L:
   case 5025L:
      inserting = 0;
      if (scan_token==5018L) (*type)->type = 1001L;
      else (*type)->type = 1005L;
      local_type = (*type)->type;
      (*type)->not_described = 1;
      second_definition = 0;
      GetToken(1);
      if (H2DMsg_WasError) return;
      *tag_was_parsed0 = scan_token==6001L;
      if (*tag_was_parsed0) {
         adt_NewNamedElement(&ne, scan_text->Adr, scan_text->Len0);
         (*type)->line = line;
         SetFileName(&(*type)->file, file_name);
         GetToken(1);
         if (H2DMsg_WasError) return;
         H2DObjs_FindInTags(H2DObjs_CurrentHeader, ne, &e);
         if (e) {
            adt_Deallocate((adt_Element)ne);
            second_definition = 1;
            H2DObjs_Deallocate((adt_Element)*type);
            *type = (H2DObjs_Type)e;
            if ((*type)->type==local_type) {
               if (!(*type)->not_described) {
                  *tag_was_parsed0 = 0;
                  if (scan_token==6008L) {
                     anonym0 = (*type)->file;
                     anonym = (*type)->name;
                     Error(19L, (tmp0[0].adr = anonym->Adr, tmp0[1].val = 0,
                tmp0[2].val = anonym->Len0*1u-1, tmp0[3].adr = anonym0->Adr,
                tmp0[4].val = 0, tmp0[5].val = anonym0->Len0*1u-1,
                tmp0[6].val = (*type)->line, (X2C_LOC *)tmp0),
                7ul*sizeof(X2C_SEQ));
                  }
                  return;
               }
            }
            else {
               anonym2 = (*type)->file;
               anonym1 = (*type)->name;
               Error(19L, (tmp0[0].adr = anonym1->Adr, tmp0[1].val = 0,
                tmp0[2].val = anonym1->Len0*1u-1, tmp0[3].adr = anonym2->Adr,
                 tmp0[4].val = 0, tmp0[5].val = anonym2->Len0*1u-1,
                tmp0[6].val = (*type)->line, (X2C_LOC *)tmp0),
                7ul*sizeof(X2C_SEQ));
               return;
            }
         }
         else {
            anonym3 = ne->name;
            X2C_CALL(adt_SetName_,X2C_GET_TD(*type),
                1)((adt_NamedElement)*type, anonym3->Adr, anonym3->Len0);
            adt_Deallocate((adt_Element)ne);
            InsertToTags((adt_NamedElement)*type);
            if (H2DMsg_WasError) return;
            inserting = 1;
         }
      }
      if (scan_token==6008L) {
         (*type)->not_described = 0;
         (*type)->tag_description_header = H2DObjs_CurrentHeader;
         inserting = inserting || (*type)->tag_description_header!=(*type)
                ->header;
         PushCommentsList((*type)->vars);
         GetToken(1);
         if (H2DMsg_WasError) return;
         Declarations(1, (*type)->vars);
         PopCommentsList();
         if (H2DMsg_WasError) return;
         if (scan_token==6009L) {
            if (inserting) {
               inserting = 0;
               X2C_CALL(adt_Insert_0,
                X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                14)(H2DObjs_CurrentHeader->objects, (adt_Element)*type);
            }
            GetToken(1);
            if (H2DMsg_WasError) return;
         }
         else {
            Error(5L, (tmp0[0].adr = "\'}\'", tmp0[1].val = 0,
                tmp0[2].val = 4u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
         }
      }
      else if (!*tag_was_parsed0) {
         Error(54L, (tmp0[0].adr = "", tmp0[1].val = 0, tmp0[2].val = 1u-1,
                (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
      }
      else if (second_definition) *tag_was_parsed0 = 0;
      if (inserting) {
         X2C_CALL(adt_Insert_0,X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                14)(H2DObjs_CurrentHeader->objects, (adt_Element)*type);
      }
      return;
   case 5012L:
      inserting = 0;
      last_enum_value = -1L;
      (*type)->type = 1006L;
      (*type)->not_described = 1;
      second_definition = 0;
      GetToken(1);
      if (H2DMsg_WasError) return;
      *tag_was_parsed0 = scan_token==6001L;
      if (*tag_was_parsed0) {
         adt_NewNamedElement(&ne, scan_text->Adr, scan_text->Len0);
         (*type)->line = line;
         SetFileName(&(*type)->file, file_name);
         H2DObjs_FindInTags(H2DObjs_CurrentHeader, ne, &e);
         GetToken(1);
         if (H2DMsg_WasError) return;
         if (e) {
            second_definition = 1;
            H2DObjs_Deallocate((adt_Element)*type);
            *type = (H2DObjs_Type)e;
            if ((*type)->type==1006L) {
               if (!(*type)->not_described) {
                  *tag_was_parsed0 = 0;
                  return;
               }
            }
            else {
               anonym4 = (*type)->file;
               Error(19L, (tmp0[0].adr = scan_text->Adr, tmp0[1].val = 0,
                tmp0[2].val = scan_text->Len0*1u-1,
                tmp0[3].adr = anonym4->Adr, tmp0[4].val = 0,
                tmp0[5].val = anonym4->Len0*1u-1,
                tmp0[6].val = (*type)->line, (X2C_LOC *)tmp0),
                7ul*sizeof(X2C_SEQ));
               return;
            }
         }
         else {
            anonym5 = ne->name;
            X2C_CALL(adt_SetName_,X2C_GET_TD(*type),
                1)((adt_NamedElement)*type, anonym5->Adr, anonym5->Len0);
            InsertToTags((adt_NamedElement)*type);
            if (H2DMsg_WasError) return;
            inserting = 1;
         }
      }
      if (scan_token==6008L) {
         (*type)->not_described = 0;
         (*type)->tag_description_header = H2DObjs_CurrentHeader;
         PushCommentsList((*type)->vars);
         GetToken(1);
         if (H2DMsg_WasError) return;
         for (;;) {
            if (scan_token==6001L) {
               H2DObjs_NewTypedObject(&tobj, 2004L);
               X2C_CALL(adt_SetName_,X2C_GET_TD(tobj),
                1)((adt_NamedElement)tobj, scan_text->Adr, scan_text->Len0);
               tobj->line = line;
               SetFileName(&tobj->file, file_name);
               tobj->type = *type;
               InsertToList((*type)->vars, (adt_NamedElement)tobj);
               if (H2DMsg_WasError) return;
               InsertToNames((adt_NamedElement)tobj, 0);
               if (H2DMsg_WasError) return;
               GetToken(1);
               if (H2DMsg_WasError) return;
               if (scan_token==6013L) {
                  GetToken(1);
                  if (H2DMsg_WasError) return;
                  ConstExpr(&tobj->expr);
                  if (H2DMsg_WasError) return;
                  if (tobj->expr==0) {
                     Error(21L, (tmp0[0].adr = "", tmp0[1].val = 0,
                tmp0[2].val = 1u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
                     return;
                  }
                  CheckIntExpr(tobj->expr, -1L);
                  if (H2DMsg_WasError) return;
                  X2C_CALL(H2DObjs_ComputeExpression_,X2C_GET_TD(tobj->expr),
                2)(tobj->expr, &res, 0);
                  last_enum_value = res->int0;
                  H2DObjs_Deallocate((adt_Element)res);
               }
               else {
                  ++last_enum_value;
                  H2DObjs_NewValue(&val);
                  val->hex = 0;
                  val->value = 0;
                  val->type = 6072L;
                  WholeStr_IntToStr(last_enum_value, str, 20ul);
                  LongStrs_Assign(str, 20ul, &val->value);
                  tobj->expr = (H2DObjs_Expression)val;
               }
               if (scan_token==6005L) {
                  GetToken(1);
                  if (H2DMsg_WasError) return;
               }
               else break;
            }
            else {
               Error(27L, (tmp0[0].adr = "", tmp0[1].val = 0,
                tmp0[2].val = 1u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
               return;
            }
         }
         PopCommentsList();
         if (scan_token==6009L) {
            if (inserting) {
               inserting = 0;
               X2C_CALL(adt_Insert_0,
                X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                14)(H2DObjs_CurrentHeader->objects, (adt_Element)*type);
            }
            GetToken(1);
            if (H2DMsg_WasError) return;
         }
         else {
            Error(5L, (tmp0[0].adr = "\'}\'", tmp0[1].val = 0,
                tmp0[2].val = 4u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
            return;
         }
      }
      else if (!*tag_was_parsed0) {
         Error(54L, (tmp0[0].adr = "", tmp0[1].val = 0, tmp0[2].val = 1u-1,
                (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
      }
      else if (second_definition) *tag_was_parsed0 = 0;
      if (inserting) {
         X2C_CALL(adt_Insert_0,X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                14)(H2DObjs_CurrentHeader->objects, (adt_Element)*type);
      }
      return;
   default:;
      if (scan_token==6001L) {
         adt_NewNamedElement(&ne, scan_text->Adr, scan_text->Len0);
         H2DObjs_FindInNames(H2DObjs_CurrentHeader, ne, &e);
         if ((e && X2C_GET_TD(e)->base[3]==&H2DObjs_TypeDesc_desc)
                && ((H2DObjs_Type)e)->type==1003L) {
            H2DObjs_Deallocate((adt_Element)*type);
            *type = (H2DObjs_Type)e;
            GetToken(1);
            return;
         }
      }
      if (unsigned0) {
         if (long0) (*type)->type = 7L;
         else if (short0) (*type)->type = 6L;
         else (*type)->type = 5L;
      }
      else if (signed0) {
         if (long0) (*type)->type = 3L;
         else if (short0) (*type)->type = 2L;
         else (*type)->type = 1L;
      }
      else if (long0) (*type)->type = 3L;
      else if (short0) (*type)->type = 2L;
      else {
         (*type)->type = 1L;
         *type_is_present = 0;
      }
      return;
   } /* end switch */
   GetToken(1);
} /* end Type() */


static void Memory_Class(X2C_INT32 * mem_class)
{
   if (((scan_token==5014L || scan_token==5003L) || scan_token==5020L)
                || scan_token==5023L) {
      *mem_class = scan_token;
      GetToken(1);
      if (H2DMsg_WasError) return;
   }
   else *mem_class = 4000L;
} /* end Memory_Class() */


static void Define(void)
{
   H2DObjs_TypedObject tobj = 0;
   H2DScan_Token token = 0;
   H2DObjs_Replacement r = 0;
   H2DObjs_Macro mac = 0;
   adt_NamedElement ne = 0;
   adt_Element e = 0;
   X2C_BOOLEAN was_dies;
   X2C_BOOLEAN was_double_dies;
   X2C_BOOLEAN first;
   X2C_INT32 _line;
   adt_List comments = 0;
   H2DObjs_Comment0 comment0 = 0;
   LongStrs_String comment_text = 0;
   X2C_INT32 tokens_num;
   LongStrs_String anonym = 0;
   LongStrs_String anonym0 = 0;
   LongStrs_String anonym1 = 0;
   X2C_SEQ tmp[3];
   adt_NewList(&comments);
   tokens_num = 0L;
   PushCommentsList(comments);
   GetToken(1);
   if (H2DMsg_WasError) return;
   if ((scan_token==6070L || scan_token==6071L) && X2C_STRCMP(scan_text->Adr,
                scan_text->Len0,"defined",8u)==0) {
      Error(34L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      return;
   }
   if (scan_token==6070L) {
      current_token->boundary = 1;
      H2DObjs_NewReplacement(&r, scan_text->Adr, scan_text->Len0);
      _line = line;
      next_token();
      if (H2DMsg_WasError) return;
      while (scan_token!=6063L) {
         ++tokens_num;
         CopyToken(&token, current_token);
         X2C_CALL(adt_Insert_0,X2C_GET_TD(r->tokens),14)(r->tokens,
                (adt_Element)token);
         next_token();
         if (H2DMsg_WasError) return;
      }
      PopCommentsList();
      open_boundary();
      GetToken(1);
      if (H2DMsg_WasError) return;
      if (scan_token==6001L && tokens_num==1L) {
         H2DObjs_NewTypedObject(&tobj, 2005L);
         anonym = r->name;
         X2C_CALL(adt_SetName_,X2C_GET_TD(tobj),1)((adt_NamedElement)tobj,
                anonym->Adr, anonym->Len0);
         tobj->line = _line;
         SetFileName(&tobj->file, file_name);
         H2DObjs_NewType(&tobj->type);
         X2C_CALL(adt_SetName_,X2C_GET_TD(tobj->type),
                1)((adt_NamedElement)tobj->type, scan_text->Adr,
                scan_text->Len0);
         merge_lists(tobj->modifier, comments, 0);
         InsertToDefined((adt_NamedElement)r);
         if (H2DMsg_WasError) return;
         X2C_CALL(adt_Insert_,X2C_GET_TD(H2DObjs_CurrentHeader->Synonyms),
                11)(H2DObjs_CurrentHeader->Synonyms, (adt_Element)tobj);
         X2C_CALL(adt_Insert_,X2C_GET_TD(H2DObjs_CurrentHeader->Replacements),
                11)(H2DObjs_CurrentHeader->Replacements, (adt_Element)r);
         redefined_macro = 0;
         GetToken(1);
         if (H2DMsg_WasError) return;
      }
      else {
         H2DObjs_NewTypedObject(&tobj, 2001L);
         anonym0 = r->name;
         X2C_CALL(adt_SetName_,X2C_GET_TD(tobj),1)((adt_NamedElement)tobj,
                anonym0->Adr, anonym0->Len0);
         tobj->line = _line;
         SetFileName(&tobj->file, file_name);
         H2DObjs_pd_define_is_parsed = 1;
         limited_constant_expression_on = 0;
         ConstExpr(&tobj->expr);
         if (H2DMsg_WasError) return;
         H2DObjs_pd_define_is_parsed = 0;
         if (tobj->expr==0 || scan_token!=6063L) {
            H2DObjs_Deallocate((adt_Element)tobj);
            InsertToDefined((adt_NamedElement)r);
            if (H2DMsg_WasError) return;
            redefined_macro = 0;
            X2C_CALL(adt_Insert_,
                X2C_GET_TD(H2DObjs_CurrentHeader->Replacements),
                11)(H2DObjs_CurrentHeader->Replacements, (adt_Element)r);
            H2DScan_GetPrevLogicalString(&comment_text);
            H2DObjs_NewComment(&comment0, _line, comment_text->Adr,
                comment_text->Len0);
            LongStrs_Deallocate(&comment_text);
            X2C_CALL(adt_Insert_0,X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                14)(H2DObjs_CurrentHeader->objects, (adt_Element)comment0);
            while (scan_token!=6063L) {
               GetToken(1);
               if (H2DMsg_WasError) return;
            }
         }
         else {
            merge_lists(empty_token_list, r->tokens, 0);
            H2DObjs_Deallocate((adt_Element)r);
            H2DObjs_FindInDefined(H2DObjs_CurrentHeader,
                (adt_NamedElement)tobj, &e);
            if (e==0 || ((H2DObjs_Object)e)->header!=H2DObjs_CurrentHeader) {
               X2C_CALL(adt_Insert_0,
                X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                14)(H2DObjs_CurrentHeader->objects, (adt_Element)tobj);
               merge_lists(current_list_for_comments, comments, 0);
            }
            InsertToDefined((adt_NamedElement)tobj);
            if (H2DMsg_WasError) return;
            InsertToNames((adt_NamedElement)tobj, 0);
            if (H2DMsg_WasError) return;
            redefined_macro = 0;
         }
      }
   }
   else if (scan_token==6071L) {
      H2DObjs_NewMacro(scan_text->Adr, scan_text->Len0, &mac);
      GetToken(1);
      if (H2DMsg_WasError) return;
      GetToken(1);
      if (H2DMsg_WasError) return;
      while (scan_token!=6007L) {
         adt_NewNamedElement(&ne, scan_text->Adr, scan_text->Len0);
         if (scan_token==6001L) {
            InsertToList(mac->params, ne);
            if (H2DMsg_WasError) return;
         }
         else {
            Error(35L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
            return;
         }
         GetToken(1);
         if (H2DMsg_WasError) return;
         if (scan_token==6005L) {
            GetToken(1);
            if (H2DMsg_WasError) return;
         }
      }
      GetToken(1);
      if (H2DMsg_WasError) return;
      anonym1 = mac->name;
      H2DObjs_NewReplacement(&r, anonym1->Adr, anonym1->Len0);
      merge_lists(r->params, mac->params, 1);
      was_dies = 0;
      was_double_dies = 0;
      first = 1;
      adt_NewNamedElement(&ne, "", 1ul);
      while (scan_token!=6063L) {
         if (scan_token==6001L) {
            X2C_CALL(adt_SetName_,X2C_GET_TD(ne),1)(ne, scan_text->Adr,
                scan_text->Len0);
            X2C_CALL(adt_Find_0,X2C_GET_TD(r->params),11)(r->params,
                (adt_Element)ne, &e);
            if (e==0 && was_dies) {
               Error(36L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
         }
         else if (scan_token==6049L && (first || was_double_dies)) {
            Error(2L, (tmp[0].adr = "##", tmp[1].val = 0, tmp[2].val = 3u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
            return;
         }
         was_dies = scan_token==6048L;
         was_double_dies = scan_token==6049L;
         CopyToken(&token, current_token);
         X2C_CALL(adt_Insert_0,X2C_GET_TD(r->pattern),14)(r->pattern,
                (adt_Element)token);
         GetToken(1);
         if (H2DMsg_WasError) return;
         first = 0;
      }
      adt_Deallocate((adt_Element)ne);
      if (was_double_dies) {
         Error(23L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
         return;
      }
      H2DScan_GetPrevLogicalString(&mac->text);
      H2DObjs_FindInDefined(H2DObjs_CurrentHeader, (adt_NamedElement)mac,
                &e);
      if (e==0 || X2C_GET_TD(e)->base[2]==&H2DObjs_ObjectDesc_desc && ((H2DObjs_Object)
                e)->header!=H2DObjs_CurrentHeader) {
         X2C_CALL(adt_Insert_0,X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                14)(H2DObjs_CurrentHeader->objects, (adt_Element)mac);
      }
      InsertToDefined((adt_NamedElement)r);
      if (H2DMsg_WasError) return;
      redefined_macro = 0;
      X2C_CALL(adt_Insert_,X2C_GET_TD(H2DObjs_CurrentHeader->Macros),
                11)(H2DObjs_CurrentHeader->Macros, (adt_Element)mac);
      X2C_CALL(adt_Insert_,X2C_GET_TD(H2DObjs_CurrentHeader->Replacements),
                11)(H2DObjs_CurrentHeader->Replacements, (adt_Element)r);
      PopCommentsList();
   }
   else {
      Error(35L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      return;
   }
   adt_Deallocate((adt_Element)comments);
} /* end Define() */


static void Undef(void)
{
   adt_NamedElement ne = 0;
   adt_Element e = 0;
   X2C_SEQ tmp[3];
   GetToken(1);
   if (H2DMsg_WasError) return;
   switch (scan_token) {
   case 6001L:
   case 5000L:
   case 5001L:
   case 5002L:
   case 5003L:
   case 5004L:
   case 5005L:
   case 5006L:
   case 5007L:
   case 5008L:
   case 5009L:
   case 5010L:
   case 5011L:
   case 5012L:
   case 5013L:
   case 5014L:
   case 5015L:
   case 5016L:
   case 5017L:
   case 5018L:
   case 5019L:
   case 5020L:
   case 5021L:
   case 5022L:
   case 5023L:
   case 5024L:
   case 5025L:
   case 5026L:
   case 5027L:
   case 5028L:
   case 5029L:
   case 5030L:
   case 5031L:
   case 5032L:
   case 5033L:
   case 5034L:
   case 5035L:
   case 5036L:
   case 5037L:
   case 5038L:
   case 5039L:
   case 5040L:
      adt_NewNamedElement(&ne, scan_text->Adr, scan_text->Len0);
      X2C_CALL(adt_Delete_,X2C_GET_TD(H2DObjs_CurrentHeader->Macros),
                4)(H2DObjs_CurrentHeader->Macros, (adt_Element)ne);
      X2C_CALL(adt_Delete_,X2C_GET_TD(H2DObjs_CurrentHeader->defined),
                4)(H2DObjs_CurrentHeader->defined, (adt_Element)ne);
      X2C_CALL(adt_Delete_,X2C_GET_TD(H2DObjs_CurrentHeader->Replacements),
                4)(H2DObjs_CurrentHeader->Replacements, (adt_Element)ne);
      X2C_CALL(adt_Delete_,X2C_GET_TD(H2DObjs_CurrentHeader->Names),
                4)(H2DObjs_CurrentHeader->Names, (adt_Element)ne);
      X2C_CALL(adt_Find_0,X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                11)(H2DObjs_CurrentHeader->objects, (adt_Element)ne, &e);
      for (;;) {
         if (e==0) break;
         if (X2C_GET_TD(e)->base[3]==&H2DObjs_TypedObjectDesc_desc && ((H2DObjs_TypedObject)
                e)->obj==2001L || X2C_GET_TD(e)
                ->base[3]==&H2DObjs_MacroDesc_desc) {
            X2C_CALL(adt_DeleteCurrent_,
                X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                3)(H2DObjs_CurrentHeader->objects);
            X2C_CALL(adt_SetName_,X2C_GET_TD(e),1)((adt_NamedElement)e, "",
                1ul);
            break;
         }
         X2C_CALL(adt_FindAgain_,X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                10)(H2DObjs_CurrentHeader->objects, &e);
      }
      GetToken(1);
      if (H2DMsg_WasError) return;
      if (scan_token!=6063L) {
         Error(20L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
         return;
      }
      break;
   default:;
      Error(27L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      return;
   } /* end switch */
} /* end Undef() */


static void SetModifier(adt_List l, X2C_INT32 mod)
{
   H2DObjs_Modifier m = 0;
   if (mod!=3009L) {
      X2C_NEW(&H2DObjs_ModifierDesc_desc,(X2C_ADDRESS*) &m,
                sizeof(struct H2DObjs_ModifierDesc),0);
      m->modifier = mod;
      m->line = line;
      m->pos = pos;
      LongStrs_Assign(file_name->Adr, file_name->Len0, &m->file_name);
      X2C_CALL(adt_Insert_0,X2C_GET_TD(l),14)(l, (adt_Element)m);
   }
} /* end SetModifier() */


static void RemoveExpression(H2DObjs_Expression * expr)
{
   H2DObjs_Expression e = 0;
   if (*expr==0) return;
   e = *expr;
   if (X2C_GET_TD(e)->base[3]==&H2DObjs_UnaryOperationDesc_des) {
      RemoveExpression(&((H2DObjs_UnaryOperation)e)->first);
   }
   else if (X2C_GET_TD(e)->base[3]==&H2DObjs_BinaryOperationDesc_de) {
      RemoveExpression(&((H2DObjs_BinaryOperation)e)->first);
      RemoveExpression(&((H2DObjs_BinaryOperation)e)->second);
   }
   else if (X2C_GET_TD(e)->base[3]==&H2DObjs_TernaryOperationDesc_d) {
      RemoveExpression(&((H2DObjs_TernaryOperation)e)->first);
      RemoveExpression(&((H2DObjs_TernaryOperation)e)->second);
      RemoveExpression(&((H2DObjs_TernaryOperation)e)->third);
   }
   else if (X2C_GET_TD(e)->base[2]==&H2DObjs_ValueDesc_desc) {
      LongStrs_Deallocate(&((H2DObjs_Value)e)->value);
   }
   H2DObjs_Deallocate((adt_Element)*expr);
   *expr = 0;
} /* end RemoveExpression() */


static X2C_BOOLEAN IsUnaryOperation(X2C_INT32 op)
{
   return ((op==6003L || op==6027L) || op==6002L) || op==6012L;
} /* end IsUnaryOperation() */


static X2C_INT32 BinaryOperationPriority(X2C_INT32 op)
{
   X2C_INT32 j;
   X2C_INT32 i;
   for (i = 0L; i<=9L; i++) {
      for (j = 0L; j<=3L; j++) {
         if (binary_operations_priority[i][j]==op) return i;
      } /* end for */
   } /* end for */
   return -1L;
} /* end BinaryOperationPriority() */


static void InitBinaryOperationPriority(void)
{
   X2C_INT32 j;
   X2C_INT32 i;
   for (i = 0L; i<=9L; i++) {
      for (j = 0L; j<=3L; j++) {
         binary_operations_priority[i][j] = X2C_max_longint;
      } /* end for */
   } /* end for */
   binary_operations_priority[0UL][0UL] = 6019L;
   binary_operations_priority[0UL][1UL] = 6020L;
   binary_operations_priority[0UL][2UL] = 6021L;
   binary_operations_priority[1UL][0UL] = 6002L;
   binary_operations_priority[1UL][1UL] = 6003L;
   binary_operations_priority[2UL][0UL] = 6025L;
   binary_operations_priority[2UL][1UL] = 6026L;
   binary_operations_priority[3UL][0UL] = 6014L;
   binary_operations_priority[3UL][1UL] = 6015L;
   binary_operations_priority[3UL][2UL] = 6016L;
   binary_operations_priority[3UL][3UL] = 6017L;
   binary_operations_priority[4UL][0UL] = 6078L;
   binary_operations_priority[4UL][1UL] = 6018L;
   binary_operations_priority[5UL][0UL] = 6022L;
   binary_operations_priority[6UL][0UL] = 6024L;
   binary_operations_priority[7UL][0UL] = 6023L;
   binary_operations_priority[8UL][0UL] = 6029L;
   binary_operations_priority[9UL][0UL] = 6028L;
} /* end InitBinaryOperationPriority() */

static void BinaryOperation(H2DObjs_Expression *, X2C_INT32);


static void BinaryOperation(H2DObjs_Expression * expr, X2C_INT32 priority)
{
   H2DObjs_BinaryOperation bin_op = 0;
   H2DObjs_UnaryOperation un_op = 0;
   X2C_INT32 mod;
   X2C_BOOLEAN type_is_present;
   H2DObjs_Value val = 0;
   adt_Element e = 0;
   adt_NamedElement ne = 0;
   X2C_BOOLEAN tmp;
   X2C_SEQ tmp0[3];
   if (priority==-1L) {
      switch (scan_token) {
      case 6030L:
      case 6031L:
      case 6072L:
      case 6073L:
      case 6075L:
      case 6074L:
      case 6076L:
         H2DObjs_NewValue(&val);
         val->hex = 0;
         val->value = 0;
         val->type = scan_token;
         if (val->type==6074L) {
            val->type = 6072L;
            val->hex = 1;
         }
         else if (val->type==6075L) {
            val->type = 6073L;
            val->hex = 1;
         }
         LongStrs_Assign(scan_text->Adr, scan_text->Len0, &val->value);
         *expr = (H2DObjs_Expression)val;
         GetToken(1);
         if (H2DMsg_WasError) return;
         break;
      case 6001L:
         if (limited_constant_expression_on && X2C_STRCMP(scan_text->Adr,
                scan_text->Len0,"defined",8u)==0) {
            H2DObjs_NewUnaryOperation(&un_op);
            *expr = (H2DObjs_Expression)un_op;
            un_op->operation = 4503L;
            GetToken(1);
            if (H2DMsg_WasError) return;
            tmp = scan_token==6006L;
            if (tmp) {
               GetToken(1);
               if (H2DMsg_WasError) return;
            }
            if (scan_token==6001L) {
               H2DObjs_NewValue(&val);
               val->hex = 0;
               val->value = 0;
               val->type = 6031L;
               LongStrs_Assign(scan_text->Adr, scan_text->Len0, &val->value);
               un_op->first = (H2DObjs_Expression)val;
               GetToken(1);
               if (H2DMsg_WasError) return;
               if (tmp) {
                  if (scan_token==6007L) {
                     GetToken(1);
                     if (H2DMsg_WasError) return;
                  }
                  else {
                     if (!H2DObjs_pd_define_is_parsed) {
                        Error(5L, (tmp0[0].adr = "\')\'", tmp0[1].val = 0,
                tmp0[2].val = 4u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
                     }
                     RemoveExpression(expr);
                     return;
                  }
               }
            }
            else {
               if (!H2DObjs_pd_define_is_parsed) {
                  Error(27L, (tmp0[0].adr = "", tmp0[1].val = 0,
                tmp0[2].val = 1u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
               }
               RemoveExpression(expr);
               return;
            }
         }
         else {
            H2DObjs_NewValue(&val);
            val->hex = 0;
            val->value = 0;
            *expr = (H2DObjs_Expression)val;
            adt_NewNamedElement(&ne, scan_text->Adr, scan_text->Len0);
            H2DObjs_FindInNames(H2DObjs_CurrentHeader, ne, &e);
            adt_Deallocate((adt_Element)ne);
            if (e==0) {
               if (!H2DObjs_pd_define_is_parsed) {
                  val->type = 6072L;
                  LongStrs_Assign("0", 2ul, &val->value);
               }
               else {
                  RemoveExpression(expr);
                  return;
               }
            }
            else if (X2C_GET_TD(e)
                ->base[3]==&H2DObjs_TypedObjectDesc_desc && (((H2DObjs_TypedObject)
                e)->obj==2001L || !limited_constant_expression_on && ((H2DObjs_TypedObject)
                e)->obj==2004L)) {
               val->type = scan_token;
               val->tobj = (H2DObjs_TypedObject)e;
               val->value = 0;
            }
            else {
               if (!H2DObjs_pd_define_is_parsed) {
                  Error(37L, (tmp0[0].adr = "", tmp0[1].val = 0,
                tmp0[2].val = 1u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
               }
               RemoveExpression(expr);
               return;
            }
            GetToken(1);
            if (H2DMsg_WasError) return;
         }
         break;
      case 6006L:
         GetToken(1);
         if (H2DMsg_WasError) return;
         H2DObjs_NewUnaryOperation(&un_op);
         *expr = (H2DObjs_Expression)un_op;
         un_op->operation = 4502L;
         Type(&un_op->type, &mod, &type_is_present, &tmp);
         if (mod!=3009L) {
            if (!H2DObjs_pd_define_is_parsed) {
               Error(38L, (tmp0[0].adr = "", tmp0[1].val = 0,
                tmp0[2].val = 1u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
            }
            if (((un_op->type->type!=1003L && un_op->type->type!=1001L)
                && un_op->type->type!=1005L) && un_op->type->type!=1006L) {
               H2DObjs_Deallocate((adt_Element)un_op->type);
            }
            RemoveExpression(expr);
            return;
         }
         if (type_is_present) {
            if (scan_token==6007L) {
               GetToken(1);
               if (H2DMsg_WasError) return;
               ConstExpr(&un_op->first);
               if (H2DMsg_WasError) return;
               if (!was_sizeof && un_op->first==0) {
                  if (!H2DObjs_pd_define_is_parsed) {
                     Error(21L, (tmp0[0].adr = "", tmp0[1].val = 0,
                tmp0[2].val = 1u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
                  }
                  if (((un_op->type->type!=1003L && un_op->type->type!=1001L)
                 && un_op->type->type!=1005L) && un_op->type->type!=1006L) {
                     H2DObjs_Deallocate((adt_Element)un_op->type);
                  }
                  RemoveExpression(expr);
                  return;
               }
            }
            else {
               if (!H2DObjs_pd_define_is_parsed) {
                  Error(5L, (tmp0[0].adr = "\')\'", tmp0[1].val = 0,
                tmp0[2].val = 4u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
               }
               if (((un_op->type->type!=1003L && un_op->type->type!=1001L)
                && un_op->type->type!=1005L) && un_op->type->type!=1006L) {
                  H2DObjs_Deallocate((adt_Element)un_op->type);
               }
               RemoveExpression(expr);
               return;
            }
         }
         else {
            if (((un_op->type->type!=1003L && un_op->type->type!=1001L)
                && un_op->type->type!=1005L) && un_op->type->type!=1006L) {
               H2DObjs_Deallocate((adt_Element)un_op->type);
            }
            RemoveExpression(expr);
            ConstExpr(expr);
            if (H2DMsg_WasError) return;
            if (scan_token==6007L) {
               GetToken(1);
               if (H2DMsg_WasError) return;
            }
            else {
               if (!H2DObjs_pd_define_is_parsed) {
                  Error(5L, (tmp0[0].adr = "\')\'", tmp0[1].val = 0,
                tmp0[2].val = 4u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
               }
               RemoveExpression(expr);
               return;
            }
         }
         break;
      default:;
         if (IsUnaryOperation(scan_token)) {
            H2DObjs_NewUnaryOperation(&un_op);
            *expr = (H2DObjs_Expression)un_op;
            un_op->operation = scan_token;
            GetToken(1);
            if (H2DMsg_WasError) return;
            BinaryOperation(&un_op->first, -1L);
            if (H2DMsg_WasError) return;
            if (un_op->first==0) {
               if (!H2DObjs_pd_define_is_parsed) {
                  Error(21L, (tmp0[0].adr = "", tmp0[1].val = 0,
                tmp0[2].val = 1u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
               }
               RemoveExpression(expr);
               return;
            }
         }
         else if (!limited_constant_expression_on && scan_token==5024L) {
            was_sizeof = 1;
            GetToken(1);
            if (H2DMsg_WasError) return;
            H2DObjs_NewUnaryOperation(&un_op);
            *expr = (H2DObjs_Expression)un_op;
            un_op->operation = 4501L;
            ConstExpr(&un_op->first);
            if (H2DMsg_WasError) return;
            if (un_op->first==0) {
               if (!H2DObjs_pd_define_is_parsed) {
                  Error(21L, (tmp0[0].adr = "", tmp0[1].val = 0,
                tmp0[2].val = 1u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
               }
               RemoveExpression(expr);
               return;
            }
            if (((H2DObjs_Operation)un_op->first)
                ->operation==4502L && ((H2DObjs_UnaryOperation)un_op->first)
                ->first==0) {
               un_op->type = ((H2DObjs_UnaryOperation)un_op->first)->type;
               RemoveExpression(&un_op->first);
            }
            else un_op->type = 0;
            was_sizeof = 0;
         }
         else RemoveExpression(expr);
         break;
      } /* end switch */
   }
   else {
      H2DObjs_NewBinaryOperation(&bin_op);
      *expr = (H2DObjs_Expression)bin_op;
      BinaryOperation(&bin_op->first, priority-1L);
      if (H2DMsg_WasError) return;
      if (bin_op->first) {
         if (scan_token==6031L) {
            if (X2C_GET_TD(bin_op->first)
                ->base[2]==&H2DObjs_ValueDesc_desc && ((H2DObjs_Value)
                bin_op->first)->type==6031L || X2C_GET_TD(bin_op->first)
                ->base[3]==&H2DObjs_BinaryOperationDesc_de && ((H2DObjs_BinaryOperation)
                bin_op->first)->operation==4504L) {
               bin_op->operation = 4504L;
               H2DObjs_NewValue(&val);
               val->hex = 0;
               val->value = 0;
               val->type = 6031L;
               LongStrs_Assign(scan_text->Adr, scan_text->Len0, &val->value);
               bin_op->second = (H2DObjs_Expression)val;
               GetToken(1);
               if (H2DMsg_WasError) return;
            }
            else {
               if (!H2DObjs_pd_define_is_parsed) {
                  Error(39L, (tmp0[0].adr = "", tmp0[1].val = 0,
                tmp0[2].val = 1u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
               }
               RemoveExpression(expr);
            }
         }
         else if (BinaryOperationPriority(scan_token)==priority) {
            bin_op->operation = scan_token;
            GetToken(1);
            if (H2DMsg_WasError) return;
            BinaryOperation(&bin_op->second, priority-1L);
            if (H2DMsg_WasError) return;
            if (bin_op->second==0) {
               if (!H2DObjs_pd_define_is_parsed) {
                  Error(21L, (tmp0[0].adr = "", tmp0[1].val = 0,
                tmp0[2].val = 1u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
               }
               RemoveExpression(expr);
               return;
            }
            while (BinaryOperationPriority(scan_token)==priority) {
               H2DObjs_NewBinaryOperation(&bin_op);
               bin_op->operation = scan_token;
               bin_op->first = *expr;
               *expr = (H2DObjs_Expression)bin_op;
               GetToken(1);
               if (H2DMsg_WasError) return;
               BinaryOperation(&bin_op->second, priority-1L);
               if (H2DMsg_WasError) return;
               if (bin_op->second==0) {
                  if (!H2DObjs_pd_define_is_parsed) {
                     Error(21L, (tmp0[0].adr = "", tmp0[1].val = 0,
                tmp0[2].val = 1u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
                  }
                  RemoveExpression(expr);
                  return;
               }
            }
         }
         else {
            *expr = bin_op->first;
            H2DObjs_Deallocate((adt_Element)bin_op);
         }
      }
      else {
         if (!H2DObjs_pd_define_is_parsed) {
            Error(21L, (tmp0[0].adr = "", tmp0[1].val = 0,
                tmp0[2].val = 1u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
         }
         RemoveExpression(expr);
         return;
      }
   }
} /* end BinaryOperation() */


static void ConstExpr(H2DObjs_Expression * expr)
{
   H2DObjs_TernaryOperation ter_op = 0;
   H2DObjs_ConstantValue res = 0;
   X2C_INT32 pos0;
   X2C_INT32 line0;
   X2C_SEQ tmp[3];
   line0 = current_token->line0;
   pos0 = current_token->pos0;
   H2DObjs_line = current_token->line0;
   H2DObjs_pos = current_token->pos0;
   was_sizeof = 0;
   H2DObjs_NewTernaryOperation(&ter_op);
   *expr = (H2DObjs_Expression)ter_op;
   BinaryOperation(&ter_op->first, 9L);
   if (H2DMsg_WasError) return;
   if (ter_op->first) {
      if (scan_token==6011L) {
         ter_op->operation = scan_token;
         GetToken(1);
         if (H2DMsg_WasError) return;
         BinaryOperation(&ter_op->second, 9L);
         if (H2DMsg_WasError) return;
         if (ter_op->second==0) {
            if (!H2DObjs_pd_define_is_parsed) {
               Error(21L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               RemoveExpression(expr);
            }
            return;
         }
         if (scan_token==6000L) {
            GetToken(1);
            if (H2DMsg_WasError) return;
            BinaryOperation(&ter_op->third, 9L);
            if (H2DMsg_WasError) return;
            if (ter_op->third==0) {
               if (!H2DObjs_pd_define_is_parsed) {
                  Error(21L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               }
               RemoveExpression(expr);
               return;
            }
         }
         else {
            if (!H2DObjs_pd_define_is_parsed) {
               Error(5L, (tmp[0].adr = "\':\'", tmp[1].val = 0,
                tmp[2].val = 4u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
            }
            RemoveExpression(expr);
            return;
         }
      }
      else {
         *expr = ter_op->first;
         H2DObjs_Deallocate((adt_Element)ter_op);
      }
   }
   else {
      if (!H2DObjs_pd_define_is_parsed) {
         Error(21L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      }
      RemoveExpression(expr);
      return;
   }
   if (*expr) {
      X2C_CALL(H2DObjs_ComputeExpression_,X2C_GET_TD(*expr),2)(*expr, &res,
                limited_constant_expression_on);
      (*expr)->line = line0;
      (*expr)->pos = pos0;
      if (H2DObjs_pd_define_is_parsed && res==0) RemoveExpression(expr);
      H2DObjs_Deallocate((adt_Element)res);
   }
} /* end ConstExpr() */


static void get_modifiers(adt_List * dst_modifier, H2DObjs_Type * dst_type,
                adt_List src_modifier, H2DObjs_Type src_type)
{
   adt_Element e = 0;
   adt_NewList(dst_modifier);
   *dst_type = src_type;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(src_modifier),6)(src_modifier, &e);
   while (e) {
      X2C_CALL(adt_Insert_0,X2C_GET_TD(*dst_modifier),14)(*dst_modifier, e);
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(src_modifier),8)(src_modifier, &e);
   }
   while (*dst_type && (*dst_type)->type==1003L) {
      X2C_CALL(adt_FindFirst_0,X2C_GET_TD((*dst_type)->modifier),
                6)((*dst_type)->modifier, &e);
      while (e) {
         X2C_CALL(adt_Insert_0,X2C_GET_TD(*dst_modifier),14)(*dst_modifier,
                e);
         X2C_CALL(adt_FindNext_0,X2C_GET_TD((*dst_type)->modifier),
                8)((*dst_type)->modifier, &e);
      }
      *dst_type = (*dst_type)->base;
   }
} /* end get_modifiers() */


static void CheckDuplicateModifiers(adt_List mod_list)
{
   adt_List new_list = 0;
   adt_Element e1 = 0;
   adt_Element e = 0;
   X2C_SEQ tmp[3];
   adt_NewList(&new_list);
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(mod_list),6)(mod_list, &e);
   while (e) {
      X2C_CALL(adt_Find_0,X2C_GET_TD(new_list),11)(new_list, e, &e1);
      if (e1==0) X2C_CALL(adt_Insert_0,X2C_GET_TD(new_list),14)(new_list, e);
      else {
         line = ((H2DObjs_Modifier)e)->line;
         pos = ((H2DObjs_Modifier)e)->pos;
         Error(40L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
         return;
      }
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(mod_list),8)(mod_list, &e);
   }
   adt_Deallocate((adt_Element)new_list);
} /* end CheckDuplicateModifiers() */

static void CheckTypeModifiers(H2DObjs_Type);


static void CheckTypeModifiers(H2DObjs_Type host_type)
{
   adt_Element e = 0;
   X2C_BOOLEAN was_location_modifier;
   X2C_BOOLEAN was_language_modifier;
   X2C_BOOLEAN was_interrupt_modifier;
   X2C_BOOLEAN was_status_modifier;
   X2C_BOOLEAN was_syscall_modifier;
   adt_List modifier = 0;
   H2DObjs_Type type = 0;
   X2C_SEQ tmp[3];
   if (host_type==0) return;
   was_language_modifier = 0;
   was_location_modifier = 0;
   was_status_modifier = 0;
   was_interrupt_modifier = 0;
   was_syscall_modifier = 0;
   get_modifiers(&modifier, &type, host_type->modifier, host_type->base);
   if (!X2C_CALL(adt_IsEmpty_1,X2C_GET_TD(modifier),4)(modifier) && type==0) {
      X2C_CALL(adt_FindFirst_0,X2C_GET_TD(modifier),6)(modifier, &e);
      line = ((H2DObjs_Modifier)e)->line;
      pos = ((H2DObjs_Modifier)e)->pos;
      Error(38L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      return;
   }
   if (type==0) {
      adt_Deallocate((adt_Element)modifier);
      return;
   }
   CheckDuplicateModifiers(modifier);
   if (H2DMsg_WasError) return;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(modifier),6)(modifier, &e);
   while (e) {
      if (X2C_GET_TD(e)->base[1]==&H2DObjs_ModifierDesc_desc) {
         switch (((H2DObjs_Modifier)e)->modifier) {
         case 5034L:
         case 5035L:
         case 5036L:
            if (was_syscall_modifier || was_language_modifier) {
               line = ((H2DObjs_Modifier)e)->line;
               pos = ((H2DObjs_Modifier)e)->pos;
               Error(38L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            was_language_modifier = 1;
            break;
         case 5033L:
            if (was_interrupt_modifier) {
               line = ((H2DObjs_Modifier)e)->line;
               pos = ((H2DObjs_Modifier)e)->pos;
               Error(38L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            was_interrupt_modifier = 1;
            if (type->type!=1004L) {
               line = ((H2DObjs_Modifier)e)->line;
               pos = ((H2DObjs_Modifier)e)->pos;
               Error(38L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            break;
         case 5037L:
            if (was_syscall_modifier || was_language_modifier) {
               line = ((H2DObjs_Modifier)e)->line;
               pos = ((H2DObjs_Modifier)e)->pos;
               Error(38L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            was_syscall_modifier = 1;
            if (type->type!=1004L) {
               line = ((H2DObjs_Modifier)e)->line;
               pos = ((H2DObjs_Modifier)e)->pos;
               Error(38L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            break;
         case 5009L:
         case 5032L:
            if (was_status_modifier) {
               line = ((H2DObjs_Modifier)e)->line;
               pos = ((H2DObjs_Modifier)e)->pos;
               Error(38L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            was_status_modifier = 1;
            if (type->type==1004L || host_type->type==1004L) {
               line = ((H2DObjs_Modifier)e)->line;
               pos = ((H2DObjs_Modifier)e)->pos;
               Error(38L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            break;
         case 5038L:
         case 5039L:
         case 5040L:
            if (was_location_modifier) {
               line = ((H2DObjs_Modifier)e)->line;
               pos = ((H2DObjs_Modifier)e)->pos;
               Error(38L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            was_location_modifier = 1;
            if ((type->type!=1004L && type->type!=1000L)
                && type->type!=1002L) {
               line = ((H2DObjs_Modifier)e)->line;
               pos = ((H2DObjs_Modifier)e)->pos;
               Error(38L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            break;
         default:
            X2C_TRAP(X2C_CASE_TRAP);
         } /* end switch */
      }
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(modifier),8)(modifier, &e);
   }
   adt_Deallocate((adt_Element)modifier);
   CheckTypeModifiers(type->base);
} /* end CheckTypeModifiers() */


static void CheckModifiers(H2DObjs_TypedObject tobj,
                X2C_BOOLEAN struct_or_union)
{
   adt_Element e = 0;
   X2C_BOOLEAN was_location_modifier;
   X2C_BOOLEAN was_language_modifier;
   X2C_BOOLEAN was_interrupt_modifier;
   X2C_BOOLEAN was_status_modifier;
   X2C_BOOLEAN was_syscall_modifier;
   adt_List modifier = 0;
   H2DObjs_Type type = 0;
   X2C_SEQ tmp[3];
   if (tobj==0) return;
   was_language_modifier = 0;
   was_location_modifier = 0;
   was_status_modifier = 0;
   was_interrupt_modifier = 0;
   was_syscall_modifier = 0;
   get_modifiers(&modifier, &type, tobj->modifier, tobj->type);
   CheckDuplicateModifiers(modifier);
   if (H2DMsg_WasError) return;
   X2C_CALL(adt_FindFirst_0,X2C_GET_TD(modifier),6)(modifier, &e);
   while (e) {
      if (X2C_GET_TD(e)->base[1]==&H2DObjs_ModifierDesc_desc) {
         switch (((H2DObjs_Modifier)e)->modifier) {
         case 5034L:
         case 5035L:
         case 5036L:
            if (struct_or_union) {
               line = ((H2DObjs_Modifier)e)->line;
               pos = ((H2DObjs_Modifier)e)->pos;
               Error(38L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            if (was_syscall_modifier || was_language_modifier) {
               line = ((H2DObjs_Modifier)e)->line;
               pos = ((H2DObjs_Modifier)e)->pos;
               Error(38L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            was_language_modifier = 1;
            break;
         case 5033L:
            if (was_interrupt_modifier) {
               line = ((H2DObjs_Modifier)e)->line;
               pos = ((H2DObjs_Modifier)e)->pos;
               Error(38L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            was_interrupt_modifier = 1;
            if (type->type!=1004L) {
               line = ((H2DObjs_Modifier)e)->line;
               pos = ((H2DObjs_Modifier)e)->pos;
               Error(38L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            break;
         case 5037L:
            if (was_syscall_modifier || was_language_modifier) {
               line = ((H2DObjs_Modifier)e)->line;
               pos = ((H2DObjs_Modifier)e)->pos;
               Error(38L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            was_syscall_modifier = 1;
            if (type->type!=1004L) {
               line = ((H2DObjs_Modifier)e)->line;
               pos = ((H2DObjs_Modifier)e)->pos;
               Error(38L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            break;
         case 5009L:
         case 5032L:
            if (was_status_modifier) {
               line = ((H2DObjs_Modifier)e)->line;
               pos = ((H2DObjs_Modifier)e)->pos;
               Error(38L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            was_status_modifier = 1;
            if (type->type==1004L) {
               line = ((H2DObjs_Modifier)e)->line;
               pos = ((H2DObjs_Modifier)e)->pos;
               Error(38L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            break;
         case 5038L:
         case 5039L:
         case 5040L:
            if (was_location_modifier) {
               line = ((H2DObjs_Modifier)e)->line;
               pos = ((H2DObjs_Modifier)e)->pos;
               Error(38L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            was_location_modifier = 1;
            if ((type->type!=1004L && type->type!=1000L)
                && type->type!=1002L) {
               line = ((H2DObjs_Modifier)e)->line;
               pos = ((H2DObjs_Modifier)e)->pos;
               Error(38L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            break;
         default:
            X2C_TRAP(X2C_CASE_TRAP);
         } /* end switch */
      }
      X2C_CALL(adt_FindNext_0,X2C_GET_TD(modifier),8)(modifier, &e);
   }
   adt_Deallocate((adt_Element)modifier);
   CheckTypeModifiers(type);
} /* end CheckModifiers() */

static void Descriptor(H2DObjs_TypedObject *, H2DObjs_Type *);


static void Params(adt_List * to)
{
   H2DObjs_Type last_type = 0;
   H2DObjs_Type type = 0;
   X2C_INT32 modifier;
   X2C_INT32 mem_class;
   H2DObjs_TypedObject tobj = 0;
   X2C_BOOLEAN type_is_present;
   H2DScan_Token token = 0;
   X2C_BOOLEAN tmp;
   LongStrs_String anonym = 0;
   X2C_SEQ tmp0[3];
   if (scan_token==6006L) {
      current_token->boundary = 1;
      PushCommentsList(*to);
      do {
         GetToken(1);
         if (H2DMsg_WasError) return;
         if (scan_token==6004L) {
            H2DObjs_NewTypedObject(&tobj, 2003L);
            X2C_CALL(adt_SetName_,X2C_GET_TD(tobj),1)((adt_NamedElement)tobj,
                 "", 1ul);
            tobj->line = line;
            SetFileName(&tobj->file, file_name);
            InsertToList(*to, (adt_NamedElement)tobj);
            GetToken(1);
            if (H2DMsg_WasError) return;
            if (scan_token!=6007L) {
               Error(5L, (tmp0[0].adr = "\')\'", tmp0[1].val = 0,
                tmp0[2].val = 4u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
               return;
            }
         }
         else if (scan_token==6007L) {
            H2DObjs_NewTypedObject(&tobj, 2003L);
            X2C_CALL(adt_SetName_,X2C_GET_TD(tobj),1)((adt_NamedElement)tobj,
                 "", 1ul);
            tobj->line = line;
            SetFileName(&tobj->file, file_name);
            InsertToList(*to, (adt_NamedElement)tobj);
         }
         else {
            Memory_Class(&mem_class);
            if (H2DMsg_WasError) return;
            if (mem_class!=5020L && mem_class!=4000L) {
               Error(41L, (tmp0[0].adr = "", tmp0[1].val = 0,
                tmp0[2].val = 1u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
               return;
            }
            Type(&type, &modifier, &type_is_present, &tmp);
            while (((((((((((scan_token==6006L || scan_token==6019L)
                || scan_token==5032L) || scan_token==5009L)
                || scan_token==5034L) || scan_token==5035L)
                || scan_token==5033L) || scan_token==5036L)
                || scan_token==5037L) || scan_token==5038L)
                || scan_token==5039L) || scan_token==5040L) {
               GetToken(0);
               if (H2DMsg_WasError) return;
            }
            if (scan_token!=6001L) {
               CopyToken(&token, current_token);
               LongStrs_Assign("", 1ul, &token->text);
               token->token = 6001L;
               X2C_CALL(adt_InsertBeforeCurrent_,X2C_GET_TD(token_list),
                12)(token_list, (adt_Element)token);
            }
            while (scan_token!=6079L) prev_token();
            next_token();
            if (H2DMsg_WasError) return;
            Descriptor(&tobj, &last_type);
            if (H2DMsg_WasError) return;
            if (last_type) {
               if ((IsType(type, 12L) && last_type->type!=1004L) && last_type->type!=1000L) {
                  Error(42L, (tmp0[0].adr = "", tmp0[1].val = 0,
                tmp0[2].val = 1u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
                  return;
               }
               last_type->base = type;
               SetModifier(last_type->modifier, modifier);
            }
            else {
               if (IsType(type, 12L)) {
                  if ((anonym = tobj->name,
                anonym->Adr[0]==0) && mem_class==4000L) {
                     if (scan_token!=6007L) {
                        Error(5L, (tmp0[0].adr = "\')\'", tmp0[1].val = 0,
                tmp0[2].val = 4u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
                        return;
                     }
                     H2DObjs_Deallocate((adt_Element)type);
                     H2DObjs_Deallocate((adt_Element)tobj);
                     type = 0;
                     tobj = 0;
                  }
                  else {
                     Error(42L, (tmp0[0].adr = "", tmp0[1].val = 0,
                tmp0[2].val = 1u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
                     return;
                  }
               }
               if (tobj) {
                  tobj->type = type;
                  SetModifier(tobj->modifier, modifier);
               }
            }
            if (tobj) {
               if (IsType(tobj->type, 1004L)) {
                  H2DObjs_NewType(&type);
                  type->type = 1000L;
                  type->base = tobj->type;
                  tobj->type = type;
               }
               CheckModifiers(tobj, 0);
               if (H2DMsg_WasError) return;
               tobj->mem_class = mem_class;
               InsertToList(*to, (adt_NamedElement)tobj);
               if (H2DMsg_WasError) return;
            }
         }
      } while (scan_token==6005L);
      PopCommentsList();
      if (scan_token==6007L) {
         GetToken(1);
         if (H2DMsg_WasError) return;
         open_boundary();
      }
      else {
         Error(5L, (tmp0[0].adr = "\')\'", tmp0[1].val = 0,
                tmp0[2].val = 4u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
         return;
      }
   }
   else {
      Error(5L, (tmp0[0].adr = "\'(\'", tmp0[1].val = 0, tmp0[2].val = 4u-1,
                (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
      return;
   }
} /* end Params() */


static void CheckIntType(H2DObjs_TypedObject tobj)
{
   H2DObjs_Type type = 0;
   X2C_SEQ tmp[3];
   type = tobj->type;
   while (type->type==1003L) type = type->base;
   if (((((((type->type && type->type!=1L) && type->type!=2L)
                && type->type!=3L) && type->type!=4L) && type->type!=5L)
                && type->type!=6L) && type->type!=7L) {
      Error(44L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      return;
   }
} /* end CheckIntType() */


static void Descriptor(H2DObjs_TypedObject * tobj, H2DObjs_Type * type)
{
   H2DObjs_Type tmp_type = 0;
   X2C_BOOLEAN first_dim;
   adt_List modifier = 0;
   X2C_SEQ tmp[3];
   *type = 0;
   H2DObjs_NewTypedObject(tobj, 2000L);
   modifier = (*tobj)->modifier;
   while (((((((((((scan_token==6006L || scan_token==6019L)
                || scan_token==5032L) || scan_token==5009L)
                || scan_token==5034L) || scan_token==5035L)
                || scan_token==5033L) || scan_token==5036L)
                || scan_token==5037L) || scan_token==5038L)
                || scan_token==5039L) || scan_token==5040L) {
      GetToken(0);
      if (H2DMsg_WasError) return;
   }
   if (scan_token!=6001L) {
      Error(55L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      return;
   }
   X2C_CALL(adt_SetName_,X2C_GET_TD(*tobj),1)((adt_NamedElement)*tobj,
                scan_text->Adr, scan_text->Len0);
   (*tobj)->line = line;
   SetFileName(&(*tobj)->file, file_name);
   prev_token();
   for (;;) {
      switch (scan_token) {
      case 5032L:
      case 5009L:
         break;
      case 5034L:
      case 5035L:
      case 5033L:
      case 5037L:
      case 5036L:
      case 5038L:
      case 5039L:
      case 5040L:
         current_token->parsed = 1;
         SetModifier(modifier, scan_token);
         break;
      default:;
         goto loop_exit;
      } /* end switch */
      prev_token();
   }
   loop_exit:;
   while (scan_token!=6001L) {
      next_token();
      if (H2DMsg_WasError) return;
   }
   current_token->parsed = 1;
   for (;;) {
      GetToken(0);
      if (H2DMsg_WasError) return;
      if (scan_token==6006L) {
         H2DObjs_NewType(&tmp_type);
         tmp_type->type = 1004L;
         Params(&tmp_type->vars);
         if (H2DMsg_WasError) return;
         if ((*tobj)->type==0) (*tobj)->type = tmp_type;
         else {
            (*type)->base = tmp_type;
            modifier = (*type)->modifier;
         }
         *type = tmp_type;
      }
      else if (scan_token==6045L) {
         first_dim = 1;
         do {
            H2DObjs_NewType(&tmp_type);
            tmp_type->type = 1002L;
            GetToken(1);
            if (H2DMsg_WasError) return;
            if (!first_dim || scan_token!=6046L) {
               ConstExpr(&tmp_type->expr);
               if (H2DMsg_WasError) return;
            }
            if (tmp_type->expr==0) {
               if (!first_dim) {
                  Error(21L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                  return;
               }
            }
            else {
               CheckIntExpr(tmp_type->expr, 1L);
               if (H2DMsg_WasError) return;
            }
            if (scan_token==6046L) {
               first_dim = 0;
               if ((*tobj)->type==0) (*tobj)->type = tmp_type;
               else {
                  (*type)->base = tmp_type;
                  modifier = (*type)->modifier;
               }
               *type = tmp_type;
               GetToken(1);
               if (H2DMsg_WasError) return;
            }
            else {
               Error(5L, (tmp[0].adr = "\']\'", tmp[1].val = 0,
                tmp[2].val = 4u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
         } while (scan_token==6045L);
      }
      for (;;) {
         prev_token();
         if (scan_token==6079L) {
            next_token();
            return;
         }
         switch (scan_token) {
         case 5032L:
         case 5009L:
            current_token->parsed = 1;
            if (*type==0) SetModifier((*tobj)->modifier, scan_token);
            else SetModifier((*type)->modifier, scan_token);
            break;
         case 5034L:
         case 5035L:
         case 5036L:
            if (*type) {
               current_token->parsed = 1;
               if ((*type)->type==1004L) SetModifier(modifier, scan_token);
               else if ((*type)->type==1000L) {
                  if ((*type)->ptr_modifier->modifier==3009L) {
                     (*type)->ptr_modifier->modifier = scan_token;
                  }
                  else {
                     Error(38L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                     return;
                  }
               }
               else SetModifier((*type)->modifier, scan_token);
            }
            else {
               Error(38L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            break;
         case 5033L:
         case 5037L:
            if (*type) {
               current_token->parsed = 1;
               if ((*type)->type==1004L) SetModifier(modifier, scan_token);
               else SetModifier((*type)->modifier, scan_token);
            }
            else {
               Error(38L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            break;
         case 5038L:
         case 5039L:
         case 5040L:
            if (*type) {
               current_token->parsed = 1;
               SetModifier(modifier, scan_token);
            }
            else {
               Error(38L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            break;
         case 6019L:
            H2DObjs_NewType(&tmp_type);
            tmp_type->type = 1000L;
            if ((*tobj)->type==0) (*tobj)->type = tmp_type;
            else {
               (*type)->base = tmp_type;
               modifier = (*type)->modifier;
            }
            *type = tmp_type;
            current_token->parsed = 1;
            break;
         case 6006L:
            current_token->parsed = 1;
            next_token();
            if (H2DMsg_WasError) return;
            if (scan_token==6007L) current_token->parsed = 1;
            else {
               Error(5L, (tmp[0].adr = "\')\'", tmp[1].val = 0,
                tmp[2].val = 4u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            goto loop_exit0;
         default:;
            Error(5L, (tmp[0].adr = "\'*\', \'(\'", tmp[1].val = 0,
                tmp[2].val = 9u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
            return;
         } /* end switch */
      }
      loop_exit0:;
   }
} /* end Descriptor() */


static void Declarations(X2C_BOOLEAN struct_or_union, adt_List to)
{
   H2DObjs_Type last_type = 0;
   H2DObjs_Type type = 0;
   H2DObjs_Type syn = 0;
   H2DObjs_TypedObject tobj = 0;
   X2C_INT32 modifier;
   X2C_INT32 mem_class;
   X2C_BOOLEAN typedef0;
   X2C_BOOLEAN typedef_from_pretext;
   H2DObjs_Expression expr = 0;
   X2C_INT32 brackets_balance;
   X2C_BOOLEAN tmp;
   X2C_BOOLEAN tag_was_parsed0;
   adt_Element e = 0;
   LongStrs_String anonym = 0;
   X2C_SEQ tmp0[3];
   tobj = 0;
   last_type = 0;
   syn = 0;
   type = 0;
   mem_class = 4000L;
   for (;;) {
      typedef0 = 0;
      typedef_from_pretext = 0;
      if (scan_token==6064L || struct_or_union && scan_token==6009L) return;
      if (!struct_or_union) {
         if (scan_token==5027L) {
            typedef0 = 1;
            typedef_from_pretext = current_token->pretoken;
            GetToken(1);
            if (H2DMsg_WasError) return;
         }
         else {
            Memory_Class(&mem_class);
            if (H2DMsg_WasError) return;
            if (mem_class==5003L || mem_class==5020L) {
               Error(41L, (tmp0[0].adr = "", tmp0[1].val = 0,
                tmp0[2].val = 1u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
               return;
            }
         }
      }
      Type(&type, &modifier, &tmp, &tag_was_parsed0);
      if (H2DMsg_WasError) return;
      if (tag_was_parsed0 && scan_token==6010L) {
         GetToken(1);
         if (H2DMsg_WasError) return;
      }
      else if ((!tag_was_parsed0 && scan_token==6010L) && type->type==1006L) {
         X2C_CALL(adt_SetName_,X2C_GET_TD(type),1)((adt_NamedElement)type, "U\
nnamed!!!", 11ul);
         X2C_CALL(adt_Insert_0,X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                14)(H2DObjs_CurrentHeader->objects, (adt_Element)type);
         GetToken(1);
         if (H2DMsg_WasError) return;
      }
      else {
         for (;;) {
            if (scan_token==6000L) {
               H2DObjs_NewTypedObject(&tobj, 2002L);
               X2C_CALL(adt_SetName_,X2C_GET_TD(tobj),
                1)((adt_NamedElement)tobj, "", 1ul);
               tobj->line = line;
               SetFileName(&tobj->file, file_name);
               last_type = 0;
            }
            else {
               Descriptor(&tobj, &last_type);
               if (H2DMsg_WasError) return;
            }
            if (last_type) {
               if ((IsType(type, 12L) && last_type->type!=1004L) && last_type->type!=1000L) {
                  Error(42L, (tmp0[0].adr = "", tmp0[1].val = 0,
                tmp0[2].val = 1u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
                  return;
               }
               last_type->base = type;
               SetModifier(last_type->modifier, modifier);
            }
            else {
               if (IsType(type, 12L) && !typedef0) {
                  Error(42L, (tmp0[0].adr = "", tmp0[1].val = 0,
                tmp0[2].val = 1u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
                  return;
               }
               tobj->type = type;
               SetModifier(tobj->modifier, modifier);
            }
            CheckModifiers(tobj, struct_or_union);
            if (H2DMsg_WasError) return;
            if (struct_or_union && scan_token==6000L) {
               GetToken(1);
               if (H2DMsg_WasError) return;
               ConstExpr(&expr);
               if (H2DMsg_WasError) return;
               if (expr==0) {
                  Error(21L, (tmp0[0].adr = "", tmp0[1].val = 0,
                tmp0[2].val = 1u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
                  return;
               }
               CheckIntExpr(expr, 0L);
               if (H2DMsg_WasError) return;
               CheckIntType(tobj);
               if (H2DMsg_WasError) return;
               tobj->expr = expr;
               tobj->obj = 2002L;
            }
            if (typedef0) {
               H2DObjs_NewType(&syn);
               syn->type = 1003L;
               anonym = tobj->name;
               X2C_CALL(adt_SetName_,X2C_GET_TD(syn),
                1)((adt_NamedElement)syn, anonym->Adr, anonym->Len0);
               syn->line = tobj->line;
               SetFileName(&syn->file, tobj->file);
               syn->base = tobj->type;
               merge_lists(syn->modifier, tobj->modifier, 0);
               syn->created_by_back_end = typedef_from_pretext;
               X2C_CALL(adt_Insert_0,
                X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                14)(H2DObjs_CurrentHeader->objects, (adt_Element)syn);
               InsertToNames((adt_NamedElement)syn, 0);
               H2DObjs_Deallocate((adt_Element)tobj);
               tobj = 0;
               if (H2DMsg_WasError) return;
            }
            else {
               tobj->mem_class = mem_class;
               CheckFullDefinition(tobj);
               if (H2DMsg_WasError) return;
               if (struct_or_union && tobj->type->type==1004L) {
                  Error(45L, (tmp0[0].adr = "", tmp0[1].val = 0,
                tmp0[2].val = 1u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
                  return;
               }
               if (struct_or_union) {
                  InsertToList(to, (adt_NamedElement)tobj);
                  if (H2DMsg_WasError) return;
               }
               else {
                  H2DObjs_FindInNames(H2DObjs_CurrentHeader,
                (adt_NamedElement)tobj, &e);
                  if (e==0 || tobj->header!=((H2DObjs_Object)e)->header) {
                     X2C_CALL(adt_Insert_0,
                X2C_GET_TD(H2DObjs_CurrentHeader->objects),
                14)(H2DObjs_CurrentHeader->objects, (adt_Element)tobj);
                  }
                  InsertToNames((adt_NamedElement)tobj, 1);
                  if (H2DMsg_WasError) return;
               }
            }
            if (((scan_token==6013L && !struct_or_union) && !typedef0)
                && mem_class!=5014L) {
               tobj->mem_class = 5023L;
               GetToken(1);
               if (H2DMsg_WasError) return;
               if (scan_token==6008L) {
                  brackets_balance = 0L;
                  for (;;) {
                     if (scan_token==6008L) ++brackets_balance;
                     else if (scan_token==6009L && brackets_balance>0L) {
                        --brackets_balance;
                     }
                     else {
                        if (brackets_balance==0L) break;
                        if (scan_token==6010L || scan_token==6064L) {
                           Error(5L, (tmp0[0].adr = "\'}\'", tmp0[1].val = 0,
                 tmp0[2].val = 4u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
                           return;
                        }
                     }
                     GetToken(1);
                     if (H2DMsg_WasError) return;
                  }
               }
               else {
                  while (scan_token!=6010L && scan_token!=6005L) {
                     GetToken(1);
                     if (H2DMsg_WasError) return;
                  }
               }
            }
            if (scan_token==6010L) {
               GetToken(1);
               if (H2DMsg_WasError) return;
               break;
            }
            if (scan_token==6005L) {
               GetToken(1);
               if (H2DMsg_WasError) return;
            }
            else {
               Error(5L, (tmp0[0].adr = "\',\' \';\'", tmp0[1].val = 0,
                tmp0[2].val = 8u-1, (X2C_LOC *)tmp0), 3ul*sizeof(X2C_SEQ));
               return;
            }
         }
      }
   }
} /* end Declarations() */


static void Init(void)
{
   redefined_macro = 0;
   H2DObjs_pd_define_is_parsed = 0;
   current_list_for_comments = 0;
   adt_Deallocate((adt_Element)comments_lists_stack);
   adt_NewStack(&comments_lists_stack);
   adt_Deallocate((adt_Element)pretext_list);
   adt_NewList(&pretext_list);
   merge_lists(pretext_list, prepretext_list, 0);
   adt_Deallocate((adt_Element)headers_stack);
   adt_NewStack(&headers_stack);
   adt_Deallocate((adt_Element)merge_headers_tree);
   adt_NewTree(&merge_headers_tree);
   merge_trees(merge_headers_tree, project_merge_headers_tree);
   H2DScan_Init();
} /* end Init() */


extern void H2DParse_Parse(X2C_CHAR name[], X2C_CARD32 name_len,
                X2C_BOOLEAN cstdlib)
{
   adt_Element e = 0;
   adt_NamedElement ne = 0;
   X2C_BOOLEAN was_push;
   X2C_NEW(&H2DScan_TokenDesc_desc,(X2C_ADDRESS*) &current_token,
                sizeof(struct H2DScan_TokenDesc),0);
   adt_NewList(&token_list);
   include_balance = 0L;
   if_balance = 0L;
   adt_NewStack(&if_stack);
   end_balance = 0L;
   C_extensions = 1;
   config_on = 0;
   project_on = 0;
   H2DScan_prj_cfg_on = config_on || project_on;
   if (header_balance==0L) {
      LongStrs_Assign(name, name_len, &file_name);
      line = 1L;
      pos = 1L;
      Init();
   }
   ++header_balance;
   adt_NewNamedElement(&ne, name, name_len);
   X2C_CALL(adt_Find_0,X2C_GET_TD(H2DObjs_Headers),11)(H2DObjs_Headers,
                (adt_Element)ne, &e);
   adt_Deallocate((adt_Element)ne);
   if (e==0) {
      if (Open(name, name_len, 1)) {
         H2DObjs_NewHeader(name, name_len, &H2DObjs_CurrentHeader);
         if (header_balance==1L) {
            HeadHeader = H2DObjs_CurrentHeader;
            if (H2DCfg_IncludingTree) {
               H2DMsg_OpenLogFile(name, name_len, H2DCfg_TreeExtension->Adr,
                H2DCfg_TreeExtension->Len0, HeadHeader->stat);
            }
            if (H2DCfg_StrippingDirs) {
               H2DMsg_OpenDirFile(name, name_len, H2DCfg_DirExtension->Adr,
                H2DCfg_DirExtension->Len0);
            }
         }
         X2C_CALL(adt_Insert_0,X2C_GET_TD(H2DObjs_Headers),
                14)(H2DObjs_Headers, (adt_Element)H2DObjs_CurrentHeader);
         if (H2DCfg_HeadersMerging) {
            adt_NewStack(&merged_headers_stack);
            NewMergedHeader(name, name_len);
         }
         else {
            adt_NewNamedElement(&ne, name, name_len);
            X2C_CALL(adt_Push_,X2C_GET_TD(merged_headers_stack),
                3)(merged_headers_stack, (adt_Element)ne);
         }
         was_push = !H2DCfg_HeadersMerging;
         PutPreText(name, name_len);
         if (config_project) {
            merge_headers(H2DObjs_CurrentHeader, config_project, 0, 1);
         }
         PushCommentsList(H2DObjs_CurrentHeader->objects);
         GetToken(1);
         if (H2DMsg_WasError) {
            --header_balance;
            return;
         }
         Declarations(0, H2DObjs_CurrentHeader->objects);
         if (H2DMsg_WasError) {
            --header_balance;
            return;
         }
         PopCommentsList();
         if (was_push) {
            X2C_CALL(adt_Pop_,X2C_GET_TD(merged_headers_stack),
                2)(merged_headers_stack, &e);
         }
         InsertSynonyms();
         CheckModifiedObjects();
         if (!H2DMsg_WasError) CheckParameters();
         H2DObjs_CurrentHeader->preheader = is_it_preheader;
         H2DObjs_CurrentHeader->cstdlib = cstdlib;
         H2DObjs_CurrentHeader->parsed = !H2DMsg_WasError;
         H2DObjs_CurrentHeader->stat->lines = H2DScan_last_header_total_line;
      }
   }
   else {
      H2DObjs_CurrentHeader = (H2DObjs_Header)e;
      if (H2DCfg_IncludingTree) H2DMsg_WriteLogFile("", 1ul, 0);
   }
   --header_balance;
   if (header_balance==0L && H2DCfg_IncludingTree) H2DMsg_CloseLogFile();
   if (header_balance==0L && H2DCfg_StrippingDirs) {
      H2DMsg_CloseDirFile();
   }
} /* end Parse() */


static X2C_BOOLEAN IsIdent(X2C_INT32 token)
{
   return token==6001L || token>=5000L && token<=5040L;
} /* end IsIdent() */


static void CfgVar(void)
{
   LongStrs_String right = 0;
   LongStrs_String left = 0;
   X2C_INT32 err;
   X2C_SEQ tmp[3];
   left = 0;
   right = 0;
   if (scan_token==6003L) {
      GetToken(1);
      if (H2DMsg_WasError) return;
      if (IsIdent(scan_token)) {
         Strings_Capitalize(scan_text->Adr, scan_text->Len0);
         if (X2C_STRCMP(scan_text->Adr,scan_text->Len0,"CTYPE",6u)==0) {
            GetToken(1);
            if (H2DMsg_WasError) return;
            if (scan_token==6013L) {
               GetToken(1);
               if (H2DMsg_WasError) return;
               LongStrs_Assign("$ctype", 7ul, &left);
               while (scan_token!=6013L && scan_token!=6064L) {
                  LongStrs_Append("_", 2ul, &left);
                  LongStrs_Append(scan_text->Adr, scan_text->Len0, &left);
                  GetToken(1);
                  if (H2DMsg_WasError) return;
               }
               if (scan_token==6013L) {
                  GetToken(1);
                  if (H2DMsg_WasError) return;
               }
               else {
                  Error(24L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                  return;
               }
               if (scan_token==6072L) {
                  LongStrs_Assign(scan_text->Adr, scan_text->Len0, &right);
                  err = H2DCfg_GetInfo(left->Adr, left->Len0, right->Adr,
                right->Len0, 1);
                  if (err>=0L) {
                     Error(err, (tmp[0].adr = left->Adr, tmp[1].val = 0,
                tmp[2].val = left->Len0*1u-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
                     return;
                  }
                  GetToken(1);
                  if (H2DMsg_WasError) return;
               }
               else {
                  Error(51L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                  return;
               }
               if (err==-2L) {
                  if (scan_token==6005L) {
                     GetToken(1);
                     if (H2DMsg_WasError) return;
                     if (IsIdent(scan_token)) {
                        LongStrs_Assign(scan_text->Adr, scan_text->Len0,
                &right);
                        GetToken(1);
                        if (H2DMsg_WasError) return;
                        if (scan_token==6044L) {
                           GetToken(1);
                           if (H2DMsg_WasError) return;
                           if (IsIdent(scan_token)) {
                              LongStrs_Append(".", 2ul, &right);
                              LongStrs_Append(scan_text->Adr,
                scan_text->Len0, &right);
                              GetToken(1);
                              if (H2DMsg_WasError) return;
                           }
                           else {
                              Error(27L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                              return;
                           }
                        }
                        err = H2DCfg_GetInfo(left->Adr, left->Len0,
                right->Adr, right->Len0, 1);
                        if (err>=0L) {
                           Error(err, (tmp[0].adr = left->Adr,
                tmp[1].val = 0, tmp[2].val = left->Len0*1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                           return;
                        }
                     }
                     else {
                        Error(27L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                        return;
                     }
                  }
                  else {
                     Error(5L, (tmp[0].adr = "\',\'", tmp[1].val = 0,
                tmp[2].val = 4u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                     return;
                  }
               }
               else {
                  Error(33L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                  return;
               }
            }
            else {
               Error(5L, (tmp[0].adr = "\'=\'", tmp[1].val = 0,
                tmp[2].val = 4u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
         }
         else if (X2C_STRCMP(scan_text->Adr,scan_text->Len0,"M2TYPE",7u)==0) {
            GetToken(1);
            if (H2DMsg_WasError) return;
            LongStrs_Assign("*", 2ul, &left);
            if (scan_token==6013L) {
               GetToken(1);
               if (H2DMsg_WasError) return;
            }
            else {
               Error(5L, (tmp[0].adr = "\'=\'", tmp[1].val = 0,
                tmp[2].val = 4u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            if (IsIdent(scan_token)) {
               LongStrs_Append(scan_text->Adr, scan_text->Len0, &left);
               GetToken(1);
               if (H2DMsg_WasError) return;
               if (scan_token==6044L) {
                  LongStrs_Append(".", 2ul, &left);
                  GetToken(1);
                  if (H2DMsg_WasError) return;
                  if (IsIdent(scan_token)) {
                     LongStrs_Append(scan_text->Adr, scan_text->Len0, &left);
                     GetToken(1);
                     if (H2DMsg_WasError) return;
                  }
                  else {
                     Error(27L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                     return;
                  }
               }
            }
            else {
               Error(27L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
            if (scan_token==6013L) {
               GetToken(1);
               if (H2DMsg_WasError) return;
               if (scan_token==6072L) {
                  LongStrs_Assign(scan_text->Adr, scan_text->Len0, &right);
                  err = H2DCfg_GetInfo(left->Adr, left->Len0, right->Adr,
                right->Len0, 0);
                  if (err>=0L) {
                     Error(err, (tmp[0].adr = left, (X2C_LOC *)tmp),
                sizeof(X2C_SEQ));
                     return;
                  }
                  GetToken(1);
                  if (H2DMsg_WasError) return;
                  if (scan_token==6005L) {
                     GetToken(1);
                     if (H2DMsg_WasError) return;
                     Strings_Capitalize(scan_text->Adr, scan_text->Len0);
                     if (scan_token==6001L && (((((X2C_STRCMP(scan_text->Adr,
                scan_text->Len0,"BOOL",5u)==0 || X2C_STRCMP(scan_text->Adr,
                scan_text->Len0,"CHAR",5u)==0) || X2C_STRCMP(scan_text->Adr,
                scan_text->Len0,"REAL",5u)==0) || X2C_STRCMP(scan_text->Adr,
                scan_text->Len0,"SET",4u)==0) || X2C_STRCMP(scan_text->Adr,
                scan_text->Len0,"SIGNED",
                7u)==0) || X2C_STRCMP(scan_text->Adr,scan_text->Len0,"UNSIGNE\
D",9u)==0)) {
                        left->Adr[0UL] = '+';
                        LongStrs_Assign(scan_text->Adr, scan_text->Len0,
                &right);
                        err = H2DCfg_GetInfo(left->Adr, left->Len0,
                right->Adr, right->Len0, 0);
                        if (err>=0L) {
                           Error(err, (tmp[0].adr = left->Adr,
                tmp[1].val = 0, tmp[2].val = left->Len0*1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                           return;
                        }
                        GetToken(1);
                        if (H2DMsg_WasError) return;
                     }
                     else {
                        Error(70L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                        return;
                     }
                  }
                  else {
                     Error(5L, (tmp[0].adr = "\',\'", tmp[1].val = 0,
                tmp[2].val = 4u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                     return;
                  }
               }
               else {
                  Error(51L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                  return;
               }
            }
            else {
               Error(5L, (tmp[0].adr = "\'=\'", tmp[1].val = 0,
                tmp[2].val = 4u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
         }
         else {
            LongStrs_Assign(scan_text->Adr, scan_text->Len0, &left);
            GetToken(1);
            if (H2DMsg_WasError) return;
            if (scan_token==6013L) {
               GetToken(1);
               if (H2DMsg_WasError) return;
               if ((IsIdent(scan_token) || scan_token==6031L)
                || scan_token==6072L) {
                  LongStrs_Assign(scan_text->Adr, scan_text->Len0, &right);
                  err = H2DCfg_GetInfo(left->Adr, left->Len0, right->Adr,
                right->Len0, 1);
                  if (err>=0L) {
                     Error(err, (tmp[0].adr = left->Adr, tmp[1].val = 0,
                tmp[2].val = left->Len0*1u-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
                     return;
                  }
                  GetToken(1);
                  if (H2DMsg_WasError) return;
               }
               else {
                  Error(46L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
                  return;
               }
            }
            else if (scan_token==6003L) {
               GetToken(1);
               if (H2DMsg_WasError) return;
               LongStrs_Assign("Off", 4ul, &right);
               err = H2DCfg_GetInfo(left->Adr, left->Len0, right->Adr,
                right->Len0, 1);
               if (err>=0L) {
                  Error(err, (tmp[0].adr = left->Adr, tmp[1].val = 0,
                tmp[2].val = left->Len0*1u-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
                  return;
               }
            }
            else if (scan_token==6002L) {
               GetToken(1);
               if (H2DMsg_WasError) return;
               LongStrs_Assign("On", 3ul, &right);
               err = H2DCfg_GetInfo(left->Adr, left->Len0, right->Adr,
                right->Len0, 1);
               if (err>=0L) {
                  Error(err, (tmp[0].adr = left->Adr, tmp[1].val = 0,
                tmp[2].val = left->Len0*1u-1, (X2C_LOC *)tmp),
                3ul*sizeof(X2C_SEQ));
                  return;
               }
            }
            else {
               Error(5L, (tmp[0].adr = "\'=\', \'-\', \'+\'", tmp[1].val = 0,
                 tmp[2].val = 14u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               return;
            }
         }
      }
      else {
         Error(27L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
         return;
      }
      LongStrs_Deallocate(&left);
      LongStrs_Deallocate(&right);
   }
   else {
      Error(5L, (tmp[0].adr = "\'-\'", tmp[1].val = 0, tmp[2].val = 4u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
      return;
   }
} /* end CfgVar() */


static void ErrorInParseProjectOrParseConf(void)
{
   X2C_CALL(H2DMsg_ShowHeader_,X2C_GET_TD(H2DObjs_CurrentHeader->stat),
                5)(H2DObjs_CurrentHeader->stat);
   X2C_CALL(H2DMsg_ShowFooter_,X2C_GET_TD(H2DObjs_CurrentHeader->stat),
                4)(H2DObjs_CurrentHeader->stat);
   X2C_ABORT();
} /* end ErrorInParseProjectOrParseConfig() */


extern adt_List H2DParse_ParseProject(X2C_CHAR name[], X2C_CARD32 name_len)
{
   LongStrs_String path = 0;
   LongStrs_String ext = 0;
   LongStrs_String fname = 0;
   LongStrs_String wholename = 0;
   adt_List project_list = 0;
   H2DObjs_Module module = 0;
   X2C_SEQ tmp[3];
   H2DFile_SplitName(name, name_len, &path, &fname, &ext);
   if (ext->Adr[0]==0) {
      H2DFile_CreateName(path->Adr, path->Len0, fname->Adr, fname->Len0,
                H2DCfg_PrjExtension->Adr, H2DCfg_PrjExtension->Len0,
                &wholename);
   }
   else LongStrs_Assign(name, name_len, &wholename);
   adt_NewList(&project_list);
   adt_NewStack(&if_stack);
   X2C_NEW(&H2DScan_TokenDesc_desc,(X2C_ADDRESS*) &current_token,
                sizeof(struct H2DScan_TokenDesc),0);
   adt_NewList(&token_list);
   if_balance = 0L;
   end_balance = 0L;
   C_extensions = 1;
   config_on = 0;
   project_on = 1;
   H2DScan_prj_cfg_on = config_on || project_on;
   LongStrs_Assign(name, name_len, &file_name);
   line = 1L;
   pos = 1L;
   Init();
   H2DObjs_NewHeader(name, name_len, &H2DObjs_CurrentHeader);
   HeadHeader = H2DObjs_CurrentHeader;
   if (Open(wholename->Adr, wholename->Len0, 1)) {
      PushCommentsList(H2DObjs_CurrentHeader->objects);
      GetToken(1);
      if (H2DMsg_WasError) ErrorInParseProjectOrParseConf();
      while (scan_token!=6064L) {
         if (scan_token==6081L) {
            GetToken(1);
            if (H2DMsg_WasError) ErrorInParseProjectOrParseConf();
            X2C_NEW(&H2DObjs_ModuleDesc_desc,(X2C_ADDRESS*) &module,
                sizeof(struct H2DObjs_ModuleDesc),0);
            module->cstdlib = scan_token==6068L;
            X2C_CALL(adt_SetName_,X2C_GET_TD(module),
                1)((adt_NamedElement)module, scan_text->Adr,
                scan_text->Len0);
            X2C_CALL(adt_Insert_0,X2C_GET_TD(project_list),14)(project_list,
                (adt_Element)module);
            GetToken(1);
            if (H2DMsg_WasError) ErrorInParseProjectOrParseConf();
            if (scan_token==6063L) {
               GetToken(1);
               if (H2DMsg_WasError) ErrorInParseProjectOrParseConf();
            }
            else {
               Error(20L, (tmp[0].adr = "", tmp[1].val = 0,
                tmp[2].val = 1u-1, (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
               scan_token = 6064L;
            }
         }
         else {
            CfgVar();
            if (H2DMsg_WasError) {
               Printf_printf("", 1ul, 0, 0ul);
               ErrorInParseProjectOrParseConf();
            }
         }
      }
      PopCommentsList();
      if (X2C_CALL(adt_IsEmpty_1,X2C_GET_TD(project_list),4)(project_list)) {
         Error(64L, (tmp[0].adr = "", tmp[1].val = 0, tmp[2].val = 1u-1,
                (X2C_LOC *)tmp), 3ul*sizeof(X2C_SEQ));
         ErrorInParseProjectOrParseConf();
      }
      merge_headers(config_project, H2DObjs_CurrentHeader, 0, 1);
      merge_lists(prepretext_list, pretext_list, 0);
      merge_trees(project_merge_headers_tree, merge_headers_tree);
      return project_list;
   }
   else ErrorInParseProjectOrParseConf();
   return 0;
} /* end ParseProject() */


extern void H2DParse_ParseConfig(X2C_CHAR name[], X2C_CARD32 name_len)
{
   X2C_NEW(&H2DScan_TokenDesc_desc,(X2C_ADDRESS*) &current_token,
                sizeof(struct H2DScan_TokenDesc),0);
   adt_NewList(&token_list);
   adt_NewStack(&if_stack);
   if_balance = 0L;
   end_balance = 0L;
   C_extensions = 1;
   config_on = 1;
   project_on = 0;
   H2DScan_prj_cfg_on = config_on || project_on;
   LongStrs_Assign(name, name_len, &file_name);
   line = 1L;
   pos = 1L;
   adt_NewList(&prepretext_list);
   H2DObjs_NewHeader("config_project", 15ul, &config_project);
   Init();
   H2DObjs_NewHeader(name, name_len, &H2DObjs_CurrentHeader);
   if (Open(name, name_len, 0)) {
      PushCommentsList(H2DObjs_CurrentHeader->objects);
      GetToken(1);
      if (H2DMsg_WasError) ErrorInParseProjectOrParseConf();
      while (scan_token!=6064L) {
         CfgVar();
         if (H2DMsg_WasError) ErrorInParseProjectOrParseConf();
      }
      PopCommentsList();
      merge_headers(config_project, H2DObjs_CurrentHeader, 0, 1);
      merge_lists(prepretext_list, pretext_list, 0);
   }
} /* end ParseConfig() */


static void * H2DParse_offs[] = {
   &prepretext_list,
   &headers_stack,
   &token_list,
   &empty_token_list,
   &current_token,
   &scan_text,
   &if_stack,
   &declaration_without_definition,
   &file_name,
   &current_list_for_comments,
   &merge_headers_tree,
   &project_merge_headers_tree,
   &pretext_list,
   &comments_lists_stack,
   &merged_headers_stack,
   &config_project,
   &emptyString,
   &emptyToken,
   &FileNameTree,
   &HeadHeader,
   X2C_OFS_END
};
static X2C_PROC H2DParse_cmds[] = { 0 };
static X2C_CHAR * H2DParse_cnms[] = { 0 };
struct X2C_MD_STR H2DParse_desc = {
  0, 0, "H2DParse",H2DParse_offs,H2DParse_cmds,H2DParse_cnms,
                &H2DParse_DesignatorDesc_desc
};

extern void H2DParse_BEGIN(void)
{
   static int H2DParse_init = 0;
   if (H2DParse_init) return;
   H2DParse_init = 1;
   adt_BEGIN();
   Strings_BEGIN();
   LongStrs_BEGIN();
   H2DScan_BEGIN();
   H2DObjs_BEGIN();
   H2DFile_BEGIN();
   H2DCfg_BEGIN();
   H2DMsg_BEGIN();
   RegComp_BEGIN();
   ConvTypes_BEGIN();
   WholeStr_BEGIN();
   Printf_BEGIN();
   X2C_MODULE(&H2DParse_desc);
   adt_NewList(&empty_token_list);
   header_balance = 0L;
   include_balance = 0L;
   H2DObjs_NewComment(&declaration_without_definition, -1L, "Declaration with\
out definition", 31ul);
   adt_NewStack(&merged_headers_stack);
   adt_NewTree(&merge_headers_tree);
   adt_NewTree(&project_merge_headers_tree);
   adt_NewTree(&FileNameTree);
   InitBinaryOperationPriority();
   LongStrs_Assign("", 1ul, &emptyString);
   X2C_NEW(&H2DScan_TokenDesc_desc,(X2C_ADDRESS*) &emptyToken,
                sizeof(struct H2DScan_TokenDesc),0);
   emptyToken->token = 6079L;
   emptyToken->text = emptyString;
}

