/* XDS v2.60: Copyright (c) 1999-2011 Excelsior, LLC. All Rights Reserved. */
/* "@(#)IOChan.c Nov 19  1:11:49 2022" */
/* Generated by XDS Modula-2 to ANSI C v4.20 translator */

#define X2C_int32
#define X2C_index32
#ifndef IOChan_H_
#include "IOChan.h"
#endif
#define IOChan_C_
#ifndef ChanConsts_H_
#include "ChanConsts.h"
#endif
#ifndef IOConsts_H_
#include "IOConsts.h"
#endif
#ifndef IOLink_H_
#include "IOLink.h"
#endif

static IOLink_DeviceTablePtr inv;


extern IOChan_ChanId IOChan_InvalidChan(void)
{
   return (IOChan_ChanId)inv;
} /* end InvalidChan() */


extern void IOChan_Look(IOChan_ChanId cid, X2C_CHAR * ch, X2C_CARD8 * res)
{
   ((IOLink_DeviceTablePtr)cid)->doLook((IOLink_DeviceTablePtr)cid, ch, res);
} /* end Look() */


extern void IOChan_Skip(IOChan_ChanId cid)
{
   ((IOLink_DeviceTablePtr)cid)->doSkip((IOLink_DeviceTablePtr)cid);
} /* end Skip() */


extern void IOChan_SkipLook(IOChan_ChanId cid, X2C_CHAR * ch,
                X2C_CARD8 * res)
{
   ((IOLink_DeviceTablePtr)cid)->doSkipLook((IOLink_DeviceTablePtr)cid, ch,
                res);
} /* end SkipLook() */


extern void IOChan_WriteLn(IOChan_ChanId cid)
{
   ((IOLink_DeviceTablePtr)cid)->doLnWrite((IOLink_DeviceTablePtr)cid);
} /* end WriteLn() */


extern void IOChan_TextRead(IOChan_ChanId cid, X2C_ADDRESS to,
                X2C_CARD32 max0, X2C_CARD32 * locs)
{
   ((IOLink_DeviceTablePtr)cid)->doTextRead((IOLink_DeviceTablePtr)cid, to,
                max0, locs);
} /* end TextRead() */


extern void IOChan_TextWrite(IOChan_ChanId cid, X2C_ADDRESS from,
                X2C_CARD32 len)
{
   ((IOLink_DeviceTablePtr)cid)->doTextWrite((IOLink_DeviceTablePtr)cid,
                from, len);
} /* end TextWrite() */


extern void IOChan_RawRead(IOChan_ChanId cid, X2C_ADDRESS to,
                X2C_CARD32 max0, X2C_CARD32 * locs)
{
   ((IOLink_DeviceTablePtr)cid)->doRawRead((IOLink_DeviceTablePtr)cid, to,
                max0, locs);
} /* end RawRead() */


extern void IOChan_RawWrite(IOChan_ChanId cid, X2C_ADDRESS from,
                X2C_CARD32 locs)
{
   ((IOLink_DeviceTablePtr)cid)->doRawWrite((IOLink_DeviceTablePtr)cid, from,
                 locs);
} /* end RawWrite() */


extern void IOChan_GetName(IOChan_ChanId cid, X2C_CHAR s[],
                X2C_CARD32 s_len)
{
   ((IOLink_DeviceTablePtr)cid)->doGetName((IOLink_DeviceTablePtr)cid, s,
                s_len);
} /* end GetName() */


extern void IOChan_Reset(IOChan_ChanId cid)
{
   ((IOLink_DeviceTablePtr)cid)->doReset((IOLink_DeviceTablePtr)cid);
} /* end Reset() */


extern void IOChan_Flush(IOChan_ChanId cid)
{
   ((IOLink_DeviceTablePtr)cid)->doFlush((IOLink_DeviceTablePtr)cid);
} /* end Flush() */


extern void IOChan_SetReadResult(IOChan_ChanId cid, X2C_CARD8 res)
{
   ((IOLink_DeviceTablePtr)cid)->result = res;
} /* end SetReadResult() */


extern X2C_CARD8 IOChan_ReadResult(IOChan_ChanId cid)
{
   return ((IOLink_DeviceTablePtr)cid)->result;
} /* end ReadResult() */


extern X2C_CARD8 IOChan_CurrentFlags(IOChan_ChanId cid)
{
   return ((IOLink_DeviceTablePtr)cid)->flags;
} /* end CurrentFlags() */


extern X2C_BOOLEAN IOChan_IsChanException(void)
{
   return IOLink_IsIOException();
} /* end IsChanException() */


extern X2C_CARD8 IOChan_ChanException(void)
{
   return IOLink_IOException();
} /* end ChanException() */


extern X2C_INT32 IOChan_DeviceError(IOChan_ChanId cid)
{
   return ((IOLink_DeviceTablePtr)cid)->errNum;
} /* end DeviceError() */

static IOLink_DeviceId did;


extern void IOChan_BEGIN(void)
{
   static int IOChan_init = 0;
   if (IOChan_init) return;
   IOChan_init = 1;
   IOLink_BEGIN();
   IOConsts_BEGIN();
   ChanConsts_BEGIN();
   IOLink_AllocateDeviceId(&did);
   inv = 0;
   IOLink_MakeChan(did, (IOChan_ChanId *) &inv);
   if (inv==0) X2C_ABORT();
}

