/* XDS v2.60: Copyright (c) 1999-2011 Excelsior, LLC. All Rights Reserved. */
/* "@(#)MATHLIB.c Nov  7 22:55:45 2022" */
/* Generated by XDS Modula-2 to ANSI C v4.20 translator */

#define X2C_int32
#define X2C_index32
#ifndef MATHLIB_H_
#include "MATHLIB.h"
#endif
#define MATHLIB_C_
#ifndef LongMath_H_
#include "LongMath.h"
#endif
#include "xMath.h"


extern X2C_LONGREAL MATHLIB_Pow(X2C_LONGREAL X, X2C_LONGREAL Y)
{
   if (Y==0.0) return 1.0;
   if (X>=0.0) return LongMath_power(X, Y);
   else if ((X2C_LONGREAL)(X2C_INT32)X2C_TRUNCI(Y,X2C_min_longint,
                X2C_max_longint)==Y) {
      return MATHLIB_IntPow(X, (X2C_INT32)X2C_TRUNCI(Y,X2C_min_longint,
                X2C_max_longint));
   }
   else return 0.0;
   return 0;
} /* end Pow() */


extern X2C_LONGREAL MATHLIB_SinH(X2C_LONGREAL A)
{
   return X2C_DIVL(LongMath_exp(A)-LongMath_exp(-A),2.0);
} /* end SinH() */


extern X2C_LONGREAL MATHLIB_CosH(X2C_LONGREAL A)
{
   return X2C_DIVL(LongMath_exp(A)+LongMath_exp(-A),2.0);
} /* end CosH() */


extern X2C_LONGREAL MATHLIB_TanH(X2C_LONGREAL A)
{
   X2C_LONGREAL emx;
   X2C_LONGREAL ex;
   ex = LongMath_exp(A);
   emx = LongMath_exp(-A);
   return X2C_DIVL(ex-emx,ex+emx);
} /* end TanH() */


extern X2C_LONGREAL MATHLIB_Log10(X2C_LONGREAL A)
{
   return X2C_DIVL(LongMath_ln(A),2.302585092994);
} /* end Log10() */


extern X2C_LONGREAL MATHLIB_Mod(X2C_LONGREAL X, X2C_LONGREAL Y)
{
   if (Y==0.0) return 0.0;
   return X2C_reml(X, Y);
} /* end Mod() */


extern X2C_LONGREAL MATHLIB_Rexp(X2C_INT32 * I, X2C_LONGREAL A)
{
   int e;
   X2C_LONGREAL m;
   m = X2C_frexp(A, &e);
   *I = e;
   return m;
} /* end Rexp() */


extern X2C_LONGREAL MATHLIB_ATan2(X2C_LONGREAL x, X2C_LONGREAL y)
{
   return X2C_arctan2l(y, x);
} /* end ATan2() */


extern X2C_LONGREAL MATHLIB_IntPow(X2C_LONGREAL X, X2C_INT32 K)
{
   X2C_LONGREAL res;
   X2C_INT32 P;
   if (K==0L) return 1.0;
   P = labs(K);
   res = 1.0;
   for (;;) {
      if ((P&1)) res = res*X;
      P = X2C_DIV(P,2L);
      if (P==0L) break;
      X = X*X;
   }
   if (K<0L) res = X2C_DIVL(1.0,res);
   return res;
} /* end IntPow() */


extern void MATHLIB_BEGIN(void)
{
   static int MATHLIB_init = 0;
   if (MATHLIB_init) return;
   MATHLIB_init = 1;
   LongMath_BEGIN();
}

